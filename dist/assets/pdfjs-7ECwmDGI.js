const Ut="modulepreload",Xt=function(ht){return"/"+ht},Vt={},Mt=function(Z,U,A){let z=Promise.resolve();if(U&&U.length>0){document.getElementsByTagName("link");const D=document.querySelector("meta[property=csp-nonce]"),k=D?.nonce||D?.getAttribute("nonce");z=Promise.allSettled(U.map(P=>{if(P=Xt(P),P in Vt)return;Vt[P]=!0;const y=P.endsWith(".css"),v=y?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${P}"]${v}`))return;const l=document.createElement("link");if(l.rel=y?"stylesheet":Ut,y||(l.as="script"),l.crossOrigin="",l.href=P,k&&l.setAttribute("nonce",k),document.head.appendChild(l),y)return new Promise((u,g)=>{l.addEventListener("load",u),l.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${P}`)))})}))}function C(D){const k=new Event("vite:preloadError",{cancelable:!0});if(k.payload=D,window.dispatchEvent(k),!k.defaultPrevented)throw D}return z.then(D=>{for(const k of D||[])k.status==="rejected"&&C(k.reason);return Z().catch(C)})};var _t={640:(ht,Z,U)=>{U.d(Z,{AnnotationLayer:()=>ct,FreeTextAnnotationElement:()=>Y,InkAnnotationElement:()=>Q,StampAnnotationElement:()=>gt});var A=U(266),z=U(473),C=U(780);function D(J){return Math.floor(Math.max(0,Math.min(1,J))*255).toString(16).padStart(2,"0")}function k(J){return Math.max(0,Math.min(255,255*J))}class P{static CMYK_G([d,o,s,t]){return["G",1-Math.min(1,.3*d+.59*s+.11*o+t)]}static G_CMYK([d]){return["CMYK",0,0,0,1-d]}static G_RGB([d]){return["RGB",d,d,d]}static G_rgb([d]){return d=k(d),[d,d,d]}static G_HTML([d]){const o=D(d);return`#${o}${o}${o}`}static RGB_G([d,o,s]){return["G",.3*d+.59*o+.11*s]}static RGB_rgb(d){return d.map(k)}static RGB_HTML(d){return`#${d.map(D).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([d,o,s,t]){return["RGB",1-Math.min(1,d+t),1-Math.min(1,s+t),1-Math.min(1,o+t)]}static CMYK_rgb([d,o,s,t]){return[k(1-Math.min(1,d+t)),k(1-Math.min(1,s+t)),k(1-Math.min(1,o+t))]}static CMYK_HTML(d){const o=this.CMYK_RGB(d).slice(1);return this.RGB_HTML(o)}static RGB_CMYK([d,o,s]){const t=1-d,i=1-o,a=1-s,h=Math.min(t,i,a);return["CMYK",t,i,a,h]}}var y=U(160);const v=1e3,l=9,u=new WeakSet;function g(J){return{width:J[2]-J[0],height:J[3]-J[1]}}class r{static create(d){switch(d.data.annotationType){case A.AnnotationType.LINK:return new e(d);case A.AnnotationType.TEXT:return new n(d);case A.AnnotationType.WIDGET:switch(d.data.fieldType){case"Tx":return new b(d);case"Btn":return d.data.radioButton?new E(d):d.data.checkBox?new R(d):new M(d);case"Ch":return new V(d);case"Sig":return new m(d)}return new c(d);case A.AnnotationType.POPUP:return new G(d);case A.AnnotationType.FREETEXT:return new Y(d);case A.AnnotationType.LINE:return new tt(d);case A.AnnotationType.SQUARE:return new rt(d);case A.AnnotationType.CIRCLE:return new j(d);case A.AnnotationType.POLYLINE:return new O(d);case A.AnnotationType.CARET:return new q(d);case A.AnnotationType.INK:return new Q(d);case A.AnnotationType.POLYGON:return new B(d);case A.AnnotationType.HIGHLIGHT:return new K(d);case A.AnnotationType.UNDERLINE:return new ft(d);case A.AnnotationType.SQUIGGLY:return new ot(d);case A.AnnotationType.STRIKEOUT:return new at(d);case A.AnnotationType.STAMP:return new gt(d);case A.AnnotationType.FILEATTACHMENT:return new dt(d);default:return new p(d)}}}class p{#t=!1;constructor(d,{isRenderable:o=!1,ignoreBorder:s=!1,createQuadrilaterals:t=!1}={}){this.isRenderable=o,this.data=d.data,this.layer=d.layer,this.linkService=d.linkService,this.downloadManager=d.downloadManager,this.imageResourcesPath=d.imageResourcesPath,this.renderForms=d.renderForms,this.svgFactory=d.svgFactory,this.annotationStorage=d.annotationStorage,this.enableScripting=d.enableScripting,this.hasJSActions=d.hasJSActions,this._fieldObjects=d.fieldObjects,this.parent=d.parent,o&&(this.container=this._createContainer(s)),t&&this._createQuadrilaterals()}static _hasPopupData({titleObj:d,contentsObj:o,richText:s}){return!!(d?.str||o?.str||s?.str)}get hasPopupData(){return p._hasPopupData(this.data)}_createContainer(d){const{data:o,parent:{page:s,viewport:t}}=this,i=document.createElement("section");i.setAttribute("data-annotation-id",o.id),this instanceof c||(i.tabIndex=v),i.style.zIndex=this.parent.zIndex++,this.data.popupRef&&i.setAttribute("aria-haspopup","dialog"),o.noRotate&&i.classList.add("norotate");const{pageWidth:a,pageHeight:h,pageX:f,pageY:w}=t.rawDims;if(!o.rect||this instanceof G){const{rotation:H}=o;return!o.hasOwnCanvas&&H!==0&&this.setRotation(H,i),i}const{width:x,height:T}=g(o.rect),F=A.Util.normalizeRect([o.rect[0],s.view[3]-o.rect[1]+s.view[1],o.rect[2],s.view[3]-o.rect[3]+s.view[1]]);if(!d&&o.borderStyle.width>0){i.style.borderWidth=`${o.borderStyle.width}px`;const H=o.borderStyle.horizontalCornerRadius,N=o.borderStyle.verticalCornerRadius;if(H>0||N>0){const L=`calc(${H}px * var(--scale-factor)) / calc(${N}px * var(--scale-factor))`;i.style.borderRadius=L}else if(this instanceof E){const L=`calc(${x}px * var(--scale-factor)) / calc(${T}px * var(--scale-factor))`;i.style.borderRadius=L}switch(o.borderStyle.style){case A.AnnotationBorderStyleType.SOLID:i.style.borderStyle="solid";break;case A.AnnotationBorderStyleType.DASHED:i.style.borderStyle="dashed";break;case A.AnnotationBorderStyleType.BEVELED:(0,A.warn)("Unimplemented border style: beveled");break;case A.AnnotationBorderStyleType.INSET:(0,A.warn)("Unimplemented border style: inset");break;case A.AnnotationBorderStyleType.UNDERLINE:i.style.borderBottomStyle="solid";break}const S=o.borderColor||null;S?(this.#t=!0,i.style.borderColor=A.Util.makeHexColor(S[0]|0,S[1]|0,S[2]|0)):i.style.borderWidth=0}i.style.left=`${100*(F[0]-f)/a}%`,i.style.top=`${100*(F[1]-w)/h}%`;const{rotation:I}=o;return o.hasOwnCanvas||I===0?(i.style.width=`${100*x/a}%`,i.style.height=`${100*T/h}%`):this.setRotation(I,i),i}setRotation(d,o=this.container){if(!this.data.rect)return;const{pageWidth:s,pageHeight:t}=this.parent.viewport.rawDims,{width:i,height:a}=g(this.data.rect);let h,f;d%180===0?(h=100*i/s,f=100*a/t):(h=100*a/s,f=100*i/t),o.style.width=`${h}%`,o.style.height=`${f}%`,o.setAttribute("data-main-rotation",(360-d)%360)}get _commonActions(){const d=(o,s,t)=>{const i=t.detail[o],a=i[0],h=i.slice(1);t.target.style[s]=P[`${a}_HTML`](h),this.annotationStorage.setValue(this.data.id,{[s]:P[`${a}_rgb`](h)})};return(0,A.shadow)(this,"_commonActions",{display:o=>{const{display:s}=o.detail,t=s%2===1;this.container.style.visibility=t?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:t,noPrint:s===1||s===2})},print:o=>{this.annotationStorage.setValue(this.data.id,{noPrint:!o.detail.print})},hidden:o=>{const{hidden:s}=o.detail;this.container.style.visibility=s?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:s,noView:s})},focus:o=>{setTimeout(()=>o.target.focus({preventScroll:!1}),0)},userName:o=>{o.target.title=o.detail.userName},readonly:o=>{o.target.disabled=o.detail.readonly},required:o=>{this._setRequired(o.target,o.detail.required)},bgColor:o=>{d("bgColor","backgroundColor",o)},fillColor:o=>{d("fillColor","backgroundColor",o)},fgColor:o=>{d("fgColor","color",o)},textColor:o=>{d("textColor","color",o)},borderColor:o=>{d("borderColor","borderColor",o)},strokeColor:o=>{d("strokeColor","borderColor",o)},rotation:o=>{const s=o.detail.rotation;this.setRotation(s),this.annotationStorage.setValue(this.data.id,{rotation:s})}})}_dispatchEventFromSandbox(d,o){const s=this._commonActions;for(const t of Object.keys(o.detail))(d[t]||s[t])?.(o)}_setDefaultPropertiesFromJS(d){if(!this.enableScripting)return;const o=this.annotationStorage.getRawValue(this.data.id);if(!o)return;const s=this._commonActions;for(const[t,i]of Object.entries(o)){const a=s[t];if(a){const h={detail:{[t]:i},target:d};a(h),delete o[t]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:d}=this.data;if(!d)return;const[o,s,t,i]=this.data.rect;if(d.length===1){const[,{x:N,y:S},{x:L,y:$}]=d[0];if(t===N&&i===S&&o===L&&s===$)return}const{style:a}=this.container;let h;if(this.#t){const{borderColor:N,borderWidth:S}=a;a.borderWidth=0,h=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${N}" stroke-width="${S}">`],this.container.classList.add("hasBorder")}const f=t-o,w=i-s,{svgFactory:x}=this,T=x.createElement("svg");T.classList.add("quadrilateralsContainer"),T.setAttribute("width",0),T.setAttribute("height",0);const F=x.createElement("defs");T.append(F);const I=x.createElement("clipPath"),H=`clippath_${this.data.id}`;I.setAttribute("id",H),I.setAttribute("clipPathUnits","objectBoundingBox"),F.append(I);for(const[,{x:N,y:S},{x:L,y:$}]of d){const X=x.createElement("rect"),W=(L-o)/f,et=(i-S)/w,st=(N-L)/f,nt=(S-$)/w;X.setAttribute("x",W),X.setAttribute("y",et),X.setAttribute("width",st),X.setAttribute("height",nt),I.append(X),h?.push(`<rect vector-effect="non-scaling-stroke" x="${W}" y="${et}" width="${st}" height="${nt}"/>`)}this.#t&&(h.push("</g></svg>')"),a.backgroundImage=h.join("")),this.container.append(T),this.container.style.clipPath=`url(#${H})`}_createPopup(){const{container:d,data:o}=this;d.setAttribute("aria-haspopup","dialog");const s=new G({data:{color:o.color,titleObj:o.titleObj,modificationDate:o.modificationDate,contentsObj:o.contentsObj,richText:o.richText,parentRect:o.rect,borderStyle:0,id:`popup_${o.id}`,rotation:o.rotation},parent:this.parent,elements:[this]});this.parent.div.append(s.render())}render(){(0,A.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(d,o=null){const s=[];if(this._fieldObjects){const t=this._fieldObjects[d];if(t)for(const{page:i,id:a,exportValues:h}of t){if(i===-1||a===o)continue;const f=typeof h=="string"?h:null,w=document.querySelector(`[data-element-id="${a}"]`);if(w&&!u.has(w)){(0,A.warn)(`_getElementsByName - element not allowed: ${a}`);continue}s.push({id:a,exportValue:f,domElement:w})}return s}for(const t of document.getElementsByName(d)){const{exportValue:i}=t,a=t.getAttribute("data-element-id");a!==o&&u.has(t)&&s.push({id:a,exportValue:i,domElement:t})}return s}show(){this.container&&(this.container.hidden=!1),this.popup?.maybeShow()}hide(){this.container&&(this.container.hidden=!0),this.popup?.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const d=this.getElementsToTriggerPopup();if(Array.isArray(d))for(const o of d)o.classList.add("highlightArea");else d.classList.add("highlightArea")}get _isEditable(){return!1}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:d,data:{id:o}}=this;this.container.addEventListener("dblclick",()=>{this.linkService.eventBus?.dispatch("switchannotationeditormode",{source:this,mode:d,editId:o})})}}class e extends p{constructor(d,o=null){super(d,{isRenderable:!0,ignoreBorder:!!o?.ignoreBorder,createQuadrilaterals:!0}),this.isTooltipOnly=d.data.isTooltipOnly}render(){const{data:d,linkService:o}=this,s=document.createElement("a");s.setAttribute("data-element-id",d.id);let t=!1;return d.url?(o.addLinkAttributes(s,d.url,d.newWindow),t=!0):d.action?(this._bindNamedAction(s,d.action),t=!0):d.attachment?(this.#e(s,d.attachment,d.attachmentDest),t=!0):d.setOCGState?(this.#s(s,d.setOCGState),t=!0):d.dest?(this._bindLink(s,d.dest),t=!0):(d.actions&&(d.actions.Action||d.actions["Mouse Up"]||d.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(s,d),t=!0),d.resetForm?(this._bindResetFormAction(s,d.resetForm),t=!0):this.isTooltipOnly&&!t&&(this._bindLink(s,""),t=!0)),this.container.classList.add("linkAnnotation"),t&&this.container.append(s),this.container}#t(){this.container.setAttribute("data-internal-link","")}_bindLink(d,o){d.href=this.linkService.getDestinationHash(o),d.onclick=()=>(o&&this.linkService.goToDestination(o),!1),(o||o==="")&&this.#t()}_bindNamedAction(d,o){d.href=this.linkService.getAnchorUrl(""),d.onclick=()=>(this.linkService.executeNamedAction(o),!1),this.#t()}#e(d,o,s=null){d.href=this.linkService.getAnchorUrl(""),d.onclick=()=>(this.downloadManager?.openOrDownloadData(o.content,o.filename,s),!1),this.#t()}#s(d,o){d.href=this.linkService.getAnchorUrl(""),d.onclick=()=>(this.linkService.executeSetOCGState(o),!1),this.#t()}_bindJSAction(d,o){d.href=this.linkService.getAnchorUrl("");const s=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const t of Object.keys(o.actions)){const i=s.get(t);i&&(d[i]=()=>(this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:o.id,name:t}}),!1))}d.onclick||(d.onclick=()=>!1),this.#t()}_bindResetFormAction(d,o){const s=d.onclick;if(s||(d.href=this.linkService.getAnchorUrl("")),this.#t(),!this._fieldObjects){(0,A.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),s||(d.onclick=()=>!1);return}d.onclick=()=>{s?.();const{fields:t,refs:i,include:a}=o,h=[];if(t.length!==0||i.length!==0){const x=new Set(i);for(const T of t){const F=this._fieldObjects[T]||[];for(const{id:I}of F)x.add(I)}for(const T of Object.values(this._fieldObjects))for(const F of T)x.has(F.id)===a&&h.push(F)}else for(const x of Object.values(this._fieldObjects))h.push(...x);const f=this.annotationStorage,w=[];for(const x of h){const{id:T}=x;switch(w.push(T),x.type){case"text":{const I=x.defaultValue||"";f.setValue(T,{value:I});break}case"checkbox":case"radiobutton":{const I=x.defaultValue===x.exportValues;f.setValue(T,{value:I});break}case"combobox":case"listbox":{const I=x.defaultValue||"";f.setValue(T,{value:I});break}default:continue}const F=document.querySelector(`[data-element-id="${T}"]`);if(F){if(!u.has(F)){(0,A.warn)(`_bindResetFormAction - element not allowed: ${T}`);continue}}else continue;F.dispatchEvent(new Event("resetform"))}return this.enableScripting&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:w,name:"ResetForm"}}),!1}}}class n extends p{constructor(d){super(d,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const d=document.createElement("img");return d.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",d.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),d.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(d),this.container}}class c extends p{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}showElementAndHideCanvas(d){this.data.hasOwnCanvas&&(d.previousSibling?.nodeName==="CANVAS"&&(d.previousSibling.hidden=!0),d.hidden=!1)}_getKeyModifier(d){return A.FeatureTest.platform.isMac?d.metaKey:d.ctrlKey}_setEventListener(d,o,s,t,i){s.includes("mouse")?d.addEventListener(s,a=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:t,value:i(a),shift:a.shiftKey,modifier:this._getKeyModifier(a)}})}):d.addEventListener(s,a=>{if(s==="blur"){if(!o.focused||!a.relatedTarget)return;o.focused=!1}else if(s==="focus"){if(o.focused)return;o.focused=!0}i&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:t,value:i(a)}})})}_setEventListeners(d,o,s,t){for(const[i,a]of s)(a==="Action"||this.data.actions?.[a])&&((a==="Focus"||a==="Blur")&&(o||={focused:!1}),this._setEventListener(d,o,i,a,t),a==="Focus"&&!this.data.actions?.Blur?this._setEventListener(d,o,"blur","Blur",null):a==="Blur"&&!this.data.actions?.Focus&&this._setEventListener(d,o,"focus","Focus",null))}_setBackgroundColor(d){const o=this.data.backgroundColor||null;d.style.backgroundColor=o===null?"transparent":A.Util.makeHexColor(o[0],o[1],o[2])}_setTextStyle(d){const o=["left","center","right"],{fontColor:s}=this.data.defaultAppearanceData,t=this.data.defaultAppearanceData.fontSize||l,i=d.style;let a;const h=2,f=w=>Math.round(10*w)/10;if(this.data.multiLine){const w=Math.abs(this.data.rect[3]-this.data.rect[1]-h),x=Math.round(w/(A.LINE_FACTOR*t))||1,T=w/x;a=Math.min(t,f(T/A.LINE_FACTOR))}else{const w=Math.abs(this.data.rect[3]-this.data.rect[1]-h);a=Math.min(t,f(w/A.LINE_FACTOR))}i.fontSize=`calc(${a}px * var(--scale-factor))`,i.color=A.Util.makeHexColor(s[0],s[1],s[2]),this.data.textAlignment!==null&&(i.textAlign=o[this.data.textAlignment])}_setRequired(d,o){o?d.setAttribute("required",!0):d.removeAttribute("required"),d.setAttribute("aria-required",o)}}class b extends c{constructor(d){const o=d.renderForms||d.data.hasOwnCanvas||!d.data.hasAppearance&&!!d.data.fieldValue;super(d,{isRenderable:o})}setPropertyOnSiblings(d,o,s,t){const i=this.annotationStorage;for(const a of this._getElementsByName(d.name,d.id))a.domElement&&(a.domElement[o]=s),i.setValue(a.id,{[t]:s})}render(){const d=this.annotationStorage,o=this.data.id;this.container.classList.add("textWidgetAnnotation");let s=null;if(this.renderForms){const t=d.getValue(o,{value:this.data.fieldValue});let i=t.value||"";const a=d.getValue(o,{charLimit:this.data.maxLen}).charLimit;a&&i.length>a&&(i=i.slice(0,a));let h=t.formattedValue||this.data.textContent?.join(`
`)||null;h&&this.data.comb&&(h=h.replaceAll(/\s+/g,""));const f={userValue:i,formattedValue:h,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(s=document.createElement("textarea"),s.textContent=h??i,this.data.doNotScroll&&(s.style.overflowY="hidden")):(s=document.createElement("input"),s.type="text",s.setAttribute("value",h??i),this.data.doNotScroll&&(s.style.overflowX="hidden")),this.data.hasOwnCanvas&&(s.hidden=!0),u.add(s),s.setAttribute("data-element-id",o),s.disabled=this.data.readOnly,s.name=this.data.fieldName,s.tabIndex=v,this._setRequired(s,this.data.required),a&&(s.maxLength=a),s.addEventListener("input",x=>{d.setValue(o,{value:x.target.value}),this.setPropertyOnSiblings(s,"value",x.target.value,"value"),f.formattedValue=null}),s.addEventListener("resetform",x=>{const T=this.data.defaultFieldValue??"";s.value=f.userValue=T,f.formattedValue=null});let w=x=>{const{formattedValue:T}=f;T!=null&&(x.target.value=T),x.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){s.addEventListener("focus",T=>{if(f.focused)return;const{target:F}=T;f.userValue&&(F.value=f.userValue),f.lastCommittedValue=F.value,f.commitKey=1,this.data.actions?.Focus||(f.focused=!0)}),s.addEventListener("updatefromsandbox",T=>{this.showElementAndHideCanvas(T.target);const F={value(I){f.userValue=I.detail.value??"",d.setValue(o,{value:f.userValue.toString()}),I.target.value=f.userValue},formattedValue(I){const{formattedValue:H}=I.detail;f.formattedValue=H,H!=null&&I.target!==document.activeElement&&(I.target.value=H),d.setValue(o,{formattedValue:H})},selRange(I){I.target.setSelectionRange(...I.detail.selRange)},charLimit:I=>{const{charLimit:H}=I.detail,{target:N}=I;if(H===0){N.removeAttribute("maxLength");return}N.setAttribute("maxLength",H);let S=f.userValue;!S||S.length<=H||(S=S.slice(0,H),N.value=f.userValue=S,d.setValue(o,{value:S}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:o,name:"Keystroke",value:S,willCommit:!0,commitKey:1,selStart:N.selectionStart,selEnd:N.selectionEnd}}))}};this._dispatchEventFromSandbox(F,T)}),s.addEventListener("keydown",T=>{f.commitKey=1;let F=-1;if(T.key==="Escape"?F=0:T.key==="Enter"&&!this.data.multiLine?F=2:T.key==="Tab"&&(f.commitKey=3),F===-1)return;const{value:I}=T.target;f.lastCommittedValue!==I&&(f.lastCommittedValue=I,f.userValue=I,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:o,name:"Keystroke",value:I,willCommit:!0,commitKey:F,selStart:T.target.selectionStart,selEnd:T.target.selectionEnd}}))});const x=w;w=null,s.addEventListener("blur",T=>{if(!f.focused||!T.relatedTarget)return;this.data.actions?.Blur||(f.focused=!1);const{value:F}=T.target;f.userValue=F,f.lastCommittedValue!==F&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:o,name:"Keystroke",value:F,willCommit:!0,commitKey:f.commitKey,selStart:T.target.selectionStart,selEnd:T.target.selectionEnd}}),x(T)}),this.data.actions?.Keystroke&&s.addEventListener("beforeinput",T=>{f.lastCommittedValue=null;const{data:F,target:I}=T,{value:H,selectionStart:N,selectionEnd:S}=I;let L=N,$=S;switch(T.inputType){case"deleteWordBackward":{const X=H.substring(0,N).match(/\w*[^\w]*$/);X&&(L-=X[0].length);break}case"deleteWordForward":{const X=H.substring(N).match(/^[^\w]*\w*/);X&&($+=X[0].length);break}case"deleteContentBackward":N===S&&(L-=1);break;case"deleteContentForward":N===S&&($+=1);break}T.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:o,name:"Keystroke",value:H,change:F||"",willCommit:!1,selStart:L,selEnd:$}})}),this._setEventListeners(s,f,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],T=>T.target.value)}if(w&&s.addEventListener("blur",w),this.data.comb){const T=(this.data.rect[2]-this.data.rect[0])/a;s.classList.add("comb"),s.style.letterSpacing=`calc(${T}px * var(--scale-factor) - 1ch)`}}else s=document.createElement("div"),s.textContent=this.data.fieldValue,s.style.verticalAlign="middle",s.style.display="table-cell",this.data.hasOwnCanvas&&(s.hidden=!0);return this._setTextStyle(s),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class m extends c{constructor(d){super(d,{isRenderable:!!d.data.hasOwnCanvas})}}class R extends c{constructor(d){super(d,{isRenderable:d.renderForms})}render(){const d=this.annotationStorage,o=this.data,s=o.id;let t=d.getValue(s,{value:o.exportValue===o.fieldValue}).value;typeof t=="string"&&(t=t!=="Off",d.setValue(s,{value:t})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const i=document.createElement("input");return u.add(i),i.setAttribute("data-element-id",s),i.disabled=o.readOnly,this._setRequired(i,this.data.required),i.type="checkbox",i.name=o.fieldName,t&&i.setAttribute("checked",!0),i.setAttribute("exportValue",o.exportValue),i.tabIndex=v,i.addEventListener("change",a=>{const{name:h,checked:f}=a.target;for(const w of this._getElementsByName(h,s)){const x=f&&w.exportValue===o.exportValue;w.domElement&&(w.domElement.checked=x),d.setValue(w.id,{value:x})}d.setValue(s,{value:f})}),i.addEventListener("resetform",a=>{const h=o.defaultFieldValue||"Off";a.target.checked=h===o.exportValue}),this.enableScripting&&this.hasJSActions&&(i.addEventListener("updatefromsandbox",a=>{const h={value(f){f.target.checked=f.detail.value!=="Off",d.setValue(s,{value:f.target.checked})}};this._dispatchEventFromSandbox(h,a)}),this._setEventListeners(i,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],a=>a.target.checked)),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class E extends c{constructor(d){super(d,{isRenderable:d.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const d=this.annotationStorage,o=this.data,s=o.id;let t=d.getValue(s,{value:o.fieldValue===o.buttonValue}).value;if(typeof t=="string"&&(t=t!==o.buttonValue,d.setValue(s,{value:t})),t)for(const a of this._getElementsByName(o.fieldName,s))d.setValue(a.id,{value:!1});const i=document.createElement("input");if(u.add(i),i.setAttribute("data-element-id",s),i.disabled=o.readOnly,this._setRequired(i,this.data.required),i.type="radio",i.name=o.fieldName,t&&i.setAttribute("checked",!0),i.tabIndex=v,i.addEventListener("change",a=>{const{name:h,checked:f}=a.target;for(const w of this._getElementsByName(h,s))d.setValue(w.id,{value:!1});d.setValue(s,{value:f})}),i.addEventListener("resetform",a=>{const h=o.defaultFieldValue;a.target.checked=h!=null&&h===o.buttonValue}),this.enableScripting&&this.hasJSActions){const a=o.buttonValue;i.addEventListener("updatefromsandbox",h=>{const f={value:w=>{const x=a===w.detail.value;for(const T of this._getElementsByName(w.target.name)){const F=x&&T.id===s;T.domElement&&(T.domElement.checked=F),d.setValue(T.id,{value:F})}}};this._dispatchEventFromSandbox(f,h)}),this._setEventListeners(i,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],h=>h.target.checked)}return this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class M extends e{constructor(d){super(d,{ignoreBorder:d.data.hasAppearance})}render(){const d=super.render();d.classList.add("buttonWidgetAnnotation","pushButton"),this.data.alternativeText&&(d.title=this.data.alternativeText);const o=d.lastChild;return this.enableScripting&&this.hasJSActions&&o&&(this._setDefaultPropertiesFromJS(o),o.addEventListener("updatefromsandbox",s=>{this._dispatchEventFromSandbox({},s)})),d}}class V extends c{constructor(d){super(d,{isRenderable:d.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const d=this.annotationStorage,o=this.data.id,s=d.getValue(o,{value:this.data.fieldValue}),t=document.createElement("select");u.add(t),t.setAttribute("data-element-id",o),t.disabled=this.data.readOnly,this._setRequired(t,this.data.required),t.name=this.data.fieldName,t.tabIndex=v;let i=this.data.combo&&this.data.options.length>0;this.data.combo||(t.size=this.data.options.length,this.data.multiSelect&&(t.multiple=!0)),t.addEventListener("resetform",x=>{const T=this.data.defaultFieldValue;for(const F of t.options)F.selected=F.value===T});for(const x of this.data.options){const T=document.createElement("option");T.textContent=x.displayValue,T.value=x.exportValue,s.value.includes(x.exportValue)&&(T.setAttribute("selected",!0),i=!1),t.append(T)}let a=null;if(i){const x=document.createElement("option");x.value=" ",x.setAttribute("hidden",!0),x.setAttribute("selected",!0),t.prepend(x),a=()=>{x.remove(),t.removeEventListener("input",a),a=null},t.addEventListener("input",a)}const h=x=>{const T=x?"value":"textContent",{options:F,multiple:I}=t;return I?Array.prototype.filter.call(F,H=>H.selected).map(H=>H[T]):F.selectedIndex===-1?null:F[F.selectedIndex][T]};let f=h(!1);const w=x=>{const T=x.target.options;return Array.prototype.map.call(T,F=>({displayValue:F.textContent,exportValue:F.value}))};return this.enableScripting&&this.hasJSActions?(t.addEventListener("updatefromsandbox",x=>{const T={value(F){a?.();const I=F.detail.value,H=new Set(Array.isArray(I)?I:[I]);for(const N of t.options)N.selected=H.has(N.value);d.setValue(o,{value:h(!0)}),f=h(!1)},multipleSelection(F){t.multiple=!0},remove(F){const I=t.options,H=F.detail.remove;I[H].selected=!1,t.remove(H),I.length>0&&Array.prototype.findIndex.call(I,S=>S.selected)===-1&&(I[0].selected=!0),d.setValue(o,{value:h(!0),items:w(F)}),f=h(!1)},clear(F){for(;t.length!==0;)t.remove(0);d.setValue(o,{value:null,items:[]}),f=h(!1)},insert(F){const{index:I,displayValue:H,exportValue:N}=F.detail.insert,S=t.children[I],L=document.createElement("option");L.textContent=H,L.value=N,S?S.before(L):t.append(L),d.setValue(o,{value:h(!0),items:w(F)}),f=h(!1)},items(F){const{items:I}=F.detail;for(;t.length!==0;)t.remove(0);for(const H of I){const{displayValue:N,exportValue:S}=H,L=document.createElement("option");L.textContent=N,L.value=S,t.append(L)}t.options.length>0&&(t.options[0].selected=!0),d.setValue(o,{value:h(!0),items:w(F)}),f=h(!1)},indices(F){const I=new Set(F.detail.indices);for(const H of F.target.options)H.selected=I.has(H.index);d.setValue(o,{value:h(!0)}),f=h(!1)},editable(F){F.target.disabled=!F.detail.editable}};this._dispatchEventFromSandbox(T,x)}),t.addEventListener("input",x=>{const T=h(!0);d.setValue(o,{value:T}),x.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:o,name:"Keystroke",value:f,changeEx:T,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(t,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],x=>x.target.value)):t.addEventListener("input",function(x){d.setValue(o,{value:h(!0)})}),this.data.combo&&this._setTextStyle(t),this._setBackgroundColor(t),this._setDefaultPropertiesFromJS(t),this.container.append(t),this.container}}class G extends p{constructor(d){const{data:o,elements:s}=d;super(d,{isRenderable:p._hasPopupData(o)}),this.elements=s}render(){this.container.classList.add("popupAnnotation");const d=new _({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),o=[];for(const s of this.elements)s.popup=d,o.push(s.data.id),s.addHighlightArea();return this.container.setAttribute("aria-controls",o.map(s=>`${A.AnnotationPrefix}${s}`).join(",")),this.container}}class _{#t=this.#A.bind(this);#e=this.#g.bind(this);#s=this.#v.bind(this);#i=this.#y.bind(this);#n=null;#r=null;#o=null;#l=null;#h=null;#c=null;#f=null;#u=!1;#d=null;#a=null;#p=null;#m=null;#b=!1;constructor({container:d,color:o,elements:s,titleObj:t,modificationDate:i,contentsObj:a,richText:h,parent:f,rect:w,parentRect:x,open:T}){this.#r=d,this.#m=t,this.#o=a,this.#p=h,this.#c=f,this.#n=o,this.#a=w,this.#f=x,this.#h=s,this.#l=z.PDFDateString.toDateObject(i),this.trigger=s.flatMap(F=>F.getElementsToTriggerPopup());for(const F of this.trigger)F.addEventListener("click",this.#i),F.addEventListener("mouseenter",this.#s),F.addEventListener("mouseleave",this.#e),F.classList.add("popupTriggerArea");for(const F of s)F.container?.addEventListener("keydown",this.#t);this.#r.hidden=!0,T&&this.#y()}render(){if(this.#d)return;const{page:{view:d},viewport:{rawDims:{pageWidth:o,pageHeight:s,pageX:t,pageY:i}}}=this.#c,a=this.#d=document.createElement("div");if(a.className="popup",this.#n){const X=a.style.outlineColor=A.Util.makeHexColor(...this.#n);CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?a.style.backgroundColor=`color-mix(in srgb, ${X} 30%, white)`:a.style.backgroundColor=A.Util.makeHexColor(...this.#n.map(et=>Math.floor(.7*(255-et)+et)))}const h=document.createElement("span");h.className="header";const f=document.createElement("h1");if(h.append(f),{dir:f.dir,str:f.textContent}=this.#m,a.append(h),this.#l){const X=document.createElement("span");X.classList.add("popupDate"),X.setAttribute("data-l10n-id","pdfjs-annotation-date-string"),X.setAttribute("data-l10n-args",JSON.stringify({date:this.#l.toLocaleDateString(),time:this.#l.toLocaleTimeString()})),h.append(X)}const w=this.#o,x=this.#p;if(x?.str&&(!w?.str||w.str===x.str))y.XfaLayer.render({xfaHtml:x.html,intent:"richText",div:a}),a.lastChild.classList.add("richText","popupContent");else{const X=this._formatContents(w);a.append(X)}let T=!!this.#f,F=T?this.#f:this.#a;for(const X of this.#h)if(!F||A.Util.intersect(X.data.rect,F)!==null){F=X.data.rect,T=!0;break}const I=A.Util.normalizeRect([F[0],d[3]-F[1]+d[1],F[2],d[3]-F[3]+d[1]]),N=T?F[2]-F[0]+5:0,S=I[0]+N,L=I[1],{style:$}=this.#r;$.left=`${100*(S-t)/o}%`,$.top=`${100*(L-i)/s}%`,this.#r.append(a)}_formatContents({str:d,dir:o}){const s=document.createElement("p");s.classList.add("popupContent"),s.dir=o;const t=d.split(/(?:\r\n?|\n)/);for(let i=0,a=t.length;i<a;++i){const h=t[i];s.append(document.createTextNode(h)),i<a-1&&s.append(document.createElement("br"))}return s}#A(d){d.altKey||d.shiftKey||d.ctrlKey||d.metaKey||(d.key==="Enter"||d.key==="Escape"&&this.#u)&&this.#y()}#y(){this.#u=!this.#u,this.#u?(this.#v(),this.#r.addEventListener("click",this.#i),this.#r.addEventListener("keydown",this.#t)):(this.#g(),this.#r.removeEventListener("click",this.#i),this.#r.removeEventListener("keydown",this.#t))}#v(){this.#d||this.render(),this.isVisible?this.#u&&this.#r.classList.add("focused"):(this.#r.hidden=!1,this.#r.style.zIndex=parseInt(this.#r.style.zIndex)+1e3)}#g(){this.#r.classList.remove("focused"),!(this.#u||!this.isVisible)&&(this.#r.hidden=!0,this.#r.style.zIndex=parseInt(this.#r.style.zIndex)-1e3)}forceHide(){this.#b=this.isVisible,this.#b&&(this.#r.hidden=!0)}maybeShow(){this.#b&&(this.#b=!1,this.#r.hidden=!1)}get isVisible(){return this.#r.hidden===!1}}class Y extends p{constructor(d){super(d,{isRenderable:!0,ignoreBorder:!0}),this.textContent=d.data.textContent,this.textPosition=d.data.textPosition,this.annotationEditorType=A.AnnotationEditorType.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const d=document.createElement("div");d.classList.add("annotationTextContent"),d.setAttribute("role","comment");for(const o of this.textContent){const s=document.createElement("span");s.textContent=o,d.append(s)}this.container.append(d)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}get _isEditable(){return this.data.hasOwnCanvas}}class tt extends p{#t=null;constructor(d){super(d,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("lineAnnotation");const d=this.data,{width:o,height:s}=g(d.rect),t=this.svgFactory.create(o,s,!0),i=this.#t=this.svgFactory.createElement("svg:line");return i.setAttribute("x1",d.rect[2]-d.lineCoordinates[0]),i.setAttribute("y1",d.rect[3]-d.lineCoordinates[1]),i.setAttribute("x2",d.rect[2]-d.lineCoordinates[2]),i.setAttribute("y2",d.rect[3]-d.lineCoordinates[3]),i.setAttribute("stroke-width",d.borderStyle.width||1),i.setAttribute("stroke","transparent"),i.setAttribute("fill","transparent"),t.append(i),this.container.append(t),!d.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class rt extends p{#t=null;constructor(d){super(d,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("squareAnnotation");const d=this.data,{width:o,height:s}=g(d.rect),t=this.svgFactory.create(o,s,!0),i=d.borderStyle.width,a=this.#t=this.svgFactory.createElement("svg:rect");return a.setAttribute("x",i/2),a.setAttribute("y",i/2),a.setAttribute("width",o-i),a.setAttribute("height",s-i),a.setAttribute("stroke-width",i||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),t.append(a),this.container.append(t),!d.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class j extends p{#t=null;constructor(d){super(d,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("circleAnnotation");const d=this.data,{width:o,height:s}=g(d.rect),t=this.svgFactory.create(o,s,!0),i=d.borderStyle.width,a=this.#t=this.svgFactory.createElement("svg:ellipse");return a.setAttribute("cx",o/2),a.setAttribute("cy",s/2),a.setAttribute("rx",o/2-i/2),a.setAttribute("ry",s/2-i/2),a.setAttribute("stroke-width",i||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),t.append(a),this.container.append(t),!d.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class O extends p{#t=null;constructor(d){super(d,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const d=this.data,{width:o,height:s}=g(d.rect),t=this.svgFactory.create(o,s,!0);let i=[];for(const h of d.vertices){const f=h.x-d.rect[0],w=d.rect[3]-h.y;i.push(f+","+w)}i=i.join(" ");const a=this.#t=this.svgFactory.createElement(this.svgElementName);return a.setAttribute("points",i),a.setAttribute("stroke-width",d.borderStyle.width||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),t.append(a),this.container.append(t),!d.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class B extends O{constructor(d){super(d),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class q extends p{constructor(d){super(d,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class Q extends p{#t=[];constructor(d){super(d,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=A.AnnotationEditorType.INK}render(){this.container.classList.add(this.containerClassName);const d=this.data,{width:o,height:s}=g(d.rect),t=this.svgFactory.create(o,s,!0);for(const i of d.inkLists){let a=[];for(const f of i){const w=f.x-d.rect[0],x=d.rect[3]-f.y;a.push(`${w},${x}`)}a=a.join(" ");const h=this.svgFactory.createElement(this.svgElementName);this.#t.push(h),h.setAttribute("points",a),h.setAttribute("stroke-width",d.borderStyle.width||1),h.setAttribute("stroke","transparent"),h.setAttribute("fill","transparent"),!d.popupRef&&this.hasPopupData&&this._createPopup(),t.append(h)}return this.container.append(t),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class K extends p{constructor(d){super(d,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this.container}}class ft extends p{constructor(d){super(d,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class ot extends p{constructor(d){super(d,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class at extends p{constructor(d){super(d,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class gt extends p{constructor(d){super(d,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("stampAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class dt extends p{#t=null;constructor(d){super(d,{isRenderable:!0});const{filename:o,content:s}=this.data.file;this.filename=(0,z.getFilenameFromUrl)(o,!0),this.content=s,this.linkService.eventBus?.dispatch("fileattachmentannotation",{source:this,filename:o,content:s})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:d,data:o}=this;let s;o.hasAppearance||o.fillAlpha===0?s=document.createElement("div"):(s=document.createElement("img"),s.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(o.name)?"paperclip":"pushpin"}.svg`,o.fillAlpha&&o.fillAlpha<1&&(s.style=`filter: opacity(${Math.round(o.fillAlpha*100)}%);`)),s.addEventListener("dblclick",this.#e.bind(this)),this.#t=s;const{isMac:t}=A.FeatureTest.platform;return d.addEventListener("keydown",i=>{i.key==="Enter"&&(t?i.metaKey:i.ctrlKey)&&this.#e()}),!o.popupRef&&this.hasPopupData?this._createPopup():s.classList.add("popupTriggerArea"),d.append(s),d}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}#e(){this.downloadManager?.openOrDownloadData(this.content,this.filename)}}class ct{#t=null;#e=null;#s=new Map;constructor({div:d,accessibilityManager:o,annotationCanvasMap:s,page:t,viewport:i}){this.div=d,this.#t=o,this.#e=s,this.page=t,this.viewport=i,this.zIndex=0}#i(d,o){const s=d.firstChild||d;s.id=`${A.AnnotationPrefix}${o}`,this.div.append(d),this.#t?.moveElementInDOM(this.div,d,s,!1)}async render(d){const{annotations:o}=d,s=this.div;(0,z.setLayerDimensions)(s,this.viewport);const t=new Map,i={data:null,layer:s,linkService:d.linkService,downloadManager:d.downloadManager,imageResourcesPath:d.imageResourcesPath||"",renderForms:d.renderForms!==!1,svgFactory:new z.DOMSVGFactory,annotationStorage:d.annotationStorage||new C.AnnotationStorage,enableScripting:d.enableScripting===!0,hasJSActions:d.hasJSActions,fieldObjects:d.fieldObjects,parent:this,elements:null};for(const a of o){if(a.noHTML)continue;const h=a.annotationType===A.AnnotationType.POPUP;if(h){const x=t.get(a.id);if(!x)continue;i.elements=x}else{const{width:x,height:T}=g(a.rect);if(x<=0||T<=0)continue}i.data=a;const f=r.create(i);if(!f.isRenderable)continue;if(!h&&a.popupRef){const x=t.get(a.popupRef);x?x.push(f):t.set(a.popupRef,[f])}f.annotationEditorType>0&&this.#s.set(f.data.id,f);const w=f.render();a.hidden&&(w.style.visibility="hidden"),this.#i(w,a.id)}this.#n()}update({viewport:d}){const o=this.div;this.viewport=d,(0,z.setLayerDimensions)(o,{rotation:d.rotation}),this.#n(),o.hidden=!1}#n(){if(!this.#e)return;const d=this.div;for(const[o,s]of this.#e){const t=d.querySelector(`[data-annotation-id="${o}"]`);if(!t)continue;const{firstChild:i}=t;i?i.nodeName==="CANVAS"?i.replaceWith(s):i.before(s):t.append(s)}this.#e.clear()}getEditableAnnotations(){return Array.from(this.#s.values())}getEditableAnnotation(d){return this.#s.get(d)}}},780:(ht,Z,U)=>{U.d(Z,{AnnotationStorage:()=>k,PrintAnnotationStorage:()=>P,SerializableEmpty:()=>D});var A=U(266),z=U(115),C=U(825);const D=Object.freeze({map:null,hash:"",transfer:void 0});class k{#t=!1;#e=new Map;constructor(){this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(v,l){const u=this.#e.get(v);return u===void 0?l:Object.assign(l,u)}getRawValue(v){return this.#e.get(v)}remove(v){if(this.#e.delete(v),this.#e.size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const l of this.#e.values())if(l instanceof z.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(v,l){const u=this.#e.get(v);let g=!1;if(u!==void 0)for(const[r,p]of Object.entries(l))u[r]!==p&&(g=!0,u[r]=p);else g=!0,this.#e.set(v,l);g&&this.#s(),l instanceof z.AnnotationEditor&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(l.constructor._type)}has(v){return this.#e.has(v)}getAll(){return this.#e.size>0?(0,A.objectFromMap)(this.#e):null}setAll(v){for(const[l,u]of Object.entries(v))this.setValue(l,u)}get size(){return this.#e.size}#s(){this.#t||(this.#t=!0,typeof this.onSetModified=="function"&&this.onSetModified())}resetModified(){this.#t&&(this.#t=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new P(this)}get serializable(){if(this.#e.size===0)return D;const v=new Map,l=new C.MurmurHash3_64,u=[],g=Object.create(null);let r=!1;for(const[p,e]of this.#e){const n=e instanceof z.AnnotationEditor?e.serialize(!1,g):e;n&&(v.set(p,n),l.update(`${p}:${JSON.stringify(n)}`),r||=!!n.bitmap)}if(r)for(const p of v.values())p.bitmap&&u.push(p.bitmap);return v.size>0?{map:v,hash:l.hexdigest(),transfer:u}:D}}class P extends k{#t;constructor(v){super();const{map:l,hash:u,transfer:g}=v.serializable,r=structuredClone(l,g?{transfer:g}:null);this.#t={map:r,hash:u,transfer:g}}get print(){(0,A.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return this.#t}}},406:(ht,Z,U)=>{U.a(ht,async(A,z)=>{try{let tt=function(s){if(typeof s=="string"||s instanceof URL?s={url:s}:(0,C.isArrayBuffer)(s)&&(s={data:s}),typeof s!="object")throw new Error("Invalid parameter in getDocument, need parameter object.");if(!s.url&&!s.data&&!s.range)throw new Error("Invalid parameter object: need either .data, .range or .url");const t=new B,{docId:i}=t,a=s.url?j(s.url):null,h=s.data?O(s.data):null,f=s.httpHeaders||null,w=s.withCredentials===!0,x=s.password??null,T=s.range instanceof q?s.range:null,F=Number.isInteger(s.rangeChunkSize)&&s.rangeChunkSize>0?s.rangeChunkSize:R;let I=s.worker instanceof at?s.worker:null;const H=s.verbosity,N=typeof s.docBaseUrl=="string"&&!(0,k.isDataScheme)(s.docBaseUrl)?s.docBaseUrl:null,S=typeof s.cMapUrl=="string"?s.cMapUrl:null,L=s.cMapPacked!==!1,$=s.CMapReaderFactory||G,X=typeof s.standardFontDataUrl=="string"?s.standardFontDataUrl:null,W=s.StandardFontDataFactory||Y,et=s.stopAtErrors!==!0,st=Number.isInteger(s.maxImageSize)&&s.maxImageSize>-1?s.maxImageSize:-1,nt=s.isEvalSupported!==!1,it=typeof s.isOffscreenCanvasSupported=="boolean"?s.isOffscreenCanvasSupported:!C.isNodeJS,lt=Number.isInteger(s.canvasMaxAreaInBytes)?s.canvasMaxAreaInBytes:-1,mt=typeof s.disableFontFace=="boolean"?s.disableFontFace:C.isNodeJS,bt=s.fontExtraProperties===!0,At=s.enableXfa===!0,pt=s.ownerDocument||globalThis.document,Et=s.disableRange===!0,St=s.disableStream===!0,Tt=s.disableAutoFetch===!0,vt=s.pdfBug===!0,wt=T?T.length:s.length??NaN,yt=typeof s.useSystemFonts=="boolean"?s.useSystemFonts:!C.isNodeJS&&!mt,Rt=typeof s.useWorkerFetch=="boolean"?s.useWorkerFetch:$===k.DOMCMapReaderFactory&&W===k.DOMStandardFontDataFactory&&S&&X&&(0,k.isValidFetchUrl)(S,document.baseURI)&&(0,k.isValidFetchUrl)(X,document.baseURI),kt=s.canvasFactory||new V({ownerDocument:pt}),Ot=s.filterFactory||new _({docId:i,ownerDocument:pt}),Ht=null;(0,C.setVerbosityLevel)(H);const Ft={canvasFactory:kt,filterFactory:Ot};if(Rt||(Ft.cMapReaderFactory=new $({baseUrl:S,isCompressed:L}),Ft.standardFontDataFactory=new W({baseUrl:X})),!I){const Pt={verbosity:H,port:l.GlobalWorkerOptions.workerPort};I=Pt.port?at.fromPort(Pt):new at(Pt),t._worker=I}const Ct={docId:i,apiVersion:"4.0.379",data:h,password:x,disableAutoFetch:Tt,rangeChunkSize:F,length:wt,docBaseUrl:N,enableXfa:At,evaluatorOptions:{maxImageSize:st,disableFontFace:mt,ignoreErrors:et,isEvalSupported:nt,isOffscreenCanvasSupported:it,canvasMaxAreaInBytes:lt,fontExtraProperties:bt,useSystemFonts:yt,cMapUrl:Rt?S:null,standardFontDataUrl:Rt?X:null}},Bt={ignoreErrors:et,isEvalSupported:nt,disableFontFace:mt,fontExtraProperties:bt,enableXfa:At,ownerDocument:pt,disableAutoFetch:Tt,pdfBug:vt,styleElement:Ht};return I.promise.then(function(){if(t.destroyed)throw new Error("Loading aborted");const Pt=rt(I,Ct),It=new Promise(function(xt){let Nt;T?Nt=new p.PDFDataTransportStream({length:wt,initialData:T.initialData,progressiveDone:T.progressiveDone,contentDispositionFilename:T.contentDispositionFilename,disableRange:Et,disableStream:St},T):h||(Nt=(Dt=>C.isNodeJS?new c.PDFNodeStream(Dt):(0,k.isValidFetchUrl)(Dt.url)?new e.PDFFetchStream(Dt):new n.PDFNetworkStream(Dt))({url:a,length:wt,httpHeaders:f,withCredentials:w,rangeChunkSize:F,disableRange:Et,disableStream:St})),xt(Nt)});return Promise.all([Pt,It]).then(function([xt,Nt]){if(t.destroyed)throw new Error("Loading aborted");const zt=new u.MessageHandler(i,xt,I.port),Dt=new gt(zt,t,Nt,Bt,Ft);t._transport=Dt,zt.send("Ready",null)})}).catch(t._capability.reject),t},j=function(s){if(s instanceof URL)return s.href;try{return new URL(s,window.location).href}catch{if(C.isNodeJS&&typeof s=="string")return s}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")},O=function(s){if(C.isNodeJS&&typeof Buffer<"u"&&s instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(s instanceof Uint8Array&&s.byteLength===s.buffer.byteLength)return s;if(typeof s=="string")return(0,C.stringToBytes)(s);if(typeof s=="object"&&!isNaN(s?.length)||(0,C.isArrayBuffer)(s))return new Uint8Array(s);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")};U.d(Z,{PDFDataRangeTransport:()=>q,PDFWorker:()=>at,build:()=>o,getDocument:()=>tt,version:()=>d});var C=U(266),D=U(780),k=U(473),P=U(742),y=U(738),v=U(250),l=U(368),u=U(694),g=U(472),r=U(890),p=U(92),e=U(171),n=U(474),c=U(498),b=U(521),m=A([y,c]);[y,c]=m.then?(await m)():m;const R=65536,E=100,M=5e3,V=C.isNodeJS?y.NodeCanvasFactory:k.DOMCanvasFactory,G=C.isNodeJS?y.NodeCMapReaderFactory:k.DOMCMapReaderFactory,_=C.isNodeJS?y.NodeFilterFactory:k.DOMFilterFactory,Y=C.isNodeJS?y.NodeStandardFontDataFactory:k.DOMStandardFontDataFactory;async function rt(s,t){if(s.destroyed)throw new Error("Worker was destroyed");const i=await s.messageHandler.sendWithPromise("GetDocRequest",t,t.data?[t.data.buffer]:null);if(s.destroyed)throw new Error("Worker was destroyed");return i}class B{static#t=0;constructor(){this._capability=new C.PromiseCapability,this._transport=null,this._worker=null,this.docId=`d${B.#t++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){this.destroyed=!0;try{this._worker?.port&&(this._worker._pendingDestroy=!0),await this._transport?.destroy()}catch(t){throw this._worker?.port&&delete this._worker._pendingDestroy,t}this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}}class q{constructor(t,i,a=!1,h=null){this.length=t,this.initialData=i,this.progressiveDone=a,this.contentDispositionFilename=h,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=new C.PromiseCapability}addRangeListener(t){this._rangeListeners.push(t)}addProgressListener(t){this._progressListeners.push(t)}addProgressiveReadListener(t){this._progressiveReadListeners.push(t)}addProgressiveDoneListener(t){this._progressiveDoneListeners.push(t)}onDataRange(t,i){for(const a of this._rangeListeners)a(t,i)}onDataProgress(t,i){this._readyCapability.promise.then(()=>{for(const a of this._progressListeners)a(t,i)})}onDataProgressiveRead(t){this._readyCapability.promise.then(()=>{for(const i of this._progressiveReadListeners)i(t)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const t of this._progressiveDoneListeners)t()})}transportReady(){this._readyCapability.resolve()}requestDataRange(t,i){(0,C.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}class Q{constructor(t,i){this._pdfInfo=t,this._transport=i}get annotationStorage(){return this._transport.annotationStorage}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return(0,C.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(t){return this._transport.getPage(t)}getPageIndex(t){return this._transport.getPageIndex(t)}getDestinations(){return this._transport.getDestinations()}getDestination(t){return this._transport.getDestination(t)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(t=!1){return this._transport.startCleanup(t||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}class K{#t=null;#e=!1;constructor(t,i,a,h=!1){this._pageIndex=t,this._pageInfo=i,this._transport=a,this._stats=h?new k.StatTimer:null,this._pdfBug=h,this.commonObjs=a.commonObjs,this.objs=new dt,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:t,rotation:i=this.rotate,offsetX:a=0,offsetY:h=0,dontFlip:f=!1}={}){return new k.PageViewport({viewBox:this.view,scale:t,rotation:i,offsetX:a,offsetY:h,dontFlip:f})}getAnnotations({intent:t="display"}={}){const i=this._transport.getRenderingIntent(t);return this._transport.getAnnotations(this._pageIndex,i.renderingIntent)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return(0,C.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){return this._transport._htmlForXfa?.children[this._pageIndex]||null}render({canvasContext:t,viewport:i,intent:a="display",annotationMode:h=C.AnnotationMode.ENABLE,transform:f=null,background:w=null,optionalContentConfigPromise:x=null,annotationCanvasMap:T=null,pageColors:F=null,printAnnotationStorage:I=null}){this._stats?.time("Overall");const H=this._transport.getRenderingIntent(a,h,I);this.#e=!1,this.#i(),x||(x=this._transport.getOptionalContentConfig());let N=this._intentStates.get(H.cacheKey);N||(N=Object.create(null),this._intentStates.set(H.cacheKey,N)),N.streamReaderCancelTimeout&&(clearTimeout(N.streamReaderCancelTimeout),N.streamReaderCancelTimeout=null);const S=!!(H.renderingIntent&C.RenderingIntentFlag.PRINT);N.displayReadyCapability||(N.displayReadyCapability=new C.PromiseCapability,N.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(H));const L=W=>{N.renderTasks.delete($),(this._maybeCleanupAfterRender||S)&&(this.#e=!0),this.#s(!S),W?($.capability.reject(W),this._abortOperatorList({intentState:N,reason:W instanceof Error?W:new Error(W)})):$.capability.resolve(),this._stats?.timeEnd("Rendering"),this._stats?.timeEnd("Overall")},$=new J({callback:L,params:{canvasContext:t,viewport:i,transform:f,background:w},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:T,operatorList:N.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!S,pdfBug:this._pdfBug,pageColors:F});(N.renderTasks||=new Set).add($);const X=$.task;return Promise.all([N.displayReadyCapability.promise,x]).then(([W,et])=>{if(this.destroyed){L();return}this._stats?.time("Rendering"),$.initializeGraphics({transparency:W,optionalContentConfig:et}),$.operatorListChanged()}).catch(L),X}getOperatorList({intent:t="display",annotationMode:i=C.AnnotationMode.ENABLE,printAnnotationStorage:a=null}={}){function h(){w.operatorList.lastChunk&&(w.opListReadCapability.resolve(w.operatorList),w.renderTasks.delete(x))}const f=this._transport.getRenderingIntent(t,i,a,!0);let w=this._intentStates.get(f.cacheKey);w||(w=Object.create(null),this._intentStates.set(f.cacheKey,w));let x;return w.opListReadCapability||(x=Object.create(null),x.operatorListChanged=h,w.opListReadCapability=new C.PromiseCapability,(w.renderTasks||=new Set).add(x),w.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(f)),w.opListReadCapability.promise}streamTextContent({includeMarkedContent:t=!1,disableNormalization:i=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:t===!0,disableNormalization:i===!0},{highWaterMark:100,size(h){return h.items.length}})}getTextContent(t={}){if(this._transport._htmlForXfa)return this.getXfa().then(a=>b.XfaText.textContent(a));const i=this.streamTextContent(t);return new Promise(function(a,h){function f(){w.read().then(function({value:T,done:F}){if(F){a(x);return}Object.assign(x.styles,T.styles),x.items.push(...T.items),f()},h)}const w=i.getReader(),x={items:[],styles:Object.create(null)};f()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const t=[];for(const i of this._intentStates.values())if(this._abortOperatorList({intentState:i,reason:new Error("Page was destroyed."),force:!0}),!i.opListReadCapability)for(const a of i.renderTasks)t.push(a.completed),a.cancel();return this.objs.clear(),this.#e=!1,this.#i(),Promise.all(t)}cleanup(t=!1){this.#e=!0;const i=this.#s(!1);return t&&i&&(this._stats&&=new k.StatTimer),i}#s(t=!1){if(this.#i(),!this.#e||this.destroyed)return!1;if(t)return this.#t=setTimeout(()=>{this.#t=null,this.#s(!1)},M),!1;for(const{renderTasks:i,operatorList:a}of this._intentStates.values())if(i.size>0||!a.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),this.#e=!1,!0}#i(){this.#t&&(clearTimeout(this.#t),this.#t=null)}_startRenderPage(t,i){const a=this._intentStates.get(i);a&&(this._stats?.timeEnd("Page Request"),a.displayReadyCapability?.resolve(t))}_renderPageChunk(t,i){for(let a=0,h=t.length;a<h;a++)i.operatorList.fnArray.push(t.fnArray[a]),i.operatorList.argsArray.push(t.argsArray[a]);i.operatorList.lastChunk=t.lastChunk,i.operatorList.separateAnnots=t.separateAnnots;for(const a of i.renderTasks)a.operatorListChanged();t.lastChunk&&this.#s(!0)}_pumpOperatorList({renderingIntent:t,cacheKey:i,annotationStorageSerializable:a}){const{map:h,transfer:f}=a,x=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:t,cacheKey:i,annotationStorage:h},f).getReader(),T=this._intentStates.get(i);T.streamReader=x;const F=()=>{x.read().then(({value:I,done:H})=>{if(H){T.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(I,T),F())},I=>{if(T.streamReader=null,!this._transport.destroyed){if(T.operatorList){T.operatorList.lastChunk=!0;for(const H of T.renderTasks)H.operatorListChanged();this.#s(!0)}if(T.displayReadyCapability)T.displayReadyCapability.reject(I);else if(T.opListReadCapability)T.opListReadCapability.reject(I);else throw I}})};F()}_abortOperatorList({intentState:t,reason:i,force:a=!1}){if(t.streamReader){if(t.streamReaderCancelTimeout&&(clearTimeout(t.streamReaderCancelTimeout),t.streamReaderCancelTimeout=null),!a){if(t.renderTasks.size>0)return;if(i instanceof k.RenderingCancelledException){let h=E;i.extraDelay>0&&i.extraDelay<1e3&&(h+=i.extraDelay),t.streamReaderCancelTimeout=setTimeout(()=>{t.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:t,reason:i,force:!0})},h);return}}if(t.streamReader.cancel(new C.AbortException(i.message)).catch(()=>{}),t.streamReader=null,!this._transport.destroyed){for(const[h,f]of this._intentStates)if(f===t){this._intentStates.delete(h);break}this.cleanup()}}}get stats(){return this._stats}}class ft{#t=new Set;#e=Promise.resolve();postMessage(t,i){const a={data:structuredClone(t,i?{transfer:i}:null)};this.#e.then(()=>{for(const h of this.#t)h.call(this,a)})}addEventListener(t,i){this.#t.add(i)}removeEventListener(t,i){this.#t.delete(i)}terminate(){this.#t.clear()}}const ot={isWorkerDisabled:!1,fakeWorkerId:0};C.isNodeJS&&(ot.isWorkerDisabled=!0,l.GlobalWorkerOptions.workerSrc||="./pdf.worker.mjs"),ot.isSameOrigin=function(s,t){let i;try{if(i=new URL(s),!i.origin||i.origin==="null")return!1}catch{return!1}const a=new URL(t,i);return i.origin===a.origin},ot.createCDNWrapper=function(s){const t=`await import("${s}");`;return URL.createObjectURL(new Blob([t],{type:"text/javascript"}))};class at{static#t;constructor({name:t=null,port:i=null,verbosity:a=(0,C.getVerbosityLevel)()}={}){if(this.name=t,this.destroyed=!1,this.verbosity=a,this._readyCapability=new C.PromiseCapability,this._port=null,this._webWorker=null,this._messageHandler=null,i){if(at.#t?.has(i))throw new Error("Cannot use more than one PDFWorker per port.");(at.#t||=new WeakMap).set(i,this),this._initializeFromPort(i);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(t){this._port=t,this._messageHandler=new u.MessageHandler("main","worker",t),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}_initialize(){if(!ot.isWorkerDisabled&&!at.#e){let{workerSrc:t}=at;try{ot.isSameOrigin(window.location.href,t)||(t=ot.createCDNWrapper(new URL(t,window.location).href));const i=new Worker(t,{type:"module"}),a=new u.MessageHandler("main","worker",i),h=()=>{i.removeEventListener("error",f),a.destroy(),i.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},f=()=>{this._webWorker||h()};i.addEventListener("error",f),a.on("test",x=>{if(i.removeEventListener("error",f),this.destroyed){h();return}x?(this._messageHandler=a,this._port=i,this._webWorker=i,this._readyCapability.resolve(),a.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),a.destroy(),i.terminate())}),a.on("ready",x=>{if(i.removeEventListener("error",f),this.destroyed){h();return}try{w()}catch{this._setupFakeWorker()}});const w=()=>{const x=new Uint8Array;a.send("test",x,[x.buffer])};w();return}catch{(0,C.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){ot.isWorkerDisabled||((0,C.warn)("Setting up fake worker."),ot.isWorkerDisabled=!0),at._setupFakeWorkerGlobal.then(t=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const i=new ft;this._port=i;const a=`fake${ot.fakeWorkerId++}`,h=new u.MessageHandler(a+"_worker",a,i);t.setup(h,i);const f=new u.MessageHandler(a,a+"_worker",i);this._messageHandler=f,this._readyCapability.resolve(),f.send("configure",{verbosity:this.verbosity})}).catch(t=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${t.message}".`))})}destroy(){this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),at.#t?.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(t){if(!t?.port)throw new Error("PDFWorker.fromPort - invalid method signature.");const i=this.#t?.get(t.port);if(i){if(i._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return i}return new at(t)}static get workerSrc(){if(l.GlobalWorkerOptions.workerSrc)return l.GlobalWorkerOptions.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get#e(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch{return null}}static get _setupFakeWorkerGlobal(){const t=async()=>this.#e?this.#e:(await import(this.workerSrc)).WorkerMessageHandler;return(0,C.shadow)(this,"_setupFakeWorkerGlobal",t())}}class gt{#t=new Map;#e=new Map;#s=new Map;#i=null;constructor(t,i,a,h,f){this.messageHandler=t,this.loadingTask=i,this.commonObjs=new dt,this.fontLoader=new P.FontLoader({ownerDocument:h.ownerDocument,styleElement:h.styleElement}),this._params=h,this.canvasFactory=f.canvasFactory,this.filterFactory=f.filterFactory,this.cMapReaderFactory=f.cMapReaderFactory,this.standardFontDataFactory=f.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=a,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=new C.PromiseCapability,this.setupMessageHandler()}#n(t,i=null){const a=this.#t.get(t);if(a)return a;const h=this.messageHandler.sendWithPromise(t,i);return this.#t.set(t,h),h}get annotationStorage(){return(0,C.shadow)(this,"annotationStorage",new D.AnnotationStorage)}getRenderingIntent(t,i=C.AnnotationMode.ENABLE,a=null,h=!1){let f=C.RenderingIntentFlag.DISPLAY,w=D.SerializableEmpty;switch(t){case"any":f=C.RenderingIntentFlag.ANY;break;case"display":break;case"print":f=C.RenderingIntentFlag.PRINT;break;default:(0,C.warn)(`getRenderingIntent - invalid intent: ${t}`)}switch(i){case C.AnnotationMode.DISABLE:f+=C.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case C.AnnotationMode.ENABLE:break;case C.AnnotationMode.ENABLE_FORMS:f+=C.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case C.AnnotationMode.ENABLE_STORAGE:f+=C.RenderingIntentFlag.ANNOTATIONS_STORAGE,w=(f&C.RenderingIntentFlag.PRINT&&a instanceof D.PrintAnnotationStorage?a:this.annotationStorage).serializable;break;default:(0,C.warn)(`getRenderingIntent - invalid annotationMode: ${i}`)}return h&&(f+=C.RenderingIntentFlag.OPLIST),{renderingIntent:f,cacheKey:`${f}_${w.hash}`,annotationStorageSerializable:w}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=new C.PromiseCapability,this.#i?.reject(new Error("Worker was destroyed during onPassword callback"));const t=[];for(const a of this.#e.values())t.push(a._destroy());this.#e.clear(),this.#s.clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const i=this.messageHandler.sendWithPromise("Terminate",null);return t.push(i),Promise.all(t).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),this.#t.clear(),this.filterFactory.destroy(),this._networkStream?.cancelAllRequests(new C.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:t,loadingTask:i}=this;t.on("GetReader",(a,h)=>{(0,C.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=f=>{this._lastProgress={loaded:f.loaded,total:f.total}},h.onPull=()=>{this._fullReader.read().then(function({value:f,done:w}){if(w){h.close();return}(0,C.assert)(f instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),h.enqueue(new Uint8Array(f),1,[f])}).catch(f=>{h.error(f)})},h.onCancel=f=>{this._fullReader.cancel(f),h.ready.catch(w=>{if(!this.destroyed)throw w})}}),t.on("ReaderHeadersReady",a=>{const h=new C.PromiseCapability,f=this._fullReader;return f.headersReady.then(()=>{(!f.isStreamingSupported||!f.isRangeSupported)&&(this._lastProgress&&i.onProgress?.(this._lastProgress),f.onProgress=w=>{i.onProgress?.({loaded:w.loaded,total:w.total})}),h.resolve({isStreamingSupported:f.isStreamingSupported,isRangeSupported:f.isRangeSupported,contentLength:f.contentLength})},h.reject),h.promise}),t.on("GetRangeReader",(a,h)=>{(0,C.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const f=this._networkStream.getRangeReader(a.begin,a.end);if(!f){h.close();return}h.onPull=()=>{f.read().then(function({value:w,done:x}){if(x){h.close();return}(0,C.assert)(w instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),h.enqueue(new Uint8Array(w),1,[w])}).catch(w=>{h.error(w)})},h.onCancel=w=>{f.cancel(w),h.ready.catch(x=>{if(!this.destroyed)throw x})}}),t.on("GetDoc",({pdfInfo:a})=>{this._numPages=a.numPages,this._htmlForXfa=a.htmlForXfa,delete a.htmlForXfa,i._capability.resolve(new Q(a,this))}),t.on("DocException",function(a){let h;switch(a.name){case"PasswordException":h=new C.PasswordException(a.message,a.code);break;case"InvalidPDFException":h=new C.InvalidPDFException(a.message);break;case"MissingPDFException":h=new C.MissingPDFException(a.message);break;case"UnexpectedResponseException":h=new C.UnexpectedResponseException(a.message,a.status);break;case"UnknownErrorException":h=new C.UnknownErrorException(a.message,a.details);break;default:(0,C.unreachable)("DocException - expected a valid Error.")}i._capability.reject(h)}),t.on("PasswordRequest",a=>{if(this.#i=new C.PromiseCapability,i.onPassword){const h=f=>{f instanceof Error?this.#i.reject(f):this.#i.resolve({password:f})};try{i.onPassword(h,a.code)}catch(f){this.#i.reject(f)}}else this.#i.reject(new C.PasswordException(a.message,a.code));return this.#i.promise}),t.on("DataLoaded",a=>{i.onProgress?.({loaded:a.length,total:a.length}),this.downloadInfoCapability.resolve(a)}),t.on("StartRenderPage",a=>{if(this.destroyed)return;this.#e.get(a.pageIndex)._startRenderPage(a.transparency,a.cacheKey)}),t.on("commonobj",([a,h,f])=>{if(this.destroyed||this.commonObjs.has(a))return null;switch(h){case"Font":const w=this._params;if("error"in f){const I=f.error;(0,C.warn)(`Error during font loading: ${I}`),this.commonObjs.resolve(a,I);break}const x=w.pdfBug&&globalThis.FontInspector?.enabled?(I,H)=>globalThis.FontInspector.fontAdded(I,H):null,T=new P.FontFaceObject(f,{isEvalSupported:w.isEvalSupported,disableFontFace:w.disableFontFace,ignoreErrors:w.ignoreErrors,inspectFont:x});this.fontLoader.bind(T).catch(I=>t.sendWithPromise("FontFallback",{id:a})).finally(()=>{!w.fontExtraProperties&&T.data&&(T.data=null),this.commonObjs.resolve(a,T)});break;case"CopyLocalImage":const{imageRef:F}=f;(0,C.assert)(F,"The imageRef must be defined.");for(const I of this.#e.values())for(const[,H]of I.objs)if(H.ref===F)return H.dataLen?(this.commonObjs.resolve(a,structuredClone(H)),H.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(a,f);break;default:throw new Error(`Got unknown common object type ${h}`)}return null}),t.on("obj",([a,h,f,w])=>{if(this.destroyed)return;const x=this.#e.get(h);if(!x.objs.has(a)){if(x._intentStates.size===0){w?.bitmap?.close();return}switch(f){case"Image":x.objs.resolve(a,w),w?.dataLen>C.MAX_IMAGE_SIZE_TO_CACHE&&(x._maybeCleanupAfterRender=!0);break;case"Pattern":x.objs.resolve(a,w);break;default:throw new Error(`Got unknown object type ${f}`)}}}),t.on("DocProgress",a=>{this.destroyed||i.onProgress?.({loaded:a.loaded,total:a.total})}),t.on("FetchBuiltInCMap",a=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.cMapReaderFactory?this.cMapReaderFactory.fetch(a):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),t.on("FetchStandardFontData",a=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.standardFontDataFactory?this.standardFontDataFactory.fetch(a):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){this.annotationStorage.size<=0&&(0,C.warn)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:t,transfer:i}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:t,filename:this._fullReader?.filename??null},i).finally(()=>{this.annotationStorage.resetModified()})}getPage(t){if(!Number.isInteger(t)||t<=0||t>this._numPages)return Promise.reject(new Error("Invalid page request."));const i=t-1,a=this.#s.get(i);if(a)return a;const h=this.messageHandler.sendWithPromise("GetPage",{pageIndex:i}).then(f=>{if(this.destroyed)throw new Error("Transport destroyed");const w=new K(i,f,this,this._params.pdfBug);return this.#e.set(i,w),w});return this.#s.set(i,h),h}getPageIndex(t){return typeof t!="object"||t===null||!Number.isInteger(t.num)||t.num<0||!Number.isInteger(t.gen)||t.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:t.num,gen:t.gen})}getAnnotations(t,i){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:t,intent:i})}getFieldObjects(){return this.#n("GetFieldObjects")}hasJSActions(){return this.#n("HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(t){return typeof t!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:t})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return this.#n("GetDocJSActions")}getPageJSActions(t){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:t})}getStructTree(t){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:t})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(t=>new r.OptionalContentConfig(t))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const t="GetMetadata",i=this.#t.get(t);if(i)return i;const a=this.messageHandler.sendWithPromise(t,null).then(h=>({info:h[0],metadata:h[1]?new g.Metadata(h[1]):null,contentDispositionFilename:this._fullReader?.filename??null,contentLength:this._fullReader?.contentLength??null}));return this.#t.set(t,a),a}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(t=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const i of this.#e.values())if(!i.cleanup())throw new Error(`startCleanup: Page ${i.pageNumber} is currently rendering.`);this.commonObjs.clear(),t||this.fontLoader.clear(),this.#t.clear(),this.filterFactory.destroy(!0)}}get loadingParams(){const{disableAutoFetch:t,enableXfa:i}=this._params;return(0,C.shadow)(this,"loadingParams",{disableAutoFetch:t,enableXfa:i})}}class dt{#t=Object.create(null);#e(t){return this.#t[t]||={capability:new C.PromiseCapability,data:null}}get(t,i=null){if(i){const h=this.#e(t);return h.capability.promise.then(()=>i(h.data)),null}const a=this.#t[t];if(!a?.capability.settled)throw new Error(`Requesting object that isn't resolved yet ${t}.`);return a.data}has(t){return this.#t[t]?.capability.settled??!1}resolve(t,i=null){const a=this.#e(t);a.data=i,a.capability.resolve()}clear(){for(const t in this.#t){const{data:i}=this.#t[t];i?.bitmap?.close()}this.#t=Object.create(null)}*[Symbol.iterator](){for(const t in this.#t){const{capability:i,data:a}=this.#t[t];i.settled&&(yield[t,a])}}}class ct{#t=null;constructor(t){this.#t=t,this.onContinue=null}get promise(){return this.#t.capability.promise}cancel(t=0){this.#t.cancel(null,t)}get separateAnnots(){const{separateAnnots:t}=this.#t.operatorList;if(!t)return!1;const{annotationCanvasMap:i}=this.#t;return t.form||t.canvas&&i?.size>0}}class J{static#t=new WeakSet;constructor({callback:t,params:i,objs:a,commonObjs:h,annotationCanvasMap:f,operatorList:w,pageIndex:x,canvasFactory:T,filterFactory:F,useRequestAnimationFrame:I=!1,pdfBug:H=!1,pageColors:N=null}){this.callback=t,this.params=i,this.objs=a,this.commonObjs=h,this.annotationCanvasMap=f,this.operatorListIdx=null,this.operatorList=w,this._pageIndex=x,this.canvasFactory=T,this.filterFactory=F,this._pdfBug=H,this.pageColors=N,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=I===!0&&typeof window<"u",this.cancelled=!1,this.capability=new C.PromiseCapability,this.task=new ct(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=i.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:t=!1,optionalContentConfig:i}){if(this.cancelled)return;if(this._canvas){if(J.#t.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");J.#t.add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:a,viewport:h,transform:f,background:w}=this.params;this.gfx=new v.CanvasGraphics(a,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:i},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:f,viewport:h,transparency:t,background:w}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback?.()}cancel(t=null,i=0){this.running=!1,this.cancelled=!0,this.gfx?.endDrawing(),J.#t.delete(this._canvas),this.callback(t||new k.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,i))}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||=this._continueBound;return}this.stepper?.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),J.#t.delete(this._canvas),this.callback())))}}const d="4.0.379",o="9e14d04fd";z()}catch(R){z(R)}})},822:(ht,Z,U)=>{U.d(Z,{BaseCMapReaderFactory:()=>D,BaseCanvasFactory:()=>C,BaseFilterFactory:()=>z,BaseSVGFactory:()=>P,BaseStandardFontDataFactory:()=>k});var A=U(266);class z{constructor(){this.constructor===z&&(0,A.unreachable)("Cannot initialize BaseFilterFactory.")}addFilter(v){return"none"}addHCMFilter(v,l){return"none"}addHighlightHCMFilter(v,l,u,g){return"none"}destroy(v=!1){}}class C{constructor(){this.constructor===C&&(0,A.unreachable)("Cannot initialize BaseCanvasFactory.")}create(v,l){if(v<=0||l<=0)throw new Error("Invalid canvas size");const u=this._createCanvas(v,l);return{canvas:u,context:u.getContext("2d")}}reset(v,l,u){if(!v.canvas)throw new Error("Canvas is not specified");if(l<=0||u<=0)throw new Error("Invalid canvas size");v.canvas.width=l,v.canvas.height=u}destroy(v){if(!v.canvas)throw new Error("Canvas is not specified");v.canvas.width=0,v.canvas.height=0,v.canvas=null,v.context=null}_createCanvas(v,l){(0,A.unreachable)("Abstract method `_createCanvas` called.")}}class D{constructor({baseUrl:v=null,isCompressed:l=!0}){this.constructor===D&&(0,A.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=v,this.isCompressed=l}async fetch({name:v}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!v)throw new Error("CMap name must be specified.");const l=this.baseUrl+v+(this.isCompressed?".bcmap":""),u=this.isCompressed?A.CMapCompressionType.BINARY:A.CMapCompressionType.NONE;return this._fetchData(l,u).catch(g=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${l}`)})}_fetchData(v,l){(0,A.unreachable)("Abstract method `_fetchData` called.")}}class k{constructor({baseUrl:v=null}){this.constructor===k&&(0,A.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=v}async fetch({filename:v}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!v)throw new Error("Font filename must be specified.");const l=`${this.baseUrl}${v}`;return this._fetchData(l).catch(u=>{throw new Error(`Unable to load font data at: ${l}`)})}_fetchData(v){(0,A.unreachable)("Abstract method `_fetchData` called.")}}class P{constructor(){this.constructor===P&&(0,A.unreachable)("Cannot initialize BaseSVGFactory.")}create(v,l,u=!1){if(v<=0||l<=0)throw new Error("Invalid SVG dimensions");const g=this._createSVG("svg:svg");return g.setAttribute("version","1.1"),u||(g.setAttribute("width",`${v}px`),g.setAttribute("height",`${l}px`)),g.setAttribute("preserveAspectRatio","none"),g.setAttribute("viewBox",`0 0 ${v} ${l}`),g}createElement(v){if(typeof v!="string")throw new Error("Invalid SVG element type");return this._createSVG(v)}_createSVG(v){(0,A.unreachable)("Abstract method `_createSVG` called.")}}},250:(ht,Z,U)=>{U.d(Z,{CanvasGraphics:()=>d});var A=U(266),z=U(473);const C={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function D(o,s){if(!s)return;const t=s[2]-s[0],i=s[3]-s[1],a=new Path2D;a.rect(s[0],s[1],t,i),o.clip(a)}class k{constructor(){this.constructor===k&&(0,A.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,A.unreachable)("Abstract method `getPattern` called.")}}class P extends k{constructor(s){super(),this._type=s[1],this._bbox=s[2],this._colorStops=s[3],this._p0=s[4],this._p1=s[5],this._r0=s[6],this._r1=s[7],this.matrix=null}_createGradient(s){let t;this._type==="axial"?t=s.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(t=s.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const i of this._colorStops)t.addColorStop(i[0],i[1]);return t}getPattern(s,t,i,a){let h;if(a===C.STROKE||a===C.FILL){const f=t.current.getClippedPathBoundingBox(a,(0,z.getCurrentTransform)(s))||[0,0,0,0],w=Math.ceil(f[2]-f[0])||1,x=Math.ceil(f[3]-f[1])||1,T=t.cachedCanvases.getCanvas("pattern",w,x,!0),F=T.context;F.clearRect(0,0,F.canvas.width,F.canvas.height),F.beginPath(),F.rect(0,0,F.canvas.width,F.canvas.height),F.translate(-f[0],-f[1]),i=A.Util.transform(i,[1,0,0,1,f[0],f[1]]),F.transform(...t.baseTransform),this.matrix&&F.transform(...this.matrix),D(F,this._bbox),F.fillStyle=this._createGradient(F),F.fill(),h=s.createPattern(T.canvas,"no-repeat");const I=new DOMMatrix(i);h.setTransform(I)}else D(s,this._bbox),h=this._createGradient(s);return h}}function y(o,s,t,i,a,h,f,w){const x=s.coords,T=s.colors,F=o.data,I=o.width*4;let H;x[t+1]>x[i+1]&&(H=t,t=i,i=H,H=h,h=f,f=H),x[i+1]>x[a+1]&&(H=i,i=a,a=H,H=f,f=w,w=H),x[t+1]>x[i+1]&&(H=t,t=i,i=H,H=h,h=f,f=H);const N=(x[t]+s.offsetX)*s.scaleX,S=(x[t+1]+s.offsetY)*s.scaleY,L=(x[i]+s.offsetX)*s.scaleX,$=(x[i+1]+s.offsetY)*s.scaleY,X=(x[a]+s.offsetX)*s.scaleX,W=(x[a+1]+s.offsetY)*s.scaleY;if(S>=W)return;const et=T[h],st=T[h+1],nt=T[h+2],it=T[f],lt=T[f+1],mt=T[f+2],bt=T[w],At=T[w+1],pt=T[w+2],Et=Math.round(S),St=Math.round(W);let Tt,vt,wt,yt,Rt,kt,Ot,Ht;for(let Ft=Et;Ft<=St;Ft++){if(Ft<$){const xt=Ft<S?0:(S-Ft)/(S-$);Tt=N-(N-L)*xt,vt=et-(et-it)*xt,wt=st-(st-lt)*xt,yt=nt-(nt-mt)*xt}else{let xt;Ft>W?xt=1:$===W?xt=0:xt=($-Ft)/($-W),Tt=L-(L-X)*xt,vt=it-(it-bt)*xt,wt=lt-(lt-At)*xt,yt=mt-(mt-pt)*xt}let Ct;Ft<S?Ct=0:Ft>W?Ct=1:Ct=(S-Ft)/(S-W),Rt=N-(N-X)*Ct,kt=et-(et-bt)*Ct,Ot=st-(st-At)*Ct,Ht=nt-(nt-pt)*Ct;const Bt=Math.round(Math.min(Tt,Rt)),Pt=Math.round(Math.max(Tt,Rt));let It=I*Ft+Bt*4;for(let xt=Bt;xt<=Pt;xt++)Ct=(Tt-xt)/(Tt-Rt),Ct<0?Ct=0:Ct>1&&(Ct=1),F[It++]=vt-(vt-kt)*Ct|0,F[It++]=wt-(wt-Ot)*Ct|0,F[It++]=yt-(yt-Ht)*Ct|0,F[It++]=255}}function v(o,s,t){const i=s.coords,a=s.colors;let h,f;switch(s.type){case"lattice":const w=s.verticesPerRow,x=Math.floor(i.length/w)-1,T=w-1;for(h=0;h<x;h++){let F=h*w;for(let I=0;I<T;I++,F++)y(o,t,i[F],i[F+1],i[F+w],a[F],a[F+1],a[F+w]),y(o,t,i[F+w+1],i[F+1],i[F+w],a[F+w+1],a[F+1],a[F+w])}break;case"triangles":for(h=0,f=i.length;h<f;h+=3)y(o,t,i[h],i[h+1],i[h+2],a[h],a[h+1],a[h+2]);break;default:throw new Error("illegal figure")}}class l extends k{constructor(s){super(),this._coords=s[2],this._colors=s[3],this._figures=s[4],this._bounds=s[5],this._bbox=s[7],this._background=s[8],this.matrix=null}_createMeshCanvas(s,t,i){const w=Math.floor(this._bounds[0]),x=Math.floor(this._bounds[1]),T=Math.ceil(this._bounds[2])-w,F=Math.ceil(this._bounds[3])-x,I=Math.min(Math.ceil(Math.abs(T*s[0]*1.1)),3e3),H=Math.min(Math.ceil(Math.abs(F*s[1]*1.1)),3e3),N=T/I,S=F/H,L={coords:this._coords,colors:this._colors,offsetX:-w,offsetY:-x,scaleX:1/N,scaleY:1/S},$=I+2*2,X=H+2*2,W=i.getCanvas("mesh",$,X,!1),et=W.context,st=et.createImageData(I,H);if(t){const it=st.data;for(let lt=0,mt=it.length;lt<mt;lt+=4)it[lt]=t[0],it[lt+1]=t[1],it[lt+2]=t[2],it[lt+3]=255}for(const it of this._figures)v(st,it,L);return et.putImageData(st,2,2),{canvas:W.canvas,offsetX:w-2*N,offsetY:x-2*S,scaleX:N,scaleY:S}}getPattern(s,t,i,a){D(s,this._bbox);let h;if(a===C.SHADING)h=A.Util.singularValueDecompose2dScale((0,z.getCurrentTransform)(s));else if(h=A.Util.singularValueDecompose2dScale(t.baseTransform),this.matrix){const w=A.Util.singularValueDecompose2dScale(this.matrix);h=[h[0]*w[0],h[1]*w[1]]}const f=this._createMeshCanvas(h,a===C.SHADING?null:this._background,t.cachedCanvases);return a!==C.SHADING&&(s.setTransform(...t.baseTransform),this.matrix&&s.transform(...this.matrix)),s.translate(f.offsetX,f.offsetY),s.scale(f.scaleX,f.scaleY),s.createPattern(f.canvas,"no-repeat")}}class u extends k{getPattern(){return"hotpink"}}function g(o){switch(o[0]){case"RadialAxial":return new P(o);case"Mesh":return new l(o);case"Dummy":return new u}throw new Error(`Unknown IR type: ${o[0]}`)}const r={COLORED:1,UNCOLORED:2};class p{static MAX_PATTERN_SIZE=3e3;constructor(s,t,i,a,h){this.operatorList=s[2],this.matrix=s[3]||[1,0,0,1,0,0],this.bbox=s[4],this.xstep=s[5],this.ystep=s[6],this.paintType=s[7],this.tilingType=s[8],this.color=t,this.ctx=i,this.canvasGraphicsFactory=a,this.baseTransform=h}createPatternCanvas(s){const t=this.operatorList,i=this.bbox,a=this.xstep,h=this.ystep,f=this.paintType,w=this.tilingType,x=this.color,T=this.canvasGraphicsFactory;(0,A.info)("TilingType: "+w);const F=i[0],I=i[1],H=i[2],N=i[3],S=A.Util.singularValueDecompose2dScale(this.matrix),L=A.Util.singularValueDecompose2dScale(this.baseTransform),$=[S[0]*L[0],S[1]*L[1]],X=this.getSizeAndScale(a,this.ctx.canvas.width,$[0]),W=this.getSizeAndScale(h,this.ctx.canvas.height,$[1]),et=s.cachedCanvases.getCanvas("pattern",X.size,W.size,!0),st=et.context,nt=T.createCanvasGraphics(st);nt.groupLevel=s.groupLevel,this.setFillAndStrokeStyleToContext(nt,f,x);let it=F,lt=I,mt=H,bt=N;return F<0&&(it=0,mt+=Math.abs(F)),I<0&&(lt=0,bt+=Math.abs(I)),st.translate(-(X.scale*it),-(W.scale*lt)),nt.transform(X.scale,0,0,W.scale,0,0),st.save(),this.clipBbox(nt,it,lt,mt,bt),nt.baseTransform=(0,z.getCurrentTransform)(nt.ctx),nt.executeOperatorList(t),nt.endDrawing(),{canvas:et.canvas,scaleX:X.scale,scaleY:W.scale,offsetX:it,offsetY:lt}}getSizeAndScale(s,t,i){s=Math.abs(s);const a=Math.max(p.MAX_PATTERN_SIZE,t);let h=Math.ceil(s*i);return h>=a?h=a:i=h/s,{scale:i,size:h}}clipBbox(s,t,i,a,h){const f=a-t,w=h-i;s.ctx.rect(t,i,f,w),s.current.updateRectMinMax((0,z.getCurrentTransform)(s.ctx),[t,i,a,h]),s.clip(),s.endPath()}setFillAndStrokeStyleToContext(s,t,i){const a=s.ctx,h=s.current;switch(t){case r.COLORED:const f=this.ctx;a.fillStyle=f.fillStyle,a.strokeStyle=f.strokeStyle,h.fillColor=f.fillStyle,h.strokeColor=f.strokeStyle;break;case r.UNCOLORED:const w=A.Util.makeHexColor(i[0],i[1],i[2]);a.fillStyle=w,a.strokeStyle=w,h.fillColor=w,h.strokeColor=w;break;default:throw new A.FormatError(`Unsupported paint type: ${t}`)}}getPattern(s,t,i,a){let h=i;a!==C.SHADING&&(h=A.Util.transform(h,t.baseTransform),this.matrix&&(h=A.Util.transform(h,this.matrix)));const f=this.createPatternCanvas(t);let w=new DOMMatrix(h);w=w.translate(f.offsetX,f.offsetY),w=w.scale(1/f.scaleX,1/f.scaleY);const x=s.createPattern(f.canvas,"repeat");return x.setTransform(w),x}}function e({src:o,srcPos:s=0,dest:t,width:i,height:a,nonBlackColor:h=4294967295,inverseDecode:f=!1}){const w=A.FeatureTest.isLittleEndian?4278190080:255,[x,T]=f?[h,w]:[w,h],F=i>>3,I=i&7,H=o.length;t=new Uint32Array(t.buffer);let N=0;for(let S=0;S<a;S++){for(const $=s+F;s<$;s++){const X=s<H?o[s]:255;t[N++]=X&128?T:x,t[N++]=X&64?T:x,t[N++]=X&32?T:x,t[N++]=X&16?T:x,t[N++]=X&8?T:x,t[N++]=X&4?T:x,t[N++]=X&2?T:x,t[N++]=X&1?T:x}if(I===0)continue;const L=s<H?o[s++]:255;for(let $=0;$<I;$++)t[N++]=L&1<<7-$?T:x}return{srcPos:s,destPos:N}}const n=16,c=100,b=4096,m=15,R=10,E=1e3,M=16;function V(o,s){if(o._removeMirroring)throw new Error("Context is already forwarding operations.");o.__originalSave=o.save,o.__originalRestore=o.restore,o.__originalRotate=o.rotate,o.__originalScale=o.scale,o.__originalTranslate=o.translate,o.__originalTransform=o.transform,o.__originalSetTransform=o.setTransform,o.__originalResetTransform=o.resetTransform,o.__originalClip=o.clip,o.__originalMoveTo=o.moveTo,o.__originalLineTo=o.lineTo,o.__originalBezierCurveTo=o.bezierCurveTo,o.__originalRect=o.rect,o.__originalClosePath=o.closePath,o.__originalBeginPath=o.beginPath,o._removeMirroring=()=>{o.save=o.__originalSave,o.restore=o.__originalRestore,o.rotate=o.__originalRotate,o.scale=o.__originalScale,o.translate=o.__originalTranslate,o.transform=o.__originalTransform,o.setTransform=o.__originalSetTransform,o.resetTransform=o.__originalResetTransform,o.clip=o.__originalClip,o.moveTo=o.__originalMoveTo,o.lineTo=o.__originalLineTo,o.bezierCurveTo=o.__originalBezierCurveTo,o.rect=o.__originalRect,o.closePath=o.__originalClosePath,o.beginPath=o.__originalBeginPath,delete o._removeMirroring},o.save=function(){s.save(),this.__originalSave()},o.restore=function(){s.restore(),this.__originalRestore()},o.translate=function(i,a){s.translate(i,a),this.__originalTranslate(i,a)},o.scale=function(i,a){s.scale(i,a),this.__originalScale(i,a)},o.transform=function(i,a,h,f,w,x){s.transform(i,a,h,f,w,x),this.__originalTransform(i,a,h,f,w,x)},o.setTransform=function(i,a,h,f,w,x){s.setTransform(i,a,h,f,w,x),this.__originalSetTransform(i,a,h,f,w,x)},o.resetTransform=function(){s.resetTransform(),this.__originalResetTransform()},o.rotate=function(i){s.rotate(i),this.__originalRotate(i)},o.clip=function(i){s.clip(i),this.__originalClip(i)},o.moveTo=function(t,i){s.moveTo(t,i),this.__originalMoveTo(t,i)},o.lineTo=function(t,i){s.lineTo(t,i),this.__originalLineTo(t,i)},o.bezierCurveTo=function(t,i,a,h,f,w){s.bezierCurveTo(t,i,a,h,f,w),this.__originalBezierCurveTo(t,i,a,h,f,w)},o.rect=function(t,i,a,h){s.rect(t,i,a,h),this.__originalRect(t,i,a,h)},o.closePath=function(){s.closePath(),this.__originalClosePath()},o.beginPath=function(){s.beginPath(),this.__originalBeginPath()}}class G{constructor(s){this.canvasFactory=s,this.cache=Object.create(null)}getCanvas(s,t,i){let a;return this.cache[s]!==void 0?(a=this.cache[s],this.canvasFactory.reset(a,t,i)):(a=this.canvasFactory.create(t,i),this.cache[s]=a),a}delete(s){delete this.cache[s]}clear(){for(const s in this.cache){const t=this.cache[s];this.canvasFactory.destroy(t),delete this.cache[s]}}}function _(o,s,t,i,a,h,f,w,x,T){const[F,I,H,N,S,L]=(0,z.getCurrentTransform)(o);if(I===0&&H===0){const W=f*F+S,et=Math.round(W),st=w*N+L,nt=Math.round(st),it=(f+x)*F+S,lt=Math.abs(Math.round(it)-et)||1,mt=(w+T)*N+L,bt=Math.abs(Math.round(mt)-nt)||1;return o.setTransform(Math.sign(F),0,0,Math.sign(N),et,nt),o.drawImage(s,t,i,a,h,0,0,lt,bt),o.setTransform(F,I,H,N,S,L),[lt,bt]}if(F===0&&N===0){const W=w*H+S,et=Math.round(W),st=f*I+L,nt=Math.round(st),it=(w+T)*H+S,lt=Math.abs(Math.round(it)-et)||1,mt=(f+x)*I+L,bt=Math.abs(Math.round(mt)-nt)||1;return o.setTransform(0,Math.sign(I),Math.sign(H),0,et,nt),o.drawImage(s,t,i,a,h,0,0,bt,lt),o.setTransform(F,I,H,N,S,L),[bt,lt]}o.drawImage(s,t,i,a,h,f,w,x,T);const $=Math.hypot(F,I),X=Math.hypot(H,N);return[$*x,X*T]}function Y(o){const{width:s,height:t}=o;if(s>E||t>E)return null;const i=1e3,a=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),h=s+1;let f=new Uint8Array(h*(t+1)),w,x,T;const F=s+7&-8;let I=new Uint8Array(F*t),H=0;for(const X of o.data){let W=128;for(;W>0;)I[H++]=X&W?0:255,W>>=1}let N=0;for(H=0,I[H]!==0&&(f[0]=1,++N),x=1;x<s;x++)I[H]!==I[H+1]&&(f[x]=I[H]?2:1,++N),H++;for(I[H]!==0&&(f[x]=2,++N),w=1;w<t;w++){H=w*F,T=w*h,I[H-F]!==I[H]&&(f[T]=I[H]?1:8,++N);let X=(I[H]?4:0)+(I[H-F]?8:0);for(x=1;x<s;x++)X=(X>>2)+(I[H+1]?4:0)+(I[H-F+1]?8:0),a[X]&&(f[T+x]=a[X],++N),H++;if(I[H-F]!==I[H]&&(f[T+x]=I[H]?2:4,++N),N>i)return null}for(H=F*(t-1),T=w*h,I[H]!==0&&(f[T]=8,++N),x=1;x<s;x++)I[H]!==I[H+1]&&(f[T+x]=I[H]?4:8,++N),H++;if(I[H]!==0&&(f[T+x]=4,++N),N>i)return null;const S=new Int32Array([0,h,-1,0,-h,0,0,0,1]),L=new Path2D;for(w=0;N&&w<=t;w++){let X=w*h;const W=X+s;for(;X<W&&!f[X];)X++;if(X===W)continue;L.moveTo(X%h,w);const et=X;let st=f[X];do{const nt=S[st];do X+=nt;while(!f[X]);const it=f[X];it!==5&&it!==10?(st=it,f[X]=0):(st=it&51*st>>4,f[X]&=st>>2|st<<2),L.lineTo(X%h,X/h|0),f[X]||--N}while(et!==X);--w}return I=null,f=null,function(X){X.save(),X.scale(1/s,-1/t),X.translate(0,-t),X.fill(L),X.beginPath(),X.restore()}}class tt{constructor(s,t){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=A.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=A.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=A.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,s,t])}clone(){const s=Object.create(this);return s.clipBox=this.clipBox.slice(),s}setCurrentPoint(s,t){this.x=s,this.y=t}updatePathMinMax(s,t,i){[t,i]=A.Util.applyTransform([t,i],s),this.minX=Math.min(this.minX,t),this.minY=Math.min(this.minY,i),this.maxX=Math.max(this.maxX,t),this.maxY=Math.max(this.maxY,i)}updateRectMinMax(s,t){const i=A.Util.applyTransform(t,s),a=A.Util.applyTransform(t.slice(2),s),h=A.Util.applyTransform([t[0],t[3]],s),f=A.Util.applyTransform([t[2],t[1]],s);this.minX=Math.min(this.minX,i[0],a[0],h[0],f[0]),this.minY=Math.min(this.minY,i[1],a[1],h[1],f[1]),this.maxX=Math.max(this.maxX,i[0],a[0],h[0],f[0]),this.maxY=Math.max(this.maxY,i[1],a[1],h[1],f[1])}updateScalingPathMinMax(s,t){A.Util.scaleMinMax(s,t),this.minX=Math.min(this.minX,t[0]),this.maxX=Math.max(this.maxX,t[1]),this.minY=Math.min(this.minY,t[2]),this.maxY=Math.max(this.maxY,t[3])}updateCurvePathMinMax(s,t,i,a,h,f,w,x,T,F){const I=A.Util.bezierBoundingBox(t,i,a,h,f,w,x,T);if(F){F[0]=Math.min(F[0],I[0],I[2]),F[1]=Math.max(F[1],I[0],I[2]),F[2]=Math.min(F[2],I[1],I[3]),F[3]=Math.max(F[3],I[1],I[3]);return}this.updateRectMinMax(s,I)}getPathBoundingBox(s=C.FILL,t=null){const i=[this.minX,this.minY,this.maxX,this.maxY];if(s===C.STROKE){t||(0,A.unreachable)("Stroke bounding box must include transform.");const a=A.Util.singularValueDecompose2dScale(t),h=a[0]*this.lineWidth/2,f=a[1]*this.lineWidth/2;i[0]-=h,i[1]-=f,i[2]+=h,i[3]+=f}return i}updateClipFromPath(){const s=A.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(s||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(s){this.clipBox=s,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(s=C.FILL,t=null){return A.Util.intersect(this.clipBox,this.getPathBoundingBox(s,t))}}function rt(o,s){if(typeof ImageData<"u"&&s instanceof ImageData){o.putImageData(s,0,0);return}const t=s.height,i=s.width,a=t%M,h=(t-a)/M,f=a===0?h:h+1,w=o.createImageData(i,M);let x=0,T;const F=s.data,I=w.data;let H,N,S,L;if(s.kind===A.ImageKind.GRAYSCALE_1BPP){const $=F.byteLength,X=new Uint32Array(I.buffer,0,I.byteLength>>2),W=X.length,et=i+7>>3,st=4294967295,nt=A.FeatureTest.isLittleEndian?4278190080:255;for(H=0;H<f;H++){for(S=H<h?M:a,T=0,N=0;N<S;N++){const it=$-x;let lt=0;const mt=it>et?i:it*8-7,bt=mt&-8;let At=0,pt=0;for(;lt<bt;lt+=8)pt=F[x++],X[T++]=pt&128?st:nt,X[T++]=pt&64?st:nt,X[T++]=pt&32?st:nt,X[T++]=pt&16?st:nt,X[T++]=pt&8?st:nt,X[T++]=pt&4?st:nt,X[T++]=pt&2?st:nt,X[T++]=pt&1?st:nt;for(;lt<mt;lt++)At===0&&(pt=F[x++],At=128),X[T++]=pt&At?st:nt,At>>=1}for(;T<W;)X[T++]=0;o.putImageData(w,0,H*M)}}else if(s.kind===A.ImageKind.RGBA_32BPP){for(N=0,L=i*M*4,H=0;H<h;H++)I.set(F.subarray(x,x+L)),x+=L,o.putImageData(w,0,N),N+=M;H<f&&(L=i*a*4,I.set(F.subarray(x,x+L)),o.putImageData(w,0,N))}else if(s.kind===A.ImageKind.RGB_24BPP)for(S=M,L=i*S,H=0;H<f;H++){for(H>=h&&(S=a,L=i*S),T=0,N=L;N--;)I[T++]=F[x++],I[T++]=F[x++],I[T++]=F[x++],I[T++]=255;o.putImageData(w,0,H*M)}else throw new Error(`bad image kind: ${s.kind}`)}function j(o,s){if(s.bitmap){o.drawImage(s.bitmap,0,0);return}const t=s.height,i=s.width,a=t%M,h=(t-a)/M,f=a===0?h:h+1,w=o.createImageData(i,M);let x=0;const T=s.data,F=w.data;for(let I=0;I<f;I++){const H=I<h?M:a;({srcPos:x}=e({src:T,srcPos:x,dest:F,width:i,height:H,nonBlackColor:0})),o.putImageData(w,0,I*M)}}function O(o,s){const t=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const i of t)o[i]!==void 0&&(s[i]=o[i]);o.setLineDash!==void 0&&(s.setLineDash(o.getLineDash()),s.lineDashOffset=o.lineDashOffset)}function B(o){if(o.strokeStyle=o.fillStyle="#000000",o.fillRule="nonzero",o.globalAlpha=1,o.lineWidth=1,o.lineCap="butt",o.lineJoin="miter",o.miterLimit=10,o.globalCompositeOperation="source-over",o.font="10px sans-serif",o.setLineDash!==void 0&&(o.setLineDash([]),o.lineDashOffset=0),!A.isNodeJS){const{filter:s}=o;s!=="none"&&s!==""&&(o.filter="none")}}function q(o,s,t,i){const a=o.length;for(let h=3;h<a;h+=4){const f=o[h];if(f===0)o[h-3]=s,o[h-2]=t,o[h-1]=i;else if(f<255){const w=255-f;o[h-3]=o[h-3]*f+s*w>>8,o[h-2]=o[h-2]*f+t*w>>8,o[h-1]=o[h-1]*f+i*w>>8}}}function Q(o,s,t){const i=o.length,a=1/255;for(let h=3;h<i;h+=4){const f=t?t[o[h]]:o[h];s[h]=s[h]*f*a|0}}function K(o,s,t){const i=o.length;for(let a=3;a<i;a+=4){const h=o[a-3]*77+o[a-2]*152+o[a-1]*28;s[a]=t?s[a]*t[h>>8]>>8:s[a]*h>>16}}function ft(o,s,t,i,a,h,f,w,x,T,F){const I=!!h,H=I?h[0]:0,N=I?h[1]:0,S=I?h[2]:0,L=a==="Luminosity"?K:Q,X=Math.min(i,Math.ceil(1048576/t));for(let W=0;W<i;W+=X){const et=Math.min(X,i-W),st=o.getImageData(w-T,W+(x-F),t,et),nt=s.getImageData(w,W+x,t,et);I&&q(st.data,H,N,S),L(st.data,nt.data,f),s.putImageData(nt,w,W+x)}}function ot(o,s,t,i){const a=i[0],h=i[1],f=i[2]-a,w=i[3]-h;f===0||w===0||(ft(s.context,t,f,w,s.subtype,s.backdrop,s.transferMap,a,h,s.offsetX,s.offsetY),o.save(),o.globalAlpha=1,o.globalCompositeOperation="source-over",o.setTransform(1,0,0,1,0,0),o.drawImage(t.canvas,0,0),o.restore())}function at(o,s){const t=A.Util.singularValueDecompose2dScale(o);t[0]=Math.fround(t[0]),t[1]=Math.fround(t[1]);const i=Math.fround((globalThis.devicePixelRatio||1)*z.PixelsPerInch.PDF_TO_CSS_UNITS);return s!==void 0?s:t[0]<=i||t[1]<=i}const gt=["butt","round","square"],dt=["miter","round","bevel"],ct={},J={};class d{constructor(s,t,i,a,h,{optionalContentConfig:f,markedContentStack:w=null},x,T){this.ctx=s,this.current=new tt(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=t,this.objs=i,this.canvasFactory=a,this.filterFactory=h,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=w||[],this.optionalContentConfig=f,this.cachedCanvases=new G(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=x,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=T,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(s,t=null){return typeof s=="string"?s.startsWith("g_")?this.commonObjs.get(s):this.objs.get(s):t}beginDrawing({transform:s,viewport:t,transparency:i=!1,background:a=null}){const h=this.ctx.canvas.width,f=this.ctx.canvas.height,w=this.ctx.fillStyle;if(this.ctx.fillStyle=a||"#ffffff",this.ctx.fillRect(0,0,h,f),this.ctx.fillStyle=w,i){const x=this.cachedCanvases.getCanvas("transparent",h,f);this.compositeCtx=this.ctx,this.transparentCanvas=x.canvas,this.ctx=x.context,this.ctx.save(),this.ctx.transform(...(0,z.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),B(this.ctx),s&&(this.ctx.transform(...s),this.outputScaleX=s[0],this.outputScaleY=s[0]),this.ctx.transform(...t.transform),this.viewportScale=t.scale,this.baseTransform=(0,z.getCurrentTransform)(this.ctx)}executeOperatorList(s,t,i,a){const h=s.argsArray,f=s.fnArray;let w=t||0;const x=h.length;if(x===w)return w;const T=x-w>R&&typeof i=="function",F=T?Date.now()+m:0;let I=0;const H=this.commonObjs,N=this.objs;let S;for(;;){if(a!==void 0&&w===a.nextBreakPoint)return a.breakIt(w,i),w;if(S=f[w],S!==A.OPS.dependency)this[S].apply(this,h[w]);else for(const L of h[w]){const $=L.startsWith("g_")?H:N;if(!$.has(L))return $.get(L,i),w}if(w++,w===x)return w;if(T&&++I>R){if(Date.now()>F)return i(),w;I=0}}}#t(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}endDrawing(){this.#t(),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const s of this._cachedBitmapsMap.values()){for(const t of s.values())typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement&&(t.width=t.height=0);s.clear()}this._cachedBitmapsMap.clear(),this.#e()}#e(){if(this.pageColors){const s=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(s!=="none"){const t=this.ctx.filter;this.ctx.filter=s,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=t}}}_scaleImage(s,t){const i=s.width,a=s.height;let h=Math.max(Math.hypot(t[0],t[1]),1),f=Math.max(Math.hypot(t[2],t[3]),1),w=i,x=a,T="prescale1",F,I;for(;h>2&&w>1||f>2&&x>1;){let H=w,N=x;h>2&&w>1&&(H=w>=16384?Math.floor(w/2)-1||1:Math.ceil(w/2),h/=w/H),f>2&&x>1&&(N=x>=16384?Math.floor(x/2)-1||1:Math.ceil(x)/2,f/=x/N),F=this.cachedCanvases.getCanvas(T,H,N),I=F.context,I.clearRect(0,0,H,N),I.drawImage(s,0,0,w,x,0,0,H,N),s=F.canvas,w=H,x=N,T=T==="prescale1"?"prescale2":"prescale1"}return{img:s,paintWidth:w,paintHeight:x}}_createMaskCanvas(s){const t=this.ctx,{width:i,height:a}=s,h=this.current.fillColor,f=this.current.patternFill,w=(0,z.getCurrentTransform)(t);let x,T,F,I;if((s.bitmap||s.data)&&s.count>1){const mt=s.bitmap||s.data.buffer;T=JSON.stringify(f?w:[w.slice(0,4),h]),x=this._cachedBitmapsMap.get(mt),x||(x=new Map,this._cachedBitmapsMap.set(mt,x));const bt=x.get(T);if(bt&&!f){const At=Math.round(Math.min(w[0],w[2])+w[4]),pt=Math.round(Math.min(w[1],w[3])+w[5]);return{canvas:bt,offsetX:At,offsetY:pt}}F=bt}F||(I=this.cachedCanvases.getCanvas("maskCanvas",i,a),j(I.context,s));let H=A.Util.transform(w,[1/i,0,0,-1/a,0,0]);H=A.Util.transform(H,[1,0,0,1,0,-a]);const[N,S,L,$]=A.Util.getAxialAlignedBoundingBox([0,0,i,a],H),X=Math.round(L-N)||1,W=Math.round($-S)||1,et=this.cachedCanvases.getCanvas("fillCanvas",X,W),st=et.context,nt=N,it=S;st.translate(-nt,-it),st.transform(...H),F||(F=this._scaleImage(I.canvas,(0,z.getCurrentTransformInverse)(st)),F=F.img,x&&f&&x.set(T,F)),st.imageSmoothingEnabled=at((0,z.getCurrentTransform)(st),s.interpolate),_(st,F,0,0,F.width,F.height,0,0,i,a),st.globalCompositeOperation="source-in";const lt=A.Util.transform((0,z.getCurrentTransformInverse)(st),[1,0,0,1,-nt,-it]);return st.fillStyle=f?h.getPattern(t,this,lt,C.FILL):h,st.fillRect(0,0,i,a),x&&!f&&(this.cachedCanvases.delete("fillCanvas"),x.set(T,et.canvas)),{canvas:et.canvas,offsetX:Math.round(nt),offsetY:Math.round(it)}}setLineWidth(s){s!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=s,this.ctx.lineWidth=s}setLineCap(s){this.ctx.lineCap=gt[s]}setLineJoin(s){this.ctx.lineJoin=dt[s]}setMiterLimit(s){this.ctx.miterLimit=s}setDash(s,t){const i=this.ctx;i.setLineDash!==void 0&&(i.setLineDash(s),i.lineDashOffset=t)}setRenderingIntent(s){}setFlatness(s){}setGState(s){for(const[t,i]of s)switch(t){case"LW":this.setLineWidth(i);break;case"LC":this.setLineCap(i);break;case"LJ":this.setLineJoin(i);break;case"ML":this.setMiterLimit(i);break;case"D":this.setDash(i[0],i[1]);break;case"RI":this.setRenderingIntent(i);break;case"FL":this.setFlatness(i);break;case"Font":this.setFont(i[0],i[1]);break;case"CA":this.current.strokeAlpha=i;break;case"ca":this.current.fillAlpha=i,this.ctx.globalAlpha=i;break;case"BM":this.ctx.globalCompositeOperation=i;break;case"SMask":this.current.activeSMask=i?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(i);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const s=this.inSMaskMode;this.current.activeSMask&&!s?this.beginSMaskMode():!this.current.activeSMask&&s&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const s=this.ctx.canvas.width,t=this.ctx.canvas.height,i="smaskGroupAt"+this.groupLevel,a=this.cachedCanvases.getCanvas(i,s,t);this.suspendedCtx=this.ctx,this.ctx=a.context;const h=this.ctx;h.setTransform(...(0,z.getCurrentTransform)(this.suspendedCtx)),O(this.suspendedCtx,h),V(h,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),O(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(s){if(!this.current.activeSMask)return;s?(s[0]=Math.floor(s[0]),s[1]=Math.floor(s[1]),s[2]=Math.ceil(s[2]),s[3]=Math.ceil(s[3])):s=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const t=this.current.activeSMask,i=this.suspendedCtx;ot(i,t,this.ctx,s),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(O(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const s=this.current;this.stateStack.push(s),this.current=s.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),O(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(s,t,i,a,h,f){this.ctx.transform(s,t,i,a,h,f),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(s,t,i){const a=this.ctx,h=this.current;let f=h.x,w=h.y,x,T;const F=(0,z.getCurrentTransform)(a),I=F[0]===0&&F[3]===0||F[1]===0&&F[2]===0,H=I?i.slice(0):null;for(let N=0,S=0,L=s.length;N<L;N++)switch(s[N]|0){case A.OPS.rectangle:f=t[S++],w=t[S++];const $=t[S++],X=t[S++],W=f+$,et=w+X;a.moveTo(f,w),$===0||X===0?a.lineTo(W,et):(a.lineTo(W,w),a.lineTo(W,et),a.lineTo(f,et)),I||h.updateRectMinMax(F,[f,w,W,et]),a.closePath();break;case A.OPS.moveTo:f=t[S++],w=t[S++],a.moveTo(f,w),I||h.updatePathMinMax(F,f,w);break;case A.OPS.lineTo:f=t[S++],w=t[S++],a.lineTo(f,w),I||h.updatePathMinMax(F,f,w);break;case A.OPS.curveTo:x=f,T=w,f=t[S+4],w=t[S+5],a.bezierCurveTo(t[S],t[S+1],t[S+2],t[S+3],f,w),h.updateCurvePathMinMax(F,x,T,t[S],t[S+1],t[S+2],t[S+3],f,w,H),S+=6;break;case A.OPS.curveTo2:x=f,T=w,a.bezierCurveTo(f,w,t[S],t[S+1],t[S+2],t[S+3]),h.updateCurvePathMinMax(F,x,T,f,w,t[S],t[S+1],t[S+2],t[S+3],H),f=t[S+2],w=t[S+3],S+=4;break;case A.OPS.curveTo3:x=f,T=w,f=t[S+2],w=t[S+3],a.bezierCurveTo(t[S],t[S+1],f,w,f,w),h.updateCurvePathMinMax(F,x,T,t[S],t[S+1],f,w,f,w,H),S+=4;break;case A.OPS.closePath:a.closePath();break}I&&h.updateScalingPathMinMax(F,H),h.setCurrentPoint(f,w)}closePath(){this.ctx.closePath()}stroke(s=!0){const t=this.ctx,i=this.current.strokeColor;t.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof i=="object"&&i?.getPattern?(t.save(),t.strokeStyle=i.getPattern(t,this,(0,z.getCurrentTransformInverse)(t),C.STROKE),this.rescaleAndStroke(!1),t.restore()):this.rescaleAndStroke(!0)),s&&this.consumePath(this.current.getClippedPathBoundingBox()),t.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(s=!0){const t=this.ctx,i=this.current.fillColor,a=this.current.patternFill;let h=!1;a&&(t.save(),t.fillStyle=i.getPattern(t,this,(0,z.getCurrentTransformInverse)(t),C.FILL),h=!0);const f=this.current.getClippedPathBoundingBox();this.contentVisible&&f!==null&&(this.pendingEOFill?(t.fill("evenodd"),this.pendingEOFill=!1):t.fill()),h&&t.restore(),s&&this.consumePath(f)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=ct}eoClip(){this.pendingClip=J}beginText(){this.current.textMatrix=A.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const s=this.pendingTextPaths,t=this.ctx;if(s===void 0){t.beginPath();return}t.save(),t.beginPath();for(const i of s)t.setTransform(...i.transform),t.translate(i.x,i.y),i.addToPath(t,i.fontSize);t.restore(),t.clip(),t.beginPath(),delete this.pendingTextPaths}setCharSpacing(s){this.current.charSpacing=s}setWordSpacing(s){this.current.wordSpacing=s}setHScale(s){this.current.textHScale=s/100}setLeading(s){this.current.leading=-s}setFont(s,t){const i=this.commonObjs.get(s),a=this.current;if(!i)throw new Error(`Can't find font for ${s}`);if(a.fontMatrix=i.fontMatrix||A.FONT_IDENTITY_MATRIX,(a.fontMatrix[0]===0||a.fontMatrix[3]===0)&&(0,A.warn)("Invalid font matrix for font "+s),t<0?(t=-t,a.fontDirection=-1):a.fontDirection=1,this.current.font=i,this.current.fontSize=t,i.isType3Font)return;const h=i.loadedName||"sans-serif",f=i.systemFontInfo?.css||`"${h}", ${i.fallbackName}`;let w="normal";i.black?w="900":i.bold&&(w="bold");const x=i.italic?"italic":"normal";let T=t;t<n?T=n:t>c&&(T=c),this.current.fontSizeScale=t/T,this.ctx.font=`${x} ${w} ${T}px ${f}`}setTextRenderingMode(s){this.current.textRenderingMode=s}setTextRise(s){this.current.textRise=s}moveText(s,t){this.current.x=this.current.lineX+=s,this.current.y=this.current.lineY+=t}setLeadingMoveText(s,t){this.setLeading(-t),this.moveText(s,t)}setTextMatrix(s,t,i,a,h,f){this.current.textMatrix=[s,t,i,a,h,f],this.current.textMatrixScale=Math.hypot(s,t),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(s,t,i,a){const h=this.ctx,f=this.current,w=f.font,x=f.textRenderingMode,T=f.fontSize/f.fontSizeScale,F=x&A.TextRenderingMode.FILL_STROKE_MASK,I=!!(x&A.TextRenderingMode.ADD_TO_PATH_FLAG),H=f.patternFill&&!w.missingFile;let N;(w.disableFontFace||I||H)&&(N=w.getPathGenerator(this.commonObjs,s)),w.disableFontFace||H?(h.save(),h.translate(t,i),h.beginPath(),N(h,T),a&&h.setTransform(...a),(F===A.TextRenderingMode.FILL||F===A.TextRenderingMode.FILL_STROKE)&&h.fill(),(F===A.TextRenderingMode.STROKE||F===A.TextRenderingMode.FILL_STROKE)&&h.stroke(),h.restore()):((F===A.TextRenderingMode.FILL||F===A.TextRenderingMode.FILL_STROKE)&&h.fillText(s,t,i),(F===A.TextRenderingMode.STROKE||F===A.TextRenderingMode.FILL_STROKE)&&h.strokeText(s,t,i)),I&&(this.pendingTextPaths||=[]).push({transform:(0,z.getCurrentTransform)(h),x:t,y:i,fontSize:T,addToPath:N})}get isFontSubpixelAAEnabled(){const{context:s}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);s.scale(1.5,1),s.fillText("I",0,10);const t=s.getImageData(0,0,10,10).data;let i=!1;for(let a=3;a<t.length;a+=4)if(t[a]>0&&t[a]<255){i=!0;break}return(0,A.shadow)(this,"isFontSubpixelAAEnabled",i)}showText(s){const t=this.current,i=t.font;if(i.isType3Font)return this.showType3Text(s);const a=t.fontSize;if(a===0)return;const h=this.ctx,f=t.fontSizeScale,w=t.charSpacing,x=t.wordSpacing,T=t.fontDirection,F=t.textHScale*T,I=s.length,H=i.vertical,N=H?1:-1,S=i.defaultVMetrics,L=a*t.fontMatrix[0],$=t.textRenderingMode===A.TextRenderingMode.FILL&&!i.disableFontFace&&!t.patternFill;h.save(),h.transform(...t.textMatrix),h.translate(t.x,t.y+t.textRise),T>0?h.scale(F,-1):h.scale(F,1);let X;if(t.patternFill){h.save();const it=t.fillColor.getPattern(h,this,(0,z.getCurrentTransformInverse)(h),C.FILL);X=(0,z.getCurrentTransform)(h),h.restore(),h.fillStyle=it}let W=t.lineWidth;const et=t.textMatrixScale;if(et===0||W===0){const it=t.textRenderingMode&A.TextRenderingMode.FILL_STROKE_MASK;(it===A.TextRenderingMode.STROKE||it===A.TextRenderingMode.FILL_STROKE)&&(W=this.getSinglePixelWidth())}else W/=et;if(f!==1&&(h.scale(f,f),W/=f),h.lineWidth=W,i.isInvalidPDFjsFont){const it=[];let lt=0;for(const mt of s)it.push(mt.unicode),lt+=mt.width;h.fillText(it.join(""),0,0),t.x+=lt*L*F,h.restore(),this.compose();return}let st=0,nt;for(nt=0;nt<I;++nt){const it=s[nt];if(typeof it=="number"){st+=N*it*a/1e3;continue}let lt=!1;const mt=(it.isSpace?x:0)+w,bt=it.fontChar,At=it.accent;let pt,Et,St=it.width;if(H){const vt=it.vmetric||S,wt=-(it.vmetric?vt[1]:St*.5)*L,yt=vt[2]*L;St=vt?-vt[0]:St,pt=wt/f,Et=(st+yt)/f}else pt=st/f,Et=0;if(i.remeasure&&St>0){const vt=h.measureText(bt).width*1e3/a*f;if(St<vt&&this.isFontSubpixelAAEnabled){const wt=St/vt;lt=!0,h.save(),h.scale(wt,1),pt/=wt}else St!==vt&&(pt+=(St-vt)/2e3*a/f)}if(this.contentVisible&&(it.isInFont||i.missingFile)){if($&&!At)h.fillText(bt,pt,Et);else if(this.paintChar(bt,pt,Et,X),At){const vt=pt+a*At.offset.x/f,wt=Et-a*At.offset.y/f;this.paintChar(At.fontChar,vt,wt,X)}}const Tt=H?St*L-mt*T:St*L+mt*T;st+=Tt,lt&&h.restore()}H?t.y-=st:t.x+=st*F,h.restore(),this.compose()}showType3Text(s){const t=this.ctx,i=this.current,a=i.font,h=i.fontSize,f=i.fontDirection,w=a.vertical?1:-1,x=i.charSpacing,T=i.wordSpacing,F=i.textHScale*f,I=i.fontMatrix||A.FONT_IDENTITY_MATRIX,H=s.length,N=i.textRenderingMode===A.TextRenderingMode.INVISIBLE;let S,L,$,X;if(!(N||h===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,t.save(),t.transform(...i.textMatrix),t.translate(i.x,i.y),t.scale(F,f),S=0;S<H;++S){if(L=s[S],typeof L=="number"){X=w*L*h/1e3,this.ctx.translate(X,0),i.x+=X*F;continue}const W=(L.isSpace?T:0)+x,et=a.charProcOperatorList[L.operatorListId];if(!et){(0,A.warn)(`Type3 character "${L.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=L,this.save(),t.scale(h,h),t.transform(...I),this.executeOperatorList(et),this.restore()),$=A.Util.applyTransform([L.width,0],I)[0]*h+W,t.translate($,0),i.x+=$*F}t.restore(),this.processingType3=null}}setCharWidth(s,t){}setCharWidthAndBounds(s,t,i,a,h,f){this.ctx.rect(i,a,h-i,f-a),this.ctx.clip(),this.endPath()}getColorN_Pattern(s){let t;if(s[0]==="TilingPattern"){const i=s[1],a=this.baseTransform||(0,z.getCurrentTransform)(this.ctx),h={createCanvasGraphics:f=>new d(f,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};t=new p(s,i,this.ctx,h,a)}else t=this._getPattern(s[1],s[2]);return t}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(s,t,i){const a=A.Util.makeHexColor(s,t,i);this.ctx.strokeStyle=a,this.current.strokeColor=a}setFillRGBColor(s,t,i){const a=A.Util.makeHexColor(s,t,i);this.ctx.fillStyle=a,this.current.fillColor=a,this.current.patternFill=!1}_getPattern(s,t=null){let i;return this.cachedPatterns.has(s)?i=this.cachedPatterns.get(s):(i=g(this.getObject(s)),this.cachedPatterns.set(s,i)),t&&(i.matrix=t),i}shadingFill(s){if(!this.contentVisible)return;const t=this.ctx;this.save();const i=this._getPattern(s);t.fillStyle=i.getPattern(t,this,(0,z.getCurrentTransformInverse)(t),C.SHADING);const a=(0,z.getCurrentTransformInverse)(t);if(a){const{width:h,height:f}=t.canvas,[w,x,T,F]=A.Util.getAxialAlignedBoundingBox([0,0,h,f],a);this.ctx.fillRect(w,x,T-w,F-x)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,A.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,A.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(s,t){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(s)&&s.length===6&&this.transform(...s),this.baseTransform=(0,z.getCurrentTransform)(this.ctx),t)){const i=t[2]-t[0],a=t[3]-t[1];this.ctx.rect(t[0],t[1],i,a),this.current.updateRectMinMax((0,z.getCurrentTransform)(this.ctx),t),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(s){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const t=this.ctx;s.isolated||(0,A.info)("TODO: Support non-isolated groups."),s.knockout&&(0,A.warn)("Knockout groups not supported.");const i=(0,z.getCurrentTransform)(t);if(s.matrix&&t.transform(...s.matrix),!s.bbox)throw new Error("Bounding box is required.");let a=A.Util.getAxialAlignedBoundingBox(s.bbox,(0,z.getCurrentTransform)(t));const h=[0,0,t.canvas.width,t.canvas.height];a=A.Util.intersect(a,h)||[0,0,0,0];const f=Math.floor(a[0]),w=Math.floor(a[1]);let x=Math.max(Math.ceil(a[2])-f,1),T=Math.max(Math.ceil(a[3])-w,1),F=1,I=1;x>b&&(F=x/b,x=b),T>b&&(I=T/b,T=b),this.current.startNewPathAndClipBox([0,0,x,T]);let H="groupAt"+this.groupLevel;s.smask&&(H+="_smask_"+this.smaskCounter++%2);const N=this.cachedCanvases.getCanvas(H,x,T),S=N.context;S.scale(1/F,1/I),S.translate(-f,-w),S.transform(...i),s.smask?this.smaskStack.push({canvas:N.canvas,context:S,offsetX:f,offsetY:w,scaleX:F,scaleY:I,subtype:s.smask.subtype,backdrop:s.smask.backdrop,transferMap:s.smask.transferMap||null,startTransformInverse:null}):(t.setTransform(1,0,0,1,0,0),t.translate(f,w),t.scale(F,I),t.save()),O(t,S),this.ctx=S,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(t),this.groupLevel++}endGroup(s){if(!this.contentVisible)return;this.groupLevel--;const t=this.ctx,i=this.groupStack.pop();if(this.ctx=i,this.ctx.imageSmoothingEnabled=!1,s.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const a=(0,z.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...a);const h=A.Util.getAxialAlignedBoundingBox([0,0,t.canvas.width,t.canvas.height],a);this.ctx.drawImage(t.canvas,0,0),this.ctx.restore(),this.compose(h)}}beginAnnotation(s,t,i,a,h){if(this.#t(),B(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(t)&&t.length===4){const f=t[2]-t[0],w=t[3]-t[1];if(h&&this.annotationCanvasMap){i=i.slice(),i[4]-=t[0],i[5]-=t[1],t=t.slice(),t[0]=t[1]=0,t[2]=f,t[3]=w;const[x,T]=A.Util.singularValueDecompose2dScale((0,z.getCurrentTransform)(this.ctx)),{viewportScale:F}=this,I=Math.ceil(f*this.outputScaleX*F),H=Math.ceil(w*this.outputScaleY*F);this.annotationCanvas=this.canvasFactory.create(I,H);const{canvas:N,context:S}=this.annotationCanvas;this.annotationCanvasMap.set(s,N),this.annotationCanvas.savedCtx=this.ctx,this.ctx=S,this.ctx.save(),this.ctx.setTransform(x,0,0,-T,0,w*T),B(this.ctx)}else B(this.ctx),this.ctx.rect(t[0],t[1],f,w),this.ctx.clip(),this.endPath()}this.current=new tt(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...i),this.transform(...a)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),this.#e(),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(s){if(!this.contentVisible)return;const t=s.count;s=this.getObject(s.data,s),s.count=t;const i=this.ctx,a=this.processingType3;if(a&&(a.compiled===void 0&&(a.compiled=Y(s)),a.compiled)){a.compiled(i);return}const h=this._createMaskCanvas(s),f=h.canvas;i.save(),i.setTransform(1,0,0,1,0,0),i.drawImage(f,h.offsetX,h.offsetY),i.restore(),this.compose()}paintImageMaskXObjectRepeat(s,t,i=0,a=0,h,f){if(!this.contentVisible)return;s=this.getObject(s.data,s);const w=this.ctx;w.save();const x=(0,z.getCurrentTransform)(w);w.transform(t,i,a,h,0,0);const T=this._createMaskCanvas(s);w.setTransform(1,0,0,1,T.offsetX-x[4],T.offsetY-x[5]);for(let F=0,I=f.length;F<I;F+=2){const H=A.Util.transform(x,[t,i,a,h,f[F],f[F+1]]),[N,S]=A.Util.applyTransform([0,0],H);w.drawImage(T.canvas,N,S)}w.restore(),this.compose()}paintImageMaskXObjectGroup(s){if(!this.contentVisible)return;const t=this.ctx,i=this.current.fillColor,a=this.current.patternFill;for(const h of s){const{data:f,width:w,height:x,transform:T}=h,F=this.cachedCanvases.getCanvas("maskCanvas",w,x),I=F.context;I.save();const H=this.getObject(f,h);j(I,H),I.globalCompositeOperation="source-in",I.fillStyle=a?i.getPattern(I,this,(0,z.getCurrentTransformInverse)(t),C.FILL):i,I.fillRect(0,0,w,x),I.restore(),t.save(),t.transform(...T),t.scale(1,-1),_(t,F.canvas,0,0,w,x,0,-1,1,1),t.restore()}this.compose()}paintImageXObject(s){if(!this.contentVisible)return;const t=this.getObject(s);if(!t){(0,A.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(t)}paintImageXObjectRepeat(s,t,i,a){if(!this.contentVisible)return;const h=this.getObject(s);if(!h){(0,A.warn)("Dependent image isn't ready yet");return}const f=h.width,w=h.height,x=[];for(let T=0,F=a.length;T<F;T+=2)x.push({transform:[t,0,0,i,a[T],a[T+1]],x:0,y:0,w:f,h:w});this.paintInlineImageXObjectGroup(h,x)}applyTransferMapsToCanvas(s){return this.current.transferMaps!=="none"&&(s.filter=this.current.transferMaps,s.drawImage(s.canvas,0,0),s.filter="none"),s.canvas}applyTransferMapsToBitmap(s){if(this.current.transferMaps==="none")return s.bitmap;const{bitmap:t,width:i,height:a}=s,h=this.cachedCanvases.getCanvas("inlineImage",i,a),f=h.context;return f.filter=this.current.transferMaps,f.drawImage(t,0,0),f.filter="none",h.canvas}paintInlineImageXObject(s){if(!this.contentVisible)return;const t=s.width,i=s.height,a=this.ctx;if(this.save(),!A.isNodeJS){const{filter:w}=a;w!=="none"&&w!==""&&(a.filter="none")}a.scale(1/t,-1/i);let h;if(s.bitmap)h=this.applyTransferMapsToBitmap(s);else if(typeof HTMLElement=="function"&&s instanceof HTMLElement||!s.data)h=s;else{const x=this.cachedCanvases.getCanvas("inlineImage",t,i).context;rt(x,s),h=this.applyTransferMapsToCanvas(x)}const f=this._scaleImage(h,(0,z.getCurrentTransformInverse)(a));a.imageSmoothingEnabled=at((0,z.getCurrentTransform)(a),s.interpolate),_(a,f.img,0,0,f.paintWidth,f.paintHeight,0,-i,t,i),this.compose(),this.restore()}paintInlineImageXObjectGroup(s,t){if(!this.contentVisible)return;const i=this.ctx;let a;if(s.bitmap)a=s.bitmap;else{const h=s.width,f=s.height,x=this.cachedCanvases.getCanvas("inlineImage",h,f).context;rt(x,s),a=this.applyTransferMapsToCanvas(x)}for(const h of t)i.save(),i.transform(...h.transform),i.scale(1,-1),_(i,a,h.x,h.y,h.w,h.h,0,-1,1,1),i.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(s){}markPointProps(s,t){}beginMarkedContent(s){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(s,t){s==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(t)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(s){const t=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(s);const i=this.ctx;this.pendingClip&&(t||(this.pendingClip===J?i.clip("evenodd"):i.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),i.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const s=(0,z.getCurrentTransform)(this.ctx);if(s[1]===0&&s[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(s[0]),Math.abs(s[3]));else{const t=Math.abs(s[0]*s[3]-s[2]*s[1]),i=Math.hypot(s[0],s[2]),a=Math.hypot(s[1],s[3]);this._cachedGetSinglePixelWidth=Math.max(i,a)/t}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:s}=this.current,{a:t,b:i,c:a,d:h}=this.ctx.getTransform();let f,w;if(i===0&&a===0){const x=Math.abs(t),T=Math.abs(h);if(x===T)if(s===0)f=w=1/x;else{const F=x*s;f=w=F<1?1/F:1}else if(s===0)f=1/x,w=1/T;else{const F=x*s,I=T*s;f=F<1?1/F:1,w=I<1?1/I:1}}else{const x=Math.abs(t*h-i*a),T=Math.hypot(t,i),F=Math.hypot(a,h);if(s===0)f=F/x,w=T/x;else{const I=s*x;f=F>I?F/I:1,w=T>I?T/I:1}}this._cachedScaleForStroking[0]=f,this._cachedScaleForStroking[1]=w}return this._cachedScaleForStroking}rescaleAndStroke(s){const{ctx:t}=this,{lineWidth:i}=this.current,[a,h]=this.getScaleForStroking();if(t.lineWidth=i||1,a===1&&h===1){t.stroke();return}const f=t.getLineDash();if(s&&t.save(),t.scale(a,h),f.length>0){const w=Math.max(a,h);t.setLineDash(f.map(x=>x/w)),t.lineDashOffset/=w}t.stroke(),s&&t.restore()}isContentVisible(){for(let s=this.markedContentStack.length-1;s>=0;s--)if(!this.markedContentStack[s].visible)return!1;return!0}}for(const o in A.OPS)d.prototype[o]!==void 0&&(d.prototype[A.OPS[o]]=d.prototype[o])},473:(ht,Z,U)=>{U.d(Z,{DOMCMapReaderFactory:()=>v,DOMCanvasFactory:()=>P,DOMFilterFactory:()=>k,DOMSVGFactory:()=>u,DOMStandardFontDataFactory:()=>l,PDFDateString:()=>M,PageViewport:()=>g,PixelsPerInch:()=>D,RenderingCancelledException:()=>r,StatTimer:()=>b,fetchData:()=>y,getColorValues:()=>_,getCurrentTransform:()=>Y,getCurrentTransformInverse:()=>tt,getFilenameFromUrl:()=>n,getPdfFilenameFromUrl:()=>c,getRGB:()=>G,getXfaPageViewport:()=>V,isDataScheme:()=>p,isPdfFile:()=>e,isValidFetchUrl:()=>m,noContextMenu:()=>R,setLayerDimensions:()=>rt});var A=U(822),z=U(266);const C="http://www.w3.org/2000/svg";class D{static CSS=96;static PDF=72;static PDF_TO_CSS_UNITS=this.CSS/this.PDF}class k extends A.BaseFilterFactory{#t;#e;#s;#i;#n;#r;#o;#l;#h;#c;#f=0;constructor({docId:O,ownerDocument:B=globalThis.document}={}){super(),this.#s=O,this.#i=B}get#u(){return this.#t||=new Map}get#d(){if(!this.#e){const O=this.#i.createElement("div"),{style:B}=O;B.visibility="hidden",B.contain="strict",B.width=B.height=0,B.position="absolute",B.top=B.left=0,B.zIndex=-1;const q=this.#i.createElementNS(C,"svg");q.setAttribute("width",0),q.setAttribute("height",0),this.#e=this.#i.createElementNS(C,"defs"),O.append(q),q.append(this.#e),this.#i.body.append(O)}return this.#e}addFilter(O){if(!O)return"none";let B=this.#u.get(O);if(B)return B;let q,Q,K,ft;if(O.length===1){const dt=O[0],ct=new Array(256);for(let J=0;J<256;J++)ct[J]=dt[J]/255;ft=q=Q=K=ct.join(",")}else{const[dt,ct,J]=O,d=new Array(256),o=new Array(256),s=new Array(256);for(let t=0;t<256;t++)d[t]=dt[t]/255,o[t]=ct[t]/255,s[t]=J[t]/255;q=d.join(","),Q=o.join(","),K=s.join(","),ft=`${q}${Q}${K}`}if(B=this.#u.get(ft),B)return this.#u.set(O,B),B;const ot=`g_${this.#s}_transfer_map_${this.#f++}`,at=`url(#${ot})`;this.#u.set(O,at),this.#u.set(ft,at);const gt=this.#p(ot);return this.#b(q,Q,K,gt),at}addHCMFilter(O,B){const q=`${O}-${B}`;if(this.#r===q)return this.#o;if(this.#r=q,this.#o="none",this.#n?.remove(),!O||!B)return this.#o;const Q=this.#A(O);O=z.Util.makeHexColor(...Q);const K=this.#A(B);if(B=z.Util.makeHexColor(...K),this.#d.style.color="",O==="#000000"&&B==="#ffffff"||O===B)return this.#o;const ft=new Array(256);for(let ct=0;ct<=255;ct++){const J=ct/255;ft[ct]=J<=.03928?J/12.92:((J+.055)/1.055)**2.4}const ot=ft.join(","),at=`g_${this.#s}_hcm_filter`,gt=this.#l=this.#p(at);this.#b(ot,ot,ot,gt),this.#a(gt);const dt=(ct,J)=>{const d=Q[ct]/255,o=K[ct]/255,s=new Array(J+1);for(let t=0;t<=J;t++)s[t]=d+t/J*(o-d);return s.join(",")};return this.#b(dt(0,5),dt(1,5),dt(2,5),gt),this.#o=`url(#${at})`,this.#o}addHighlightHCMFilter(O,B,q,Q){const K=`${O}-${B}-${q}-${Q}`;if(this.#h===K)return this.#c;if(this.#h=K,this.#c="none",this.#l?.remove(),!O||!B)return this.#c;const[ft,ot]=[O,B].map(this.#A.bind(this));let at=Math.round(.2126*ft[0]+.7152*ft[1]+.0722*ft[2]),gt=Math.round(.2126*ot[0]+.7152*ot[1]+.0722*ot[2]),[dt,ct]=[q,Q].map(this.#A.bind(this));gt<at&&([at,gt,dt,ct]=[gt,at,ct,dt]),this.#d.style.color="";const J=(s,t,i)=>{const a=new Array(256),h=(gt-at)/i,f=s/255,w=(t-s)/(255*i);let x=0;for(let T=0;T<=i;T++){const F=Math.round(at+T*h),I=f+T*w;for(let H=x;H<=F;H++)a[H]=I;x=F+1}for(let T=x;T<256;T++)a[T]=a[x-1];return a.join(",")},d=`g_${this.#s}_hcm_highlight_filter`,o=this.#l=this.#p(d);return this.#a(o),this.#b(J(dt[0],ct[0],5),J(dt[1],ct[1],5),J(dt[2],ct[2],5),o),this.#c=`url(#${d})`,this.#c}destroy(O=!1){O&&(this.#o||this.#c)||(this.#e&&(this.#e.parentNode.parentNode.remove(),this.#e=null),this.#t&&(this.#t.clear(),this.#t=null),this.#f=0)}#a(O){const B=this.#i.createElementNS(C,"feColorMatrix");B.setAttribute("type","matrix"),B.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),O.append(B)}#p(O){const B=this.#i.createElementNS(C,"filter");return B.setAttribute("color-interpolation-filters","sRGB"),B.setAttribute("id",O),this.#d.append(B),B}#m(O,B,q){const Q=this.#i.createElementNS(C,B);Q.setAttribute("type","discrete"),Q.setAttribute("tableValues",q),O.append(Q)}#b(O,B,q,Q){const K=this.#i.createElementNS(C,"feComponentTransfer");Q.append(K),this.#m(K,"feFuncR",O),this.#m(K,"feFuncG",B),this.#m(K,"feFuncB",q)}#A(O){return this.#d.style.color=O,G(getComputedStyle(this.#d).getPropertyValue("color"))}}class P extends A.BaseCanvasFactory{constructor({ownerDocument:O=globalThis.document}={}){super(),this._document=O}_createCanvas(O,B){const q=this._document.createElement("canvas");return q.width=O,q.height=B,q}}async function y(j,O="text"){if(m(j,document.baseURI)){const B=await fetch(j);if(!B.ok)throw new Error(B.statusText);switch(O){case"arraybuffer":return B.arrayBuffer();case"blob":return B.blob();case"json":return B.json()}return B.text()}return new Promise((B,q)=>{const Q=new XMLHttpRequest;Q.open("GET",j,!0),Q.responseType=O,Q.onreadystatechange=()=>{if(Q.readyState===XMLHttpRequest.DONE){if(Q.status===200||Q.status===0){let K;switch(O){case"arraybuffer":case"blob":case"json":K=Q.response;break;default:K=Q.responseText;break}if(K){B(K);return}}q(new Error(Q.statusText))}},Q.send(null)})}class v extends A.BaseCMapReaderFactory{_fetchData(O,B){return y(O,this.isCompressed?"arraybuffer":"text").then(q=>({cMapData:q instanceof ArrayBuffer?new Uint8Array(q):(0,z.stringToBytes)(q),compressionType:B}))}}class l extends A.BaseStandardFontDataFactory{_fetchData(O){return y(O,"arraybuffer").then(B=>new Uint8Array(B))}}class u extends A.BaseSVGFactory{_createSVG(O){return document.createElementNS(C,O)}}class g{constructor({viewBox:O,scale:B,rotation:q,offsetX:Q=0,offsetY:K=0,dontFlip:ft=!1}){this.viewBox=O,this.scale=B,this.rotation=q,this.offsetX=Q,this.offsetY=K;const ot=(O[2]+O[0])/2,at=(O[3]+O[1])/2;let gt,dt,ct,J;switch(q%=360,q<0&&(q+=360),q){case 180:gt=-1,dt=0,ct=0,J=1;break;case 90:gt=0,dt=1,ct=1,J=0;break;case 270:gt=0,dt=-1,ct=-1,J=0;break;case 0:gt=1,dt=0,ct=0,J=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}ft&&(ct=-ct,J=-J);let d,o,s,t;gt===0?(d=Math.abs(at-O[1])*B+Q,o=Math.abs(ot-O[0])*B+K,s=(O[3]-O[1])*B,t=(O[2]-O[0])*B):(d=Math.abs(ot-O[0])*B+Q,o=Math.abs(at-O[1])*B+K,s=(O[2]-O[0])*B,t=(O[3]-O[1])*B),this.transform=[gt*B,dt*B,ct*B,J*B,d-gt*B*ot-ct*B*at,o-dt*B*ot-J*B*at],this.width=s,this.height=t}get rawDims(){const{viewBox:O}=this;return(0,z.shadow)(this,"rawDims",{pageWidth:O[2]-O[0],pageHeight:O[3]-O[1],pageX:O[0],pageY:O[1]})}clone({scale:O=this.scale,rotation:B=this.rotation,offsetX:q=this.offsetX,offsetY:Q=this.offsetY,dontFlip:K=!1}={}){return new g({viewBox:this.viewBox.slice(),scale:O,rotation:B,offsetX:q,offsetY:Q,dontFlip:K})}convertToViewportPoint(O,B){return z.Util.applyTransform([O,B],this.transform)}convertToViewportRectangle(O){const B=z.Util.applyTransform([O[0],O[1]],this.transform),q=z.Util.applyTransform([O[2],O[3]],this.transform);return[B[0],B[1],q[0],q[1]]}convertToPdfPoint(O,B){return z.Util.applyInverseTransform([O,B],this.transform)}}class r extends z.BaseException{constructor(O,B=0){super(O,"RenderingCancelledException"),this.extraDelay=B}}function p(j){const O=j.length;let B=0;for(;B<O&&j[B].trim()==="";)B++;return j.substring(B,B+5).toLowerCase()==="data:"}function e(j){return typeof j=="string"&&/\.pdf$/i.test(j)}function n(j,O=!1){return O||([j]=j.split(/[#?]/,1)),j.substring(j.lastIndexOf("/")+1)}function c(j,O="document.pdf"){if(typeof j!="string")return O;if(p(j))return(0,z.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),O;const B=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,q=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,Q=B.exec(j);let K=q.exec(Q[1])||q.exec(Q[2])||q.exec(Q[3]);if(K&&(K=K[0],K.includes("%")))try{K=q.exec(decodeURIComponent(K))[0]}catch{}return K||O}class b{started=Object.create(null);times=[];time(O){O in this.started&&(0,z.warn)(`Timer is already running for ${O}`),this.started[O]=Date.now()}timeEnd(O){O in this.started||(0,z.warn)(`Timer has not been started for ${O}`),this.times.push({name:O,start:this.started[O],end:Date.now()}),delete this.started[O]}toString(){const O=[];let B=0;for(const{name:q}of this.times)B=Math.max(q.length,B);for(const{name:q,start:Q,end:K}of this.times)O.push(`${q.padEnd(B)} ${K-Q}ms
`);return O.join("")}}function m(j,O){try{const{protocol:B}=O?new URL(j,O):new URL(j);return B==="http:"||B==="https:"}catch{return!1}}function R(j){j.preventDefault()}let E;class M{static toDateObject(O){if(!O||typeof O!="string")return null;E||=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?");const B=E.exec(O);if(!B)return null;const q=parseInt(B[1],10);let Q=parseInt(B[2],10);Q=Q>=1&&Q<=12?Q-1:0;let K=parseInt(B[3],10);K=K>=1&&K<=31?K:1;let ft=parseInt(B[4],10);ft=ft>=0&&ft<=23?ft:0;let ot=parseInt(B[5],10);ot=ot>=0&&ot<=59?ot:0;let at=parseInt(B[6],10);at=at>=0&&at<=59?at:0;const gt=B[7]||"Z";let dt=parseInt(B[8],10);dt=dt>=0&&dt<=23?dt:0;let ct=parseInt(B[9],10)||0;return ct=ct>=0&&ct<=59?ct:0,gt==="-"?(ft+=dt,ot+=ct):gt==="+"&&(ft-=dt,ot-=ct),new Date(Date.UTC(q,Q,K,ft,ot,at))}}function V(j,{scale:O=1,rotation:B=0}){const{width:q,height:Q}=j.attributes.style,K=[0,0,parseInt(q),parseInt(Q)];return new g({viewBox:K,scale:O,rotation:B})}function G(j){if(j.startsWith("#")){const O=parseInt(j.slice(1),16);return[(O&16711680)>>16,(O&65280)>>8,O&255]}return j.startsWith("rgb(")?j.slice(4,-1).split(",").map(O=>parseInt(O)):j.startsWith("rgba(")?j.slice(5,-1).split(",").map(O=>parseInt(O)).slice(0,3):((0,z.warn)(`Not a valid color format: "${j}"`),[0,0,0])}function _(j){const O=document.createElement("span");O.style.visibility="hidden",document.body.append(O);for(const B of j.keys()){O.style.color=B;const q=window.getComputedStyle(O).color;j.set(B,G(q))}O.remove()}function Y(j){const{a:O,b:B,c:q,d:Q,e:K,f:ft}=j.getTransform();return[O,B,q,Q,K,ft]}function tt(j){const{a:O,b:B,c:q,d:Q,e:K,f:ft}=j.getTransform().invertSelf();return[O,B,q,Q,K,ft]}function rt(j,O,B=!1,q=!0){if(O instanceof g){const{pageWidth:Q,pageHeight:K}=O.rawDims,{style:ft}=j,ot=z.FeatureTest.isCSSRoundSupported,at=`var(--scale-factor) * ${Q}px`,gt=`var(--scale-factor) * ${K}px`,dt=ot?`round(${at}, 1px)`:`calc(${at})`,ct=ot?`round(${gt}, 1px)`:`calc(${gt})`;!B||O.rotation%180===0?(ft.width=dt,ft.height=ct):(ft.width=ct,ft.height=dt)}q&&j.setAttribute("data-main-rotation",O.rotation)}},423:(ht,Z,U)=>{U.d(Z,{DrawLayer:()=>C});var A=U(473),z=U(266);class C{#t=null;#e=0;#s=new Map;constructor({pageIndex:k}){this.pageIndex=k}setParent(k){if(!this.#t){this.#t=k;return}if(this.#t!==k){if(this.#s.size>0)for(const P of this.#s.values())P.remove(),k.append(P);this.#t=k}}static get _svgFactory(){return(0,z.shadow)(this,"_svgFactory",new A.DOMSVGFactory)}static#i(k,{x:P,y,width:v,height:l}){const{style:u}=k;u.top=`${100*y}%`,u.left=`${100*P}%`,u.width=`${100*v}%`,u.height=`${100*l}%`}#n(k){const P=C._svgFactory.create(1,1,!0);return this.#t.append(P),C.#i(P,k),P}highlight({outlines:k,box:P},y,v){const l=this.#e++,u=this.#n(P);u.classList.add("highlight");const g=C._svgFactory.createElement("defs");u.append(g);const r=C._svgFactory.createElement("path");g.append(r);const p=`path_p${this.pageIndex}_${l}`;r.setAttribute("id",p),r.setAttribute("d",C.#r(k));const e=C._svgFactory.createElement("clipPath");g.append(e);const n=`clip_${p}`;e.setAttribute("id",n),e.setAttribute("clipPathUnits","objectBoundingBox");const c=C._svgFactory.createElement("use");e.append(c),c.setAttribute("href",`#${p}`),c.classList.add("clip");const b=C._svgFactory.createElement("use");return u.append(b),u.setAttribute("fill",y),u.setAttribute("fill-opacity",v),b.setAttribute("href",`#${p}`),this.#s.set(l,u),{id:l,clipPathId:`url(#${n})`}}highlightOutline({outlines:k,box:P}){const y=this.#e++,v=this.#n(P);v.classList.add("highlightOutline");const l=C._svgFactory.createElement("defs");v.append(l);const u=C._svgFactory.createElement("path");l.append(u);const g=`path_p${this.pageIndex}_${y}`;u.setAttribute("id",g),u.setAttribute("d",C.#r(k)),u.setAttribute("vector-effect","non-scaling-stroke");const r=C._svgFactory.createElement("use");v.append(r),r.setAttribute("href",`#${g}`);const p=r.cloneNode();return v.append(p),r.classList.add("mainOutline"),p.classList.add("secondaryOutline"),this.#s.set(y,v),y}static#r(k){const P=[];for(const y of k){let[v,l]=y;P.push(`M${v} ${l}`);for(let u=2;u<y.length;u+=2){const g=y[u],r=y[u+1];g===v?(P.push(`V${r}`),l=r):r===l&&(P.push(`H${g}`),v=g)}P.push("Z")}return P.join(" ")}updateBox(k,P){C.#i(this.#s.get(k),P)}rotate(k,P){this.#s.get(k).setAttribute("data-main-rotation",P)}changeColor(k,P){this.#s.get(k).setAttribute("fill",P)}changeOpacity(k,P){this.#s.get(k).setAttribute("fill-opacity",P)}addClass(k,P){this.#s.get(k).classList.add(P)}removeClass(k,P){this.#s.get(k).classList.remove(P)}remove(k){this.#t!==null&&(this.#s.get(k).remove(),this.#s.delete(k))}destroy(){this.#t=null;for(const k of this.#s.values())k.remove();this.#s.clear()}}},629:(ht,Z,U)=>{U.d(Z,{AnnotationEditorLayer:()=>r});var A=U(266),z=U(115),C=U(812),D=U(640);class k extends z.AnnotationEditor{#t=this.editorDivBlur.bind(this);#e=this.editorDivFocus.bind(this);#s=this.editorDivInput.bind(this);#i=this.editorDivKeydown.bind(this);#n;#r="";#o=`${this.id}-editor`;#l;#h=null;static _freeTextDefaultContent="";static _internalPadding=0;static _defaultColor=null;static _defaultFontSize=10;static get _keyboardManager(){const e=k.prototype,n=m=>m.isEmpty(),c=C.AnnotationEditorUIManager.TRANSLATE_SMALL,b=C.AnnotationEditorUIManager.TRANSLATE_BIG;return(0,A.shadow)(this,"_keyboardManager",new C.KeyboardManager([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],e.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],e.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],e._translateEmpty,{args:[-c,0],checker:n}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e._translateEmpty,{args:[-b,0],checker:n}],[["ArrowRight","mac+ArrowRight"],e._translateEmpty,{args:[c,0],checker:n}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e._translateEmpty,{args:[b,0],checker:n}],[["ArrowUp","mac+ArrowUp"],e._translateEmpty,{args:[0,-c],checker:n}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e._translateEmpty,{args:[0,-b],checker:n}],[["ArrowDown","mac+ArrowDown"],e._translateEmpty,{args:[0,c],checker:n}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e._translateEmpty,{args:[0,b],checker:n}]]))}static _type="freetext";static _editorType=A.AnnotationEditorType.FREETEXT;constructor(e){super({...e,name:"freeTextEditor"}),this.#n=e.color||k._defaultColor||z.AnnotationEditor._defaultLineColor,this.#l=e.fontSize||k._defaultFontSize}static initialize(e){z.AnnotationEditor.initialize(e,{strings:["pdfjs-free-text-default-content"]});const n=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(n.getPropertyValue("--freetext-padding"))}static updateDefaultParams(e,n){switch(e){case A.AnnotationEditorParamsType.FREETEXT_SIZE:k._defaultFontSize=n;break;case A.AnnotationEditorParamsType.FREETEXT_COLOR:k._defaultColor=n;break}}updateParams(e,n){switch(e){case A.AnnotationEditorParamsType.FREETEXT_SIZE:this.#c(n);break;case A.AnnotationEditorParamsType.FREETEXT_COLOR:this.#f(n);break}}static get defaultPropertiesToUpdate(){return[[A.AnnotationEditorParamsType.FREETEXT_SIZE,k._defaultFontSize],[A.AnnotationEditorParamsType.FREETEXT_COLOR,k._defaultColor||z.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[A.AnnotationEditorParamsType.FREETEXT_SIZE,this.#l],[A.AnnotationEditorParamsType.FREETEXT_COLOR,this.#n]]}#c(e){const n=b=>{this.editorDiv.style.fontSize=`calc(${b}px * var(--scale-factor))`,this.translate(0,-(b-this.#l)*this.parentScale),this.#l=b,this.#d()},c=this.#l;this.addCommands({cmd:()=>{n(e)},undo:()=>{n(c)},mustExec:!0,type:A.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}#f(e){const n=this.#n;this.addCommands({cmd:()=>{this.#n=this.editorDiv.style.color=e},undo:()=>{this.#n=this.editorDiv.style.color=n},mustExec:!0,type:A.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}_translateEmpty(e,n){this._uiManager.translateSelectedEditors(e,n,!0)}getInitialTranslation(){const e=this.parentScale;return[-k._internalPadding*e,-(k._internalPadding+this.#l)*e]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(A.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.editorDiv.addEventListener("keydown",this.#i),this.editorDiv.addEventListener("focus",this.#e),this.editorDiv.addEventListener("blur",this.#t),this.editorDiv.addEventListener("input",this.#s))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",this.#o),this._isDraggable=!0,this.editorDiv.removeEventListener("keydown",this.#i),this.editorDiv.removeEventListener("focus",this.#e),this.editorDiv.removeEventListener("blur",this.#t),this.editorDiv.removeEventListener("input",this.#s),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"))}focusin(e){this._focusEventsAllowed&&(super.focusin(e),e.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(){if(this.width){this.#m();return}this.enableEditMode(),this.editorDiv.focus(),this._initialOptions?.isCentered&&this.center(),this._initialOptions=null}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}#u(){const e=this.editorDiv.getElementsByTagName("div");if(e.length===0)return this.editorDiv.innerText;const n=[];for(const c of e)n.push(c.innerText.replace(/\r\n?|\n/,""));return n.join(`
`)}#d(){const[e,n]=this.parentDimensions;let c;if(this.isAttachedToDOM)c=this.div.getBoundingClientRect();else{const{currentLayer:b,div:m}=this,R=m.style.display;m.style.display="hidden",b.div.append(this.div),c=m.getBoundingClientRect(),m.remove(),m.style.display=R}this.rotation%180===this.parentRotation%180?(this.width=c.width/e,this.height=c.height/n):(this.width=c.height/e,this.height=c.width/n),this.fixAndSetPosition()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const e=this.#r,n=this.#r=this.#u().trimEnd();if(e===n)return;const c=b=>{if(this.#r=b,!b){this.remove();return}this.#a(),this._uiManager.rebuild(this),this.#d()};this.addCommands({cmd:()=>{c(n)},undo:()=>{c(e)},mustExec:!1}),this.#d()}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(e){this.enterInEditMode()}keydown(e){e.target===this.div&&e.key==="Enter"&&(this.enterInEditMode(),e.preventDefault())}editorDivKeydown(e){k._keyboardManager.exec(this,e)}editorDivFocus(e){this.isEditing=!0}editorDivBlur(e){this.isEditing=!1}editorDivInput(e){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let e,n;this.width&&(e=this.x,n=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",this.#o),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text"),this.enableEditing(),z.AnnotationEditor._l10nPromise.get("pdfjs-free-text-default-content").then(b=>this.editorDiv?.setAttribute("default-content",b)),this.editorDiv.contentEditable=!0;const{style:c}=this.editorDiv;if(c.fontSize=`calc(${this.#l}px * var(--scale-factor))`,c.color=this.#n,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,C.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){const[b,m]=this.parentDimensions;if(this.annotationElementId){const{position:R}=this.#h;let[E,M]=this.getInitialTranslation();[E,M]=this.pageTranslationToScreen(E,M);const[V,G]=this.pageDimensions,[_,Y]=this.pageTranslation;let tt,rt;switch(this.rotation){case 0:tt=e+(R[0]-_)/V,rt=n+this.height-(R[1]-Y)/G;break;case 90:tt=e+(R[0]-_)/V,rt=n-(R[1]-Y)/G,[E,M]=[M,-E];break;case 180:tt=e-this.width+(R[0]-_)/V,rt=n-(R[1]-Y)/G,[E,M]=[-E,-M];break;case 270:tt=e+(R[0]-_-this.height*G)/V,rt=n+(R[1]-Y-this.width*V)/G,[E,M]=[-M,E];break}this.setAt(tt*b,rt*m,E,M)}else this.setAt(e*b,n*m,this.width*b,this.height*m);this.#a(),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}#a(){if(this.editorDiv.replaceChildren(),!!this.#r)for(const e of this.#r.split(`
`)){const n=document.createElement("div");n.append(e?document.createTextNode(e):document.createElement("br")),this.editorDiv.append(n)}}get contentDiv(){return this.editorDiv}static deserialize(e,n,c){let b=null;if(e instanceof D.FreeTextAnnotationElement){const{data:{defaultAppearanceData:{fontSize:R,fontColor:E},rect:M,rotation:V,id:G},textContent:_,textPosition:Y,parent:{page:{pageNumber:tt}}}=e;if(!_||_.length===0)return null;b=e={annotationType:A.AnnotationEditorType.FREETEXT,color:Array.from(E),fontSize:R,value:_.join(`
`),position:Y,pageIndex:tt-1,rect:M,rotation:V,id:G,deleted:!1}}const m=super.deserialize(e,n,c);return m.#l=e.fontSize,m.#n=A.Util.makeHexColor(...e.color),m.#r=e.value,m.annotationElementId=e.id||null,m.#h=b,m}serialize(e=!1){if(this.isEmpty())return null;if(this.deleted)return{pageIndex:this.pageIndex,id:this.annotationElementId,deleted:!0};const n=k._internalPadding*this.parentScale,c=this.getRect(n,n),b=z.AnnotationEditor._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.#n),m={annotationType:A.AnnotationEditorType.FREETEXT,color:b,fontSize:this.#l,value:this.#r,pageIndex:this.pageIndex,rect:c,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return e?m:this.annotationElementId&&!this.#p(m)?null:(m.id=this.annotationElementId,m)}#p(e){const{value:n,fontSize:c,color:b,rect:m,pageIndex:R}=this.#h;return e.value!==n||e.fontSize!==c||e.rect.some((E,M)=>Math.abs(E-m[M])>=1)||e.color.some((E,M)=>E!==b[M])||e.pageIndex!==R}#m(e=!1){if(!this.annotationElementId)return;if(this.#d(),!e&&(this.width===0||this.height===0)){setTimeout(()=>this.#m(!0),0);return}const n=k._internalPadding*this.parentScale;this.#h.rect=this.getRect(n,n)}}var P=U(97),y=U(405);class v extends z.AnnotationEditor{#t;#e=null;#s=null;#i=null;#n=null;#r=null;#o=null;#l=null;#h;#c=null;static _defaultColor=null;static _defaultOpacity=1;static _l10nPromise;static _type="highlight";static _editorType=A.AnnotationEditorType.HIGHLIGHT;constructor(e){super({...e,name:"highlightEditor"}),v._defaultColor||=this._uiManager.highlightColors?.values().next().value||"#fff066",this.color=e.color||v._defaultColor,this.#h=e.opacity||v._defaultOpacity,this.#t=e.boxes||null,this._isDraggable=!1,this.#f(),this.#a(),this.rotate(this.rotation)}#f(){const e=new y.Outliner(this.#t,.001);this.#r=e.getOutlines(),{x:this.x,y:this.y,width:this.width,height:this.height}=this.#r.box;const n=new y.Outliner(this.#t,.0025,.001,this._uiManager.direction==="ltr");this.#i=n.getOutlines();const{lastPoint:c}=this.#i.box;this.#l=[(c[0]-this.x)/this.width,(c[1]-this.y)/this.height]}static initialize(e){z.AnnotationEditor.initialize(e)}static updateDefaultParams(e,n){switch(e){case A.AnnotationEditorParamsType.HIGHLIGHT_DEFAULT_COLOR:v._defaultColor=n;break}}get toolbarPosition(){return this.#l}updateParams(e,n){switch(e){case A.AnnotationEditorParamsType.HIGHLIGHT_COLOR:this.#u(n);break}}static get defaultPropertiesToUpdate(){return[[A.AnnotationEditorParamsType.HIGHLIGHT_DEFAULT_COLOR,v._defaultColor]]}get propertiesToUpdate(){return[[A.AnnotationEditorParamsType.HIGHLIGHT_COLOR,this.color||v._defaultColor]]}#u(e){const n=this.color;this.addCommands({cmd:()=>{this.color=e,this.parent.drawLayer.changeColor(this.#o,e),this.#s?.updateColor(e)},undo:()=>{this.color=n,this.parent.drawLayer.changeColor(this.#o,n),this.#s?.updateColor(n)},mustExec:!0,type:A.AnnotationEditorParamsType.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}async addEditToolbar(){const e=await super.addEditToolbar();return e?(this._uiManager.highlightColors&&(this.#s=new P.ColorPicker({editor:this}),e.addColorPicker(this.#s)),e):null}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(0)}getRect(e,n){return super.getRect(e,n,0)}onceAdded(){this.parent.addUndoableEditor(this),this.div.focus()}remove(){super.remove(),this.#d()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#a(),this.isAttachedToDOM||this.parent.add(this)))}setParent(e){let n=!1;this.parent&&!e?this.#d():e&&(this.#a(e),n=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(e),n&&this.select()}#d(){this.#o===null||!this.parent||(this.parent.drawLayer.remove(this.#o),this.#o=null,this.parent.drawLayer.remove(this.#c),this.#c=null)}#a(e=this.parent){this.#o===null&&({id:this.#o,clipPathId:this.#e}=e.drawLayer.highlight(this.#r,this.color,this.#h),this.#n&&(this.#n.style.clipPath=this.#e),this.#c=e.drawLayer.highlightOutline(this.#i))}static#p({x:e,y:n,width:c,height:b},m){switch(m){case 90:return{x:1-n-b,y:e,width:b,height:c};case 180:return{x:1-e-c,y:1-n-b,width:c,height:b};case 270:return{x:n,y:1-e-c,width:b,height:c}}return{x:e,y:n,width:c,height:b}}rotate(e){const{drawLayer:n}=this.parent;n.rotate(this.#o,e),n.rotate(this.#c,e),n.updateBox(this.#o,v.#p(this,e)),n.updateBox(this.#c,v.#p(this.#i.box,e))}render(){if(this.div)return this.div;const e=super.render(),n=this.#n=document.createElement("div");e.append(n),n.className="internal",n.style.clipPath=this.#e;const[c,b]=this.parentDimensions;return this.setDims(this.width*c,this.height*b),(0,C.bindEvents)(this,this.#n,["pointerover","pointerleave"]),this.enableEditing(),e}pointerover(){this.parent.drawLayer.addClass(this.#c,"hovered")}pointerleave(){this.parent.drawLayer.removeClass(this.#c,"hovered")}select(){super.select(),this.parent?.drawLayer.removeClass(this.#c,"hovered"),this.parent?.drawLayer.addClass(this.#c,"selected")}unselect(){super.unselect(),this.parent?.drawLayer.removeClass(this.#c,"selected")}#m(){const[e,n]=this.pageDimensions,c=this.#t,b=new Array(c.length*8);let m=0;for(const{x:R,y:E,width:M,height:V}of c){const G=R*e,_=(1-E-V)*n;b[m]=b[m+4]=G,b[m+1]=b[m+3]=_,b[m+2]=b[m+6]=G+M*e,b[m+5]=b[m+7]=_+V*n,m+=8}return b}#b(){const[e,n]=this.pageDimensions,c=this.width*e,b=this.height*n,m=this.x*e,R=(1-this.y-this.height)*n,E=[];for(const M of this.#r.outlines){const V=new Array(M.length);for(let G=0;G<M.length;G+=2)V[G]=m+M[G]*c,V[G+1]=R+(1-M[G+1])*b;E.push(V)}return E}static deserialize(e,n,c){const b=super.deserialize(e,n,c),{rect:m,color:R,quadPoints:E}=e;b.color=A.Util.makeHexColor(...R),b.#h=e.opacity;const[M,V]=b.pageDimensions;b.width=(m[2]-m[0])/M,b.height=(m[3]-m[1])/V;const G=b.#t=[];for(let _=0;_<E.length;_+=8)G.push({x:E[4]/M,y:1-E[_+5]/V,width:(E[_+2]-E[_])/M,height:(E[_+5]-E[_+1])/V});return b.#f(),b}serialize(e=!1){if(this.isEmpty()||e)return null;const n=this.getRect(0,0),c=z.AnnotationEditor._colorManager.convert(this.color);return{annotationType:A.AnnotationEditorType.HIGHLIGHT,color:c,opacity:this.#h,quadPoints:this.#m(),outlines:this.#b(),pageIndex:this.pageIndex,rect:n,rotation:0,structTreeParentId:this._structTreeParentId}}static canCreateNewEmptyEditor(){return!1}}var l=U(473);class u extends z.AnnotationEditor{#t=0;#e=0;#s=this.canvasPointermove.bind(this);#i=this.canvasPointerleave.bind(this);#n=this.canvasPointerup.bind(this);#r=this.canvasPointerdown.bind(this);#o=null;#l=new Path2D;#h=!1;#c=!1;#f=!1;#u=null;#d=0;#a=0;#p=null;static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=1;static _type="ink";static _editorType=A.AnnotationEditorType.INK;constructor(e){super({...e,name:"inkEditor"}),this.color=e.color||null,this.thickness=e.thickness||null,this.opacity=e.opacity||null,this.paths=[],this.bezierPath2D=[],this.allRawPaths=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0,this._willKeepAspectRatio=!0}static initialize(e){z.AnnotationEditor.initialize(e)}static updateDefaultParams(e,n){switch(e){case A.AnnotationEditorParamsType.INK_THICKNESS:u._defaultThickness=n;break;case A.AnnotationEditorParamsType.INK_COLOR:u._defaultColor=n;break;case A.AnnotationEditorParamsType.INK_OPACITY:u._defaultOpacity=n/100;break}}updateParams(e,n){switch(e){case A.AnnotationEditorParamsType.INK_THICKNESS:this.#m(n);break;case A.AnnotationEditorParamsType.INK_COLOR:this.#b(n);break;case A.AnnotationEditorParamsType.INK_OPACITY:this.#A(n);break}}static get defaultPropertiesToUpdate(){return[[A.AnnotationEditorParamsType.INK_THICKNESS,u._defaultThickness],[A.AnnotationEditorParamsType.INK_COLOR,u._defaultColor||z.AnnotationEditor._defaultLineColor],[A.AnnotationEditorParamsType.INK_OPACITY,Math.round(u._defaultOpacity*100)]]}get propertiesToUpdate(){return[[A.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||u._defaultThickness],[A.AnnotationEditorParamsType.INK_COLOR,this.color||u._defaultColor||z.AnnotationEditor._defaultLineColor],[A.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*(this.opacity??u._defaultOpacity))]]}#m(e){const n=this.thickness;this.addCommands({cmd:()=>{this.thickness=e,this.#k()},undo:()=>{this.thickness=n,this.#k()},mustExec:!0,type:A.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})}#b(e){const n=this.color;this.addCommands({cmd:()=>{this.color=e,this.#w()},undo:()=>{this.color=n,this.#w()},mustExec:!0,type:A.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})}#A(e){e/=100;const n=this.opacity;this.addCommands({cmd:()=>{this.opacity=e,this.#w()},undo:()=>{this.opacity=n,this.#w()},mustExec:!0,type:A.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.canvas||(this.#E(),this.#S()),this.isAttachedToDOM||(this.parent.add(this),this.#P()),this.#k()))}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,this.#o&&(clearTimeout(this.#o),this.#o=null),this.#u.disconnect(),this.#u=null,super.remove())}setParent(e){!this.parent&&e?this._uiManager.removeShouldRescale(this):this.parent&&e===null&&this._uiManager.addShouldRescale(this),super.setParent(e)}onScaleChanging(){const[e,n]=this.parentDimensions,c=this.width*e,b=this.height*n;this.setDimensions(c,b)}enableEditMode(){this.#h||this.canvas===null||(super.enableEditMode(),this._isDraggable=!1,this.canvas.addEventListener("pointerdown",this.#r))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this._isDraggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",this.#r))}onceAdded(){this._isDraggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}#y(){const{parentRotation:e,parentDimensions:[n,c]}=this;switch(e){case 90:return[0,c,c,n];case 180:return[n,c,n,c];case 270:return[n,0,c,n];default:return[0,0,n,c]}}#v(){const{ctx:e,color:n,opacity:c,thickness:b,parentScale:m,scaleFactor:R}=this;e.lineWidth=b*m/R,e.lineCap="round",e.lineJoin="round",e.miterLimit=10,e.strokeStyle=`${n}${(0,C.opacityToHex)(c)}`}#g(e,n){this.canvas.addEventListener("contextmenu",l.noContextMenu),this.canvas.addEventListener("pointerleave",this.#i),this.canvas.addEventListener("pointermove",this.#s),this.canvas.addEventListener("pointerup",this.#n),this.canvas.removeEventListener("pointerdown",this.#r),this.isEditing=!0,this.#f||(this.#f=!0,this.#P(),this.thickness||=u._defaultThickness,this.color||=u._defaultColor||z.AnnotationEditor._defaultLineColor,this.opacity??=u._defaultOpacity),this.currentPath.push([e,n]),this.#c=!1,this.#v(),this.#p=()=>{this.#I(),this.#p&&window.requestAnimationFrame(this.#p)},window.requestAnimationFrame(this.#p)}#C(e,n){const[c,b]=this.currentPath.at(-1);if(this.currentPath.length>1&&e===c&&n===b)return;const m=this.currentPath;let R=this.#l;if(m.push([e,n]),this.#c=!0,m.length<=2){R.moveTo(...m[0]),R.lineTo(e,n);return}m.length===3&&(this.#l=R=new Path2D,R.moveTo(...m[0])),this.#N(R,...m.at(-3),...m.at(-2),e,n)}#M(){if(this.currentPath.length===0)return;const e=this.currentPath.at(-1);this.#l.lineTo(...e)}#L(e,n){this.#p=null,e=Math.min(Math.max(e,0),this.canvas.width),n=Math.min(Math.max(n,0),this.canvas.height),this.#C(e,n),this.#M();let c;if(this.currentPath.length!==1)c=this.#O();else{const M=[e,n];c=[[M,M.slice(),M.slice(),M]]}const b=this.#l,m=this.currentPath;this.currentPath=[],this.#l=new Path2D;const R=()=>{this.allRawPaths.push(m),this.paths.push(c),this.bezierPath2D.push(b),this.rebuild()},E=()=>{this.allRawPaths.pop(),this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(this.#E(),this.#S()),this.#k())};this.addCommands({cmd:R,undo:E,mustExec:!0})}#I(){if(!this.#c)return;this.#c=!1;const e=Math.ceil(this.thickness*this.parentScale),n=this.currentPath.slice(-3),c=n.map(R=>R[0]),b=n.map(R=>R[1]);Math.min(...c)-e,Math.max(...c)+e,Math.min(...b)-e,Math.max(...b)+e;const{ctx:m}=this;m.save(),m.clearRect(0,0,this.canvas.width,this.canvas.height);for(const R of this.bezierPath2D)m.stroke(R);m.stroke(this.#l),m.restore()}#N(e,n,c,b,m,R,E){const M=(n+b)/2,V=(c+m)/2,G=(b+R)/2,_=(m+E)/2;e.bezierCurveTo(M+2*(b-M)/3,V+2*(m-V)/3,G+2*(b-G)/3,_+2*(m-_)/3,G,_)}#O(){const e=this.currentPath;if(e.length<=2)return[[e[0],e[0],e.at(-1),e.at(-1)]];const n=[];let c,[b,m]=e[0];for(c=1;c<e.length-2;c++){const[Y,tt]=e[c],[rt,j]=e[c+1],O=(Y+rt)/2,B=(tt+j)/2,q=[b+2*(Y-b)/3,m+2*(tt-m)/3],Q=[O+2*(Y-O)/3,B+2*(tt-B)/3];n.push([[b,m],q,Q,[O,B]]),[b,m]=[O,B]}const[R,E]=e[c],[M,V]=e[c+1],G=[b+2*(R-b)/3,m+2*(E-m)/3],_=[M+2*(R-M)/3,V+2*(E-V)/3];return n.push([[b,m],G,_,[M,V]]),n}#w(){if(this.isEmpty()){this.#T();return}this.#v();const{canvas:e,ctx:n}=this;n.setTransform(1,0,0,1,0,0),n.clearRect(0,0,e.width,e.height),this.#T();for(const c of this.bezierPath2D)n.stroke(c)}commit(){this.#h||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),this.#h=!0,this.div.classList.add("disabled"),this.#k(!0),this.select(),this.parent.addInkEditorIfNeeded(!0),this.moveInDOM(),this.div.focus({preventScroll:!0}))}focusin(e){this._focusEventsAllowed&&(super.focusin(e),this.enableEditMode())}canvasPointerdown(e){e.button!==0||!this.isInEditMode()||this.#h||(this.setInForeground(),e.preventDefault(),this.div.contains(document.activeElement)||this.div.focus({preventScroll:!0}),this.#g(e.offsetX,e.offsetY))}canvasPointermove(e){e.preventDefault(),this.#C(e.offsetX,e.offsetY)}canvasPointerup(e){e.preventDefault(),this.#D(e)}canvasPointerleave(e){this.#D(e)}#D(e){this.canvas.removeEventListener("pointerleave",this.#i),this.canvas.removeEventListener("pointermove",this.#s),this.canvas.removeEventListener("pointerup",this.#n),this.canvas.addEventListener("pointerdown",this.#r),this.#o&&clearTimeout(this.#o),this.#o=setTimeout(()=>{this.#o=null,this.canvas.removeEventListener("contextmenu",l.noContextMenu)},10),this.#L(e.offsetX,e.offsetY),this.addToAnnotationStorage(),this.setInBackground()}#E(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",this.canvas.setAttribute("data-l10n-id","pdfjs-ink-canvas"),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")}#S(){this.#u=new ResizeObserver(e=>{const n=e[0].contentRect;n.width&&n.height&&this.setDimensions(n.width,n.height)}),this.#u.observe(this.div)}get isResizable(){return!this.isEmpty()&&this.#h}render(){if(this.div)return this.div;let e,n;this.width&&(e=this.x,n=this.y),super.render(),this.div.setAttribute("data-l10n-id","pdfjs-ink");const[c,b,m,R]=this.#y();if(this.setAt(c,b,0,0),this.setDims(m,R),this.#E(),this.width){const[E,M]=this.parentDimensions;this.setAspectRatio(this.width*E,this.height*M),this.setAt(e*E,n*M,this.width*E,this.height*M),this.#f=!0,this.#P(),this.setDims(this.width*E,this.height*M),this.#w(),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return this.#S(),this.div}#P(){if(!this.#f)return;const[e,n]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*e),this.canvas.height=Math.ceil(this.height*n),this.#T()}setDimensions(e,n){const c=Math.round(e),b=Math.round(n);if(this.#d===c&&this.#a===b)return;this.#d=c,this.#a=b,this.canvas.style.visibility="hidden";const[m,R]=this.parentDimensions;this.width=e/m,this.height=n/R,this.fixAndSetPosition(),this.#h&&this.#B(e,n),this.#P(),this.#w(),this.canvas.style.visibility="visible",this.fixDims()}#B(e,n){const c=this.#H(),b=(e-c)/this.#e,m=(n-c)/this.#t;this.scaleFactor=Math.min(b,m)}#T(){const e=this.#H()/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+e,this.translationY*this.scaleFactor+e)}static#F(e){const n=new Path2D;for(let c=0,b=e.length;c<b;c++){const[m,R,E,M]=e[c];c===0&&n.moveTo(...m),n.bezierCurveTo(R[0],R[1],E[0],E[1],M[0],M[1])}return n}static#R(e,n,c){const[b,m,R,E]=n;switch(c){case 0:for(let M=0,V=e.length;M<V;M+=2)e[M]+=b,e[M+1]=E-e[M+1];break;case 90:for(let M=0,V=e.length;M<V;M+=2){const G=e[M];e[M]=e[M+1]+b,e[M+1]=G+m}break;case 180:for(let M=0,V=e.length;M<V;M+=2)e[M]=R-e[M],e[M+1]+=m;break;case 270:for(let M=0,V=e.length;M<V;M+=2){const G=e[M];e[M]=R-e[M+1],e[M+1]=E-G}break;default:throw new Error("Invalid rotation")}return e}static#V(e,n,c){const[b,m,R,E]=n;switch(c){case 0:for(let M=0,V=e.length;M<V;M+=2)e[M]-=b,e[M+1]=E-e[M+1];break;case 90:for(let M=0,V=e.length;M<V;M+=2){const G=e[M];e[M]=e[M+1]-m,e[M+1]=G-b}break;case 180:for(let M=0,V=e.length;M<V;M+=2)e[M]=R-e[M],e[M+1]-=m;break;case 270:for(let M=0,V=e.length;M<V;M+=2){const G=e[M];e[M]=E-e[M+1],e[M+1]=R-G}break;default:throw new Error("Invalid rotation")}return e}#X(e,n,c,b){const m=[],R=this.thickness/2,E=e*n+R,M=e*c+R;for(const V of this.paths){const G=[],_=[];for(let Y=0,tt=V.length;Y<tt;Y++){const[rt,j,O,B]=V[Y],q=e*rt[0]+E,Q=e*rt[1]+M,K=e*j[0]+E,ft=e*j[1]+M,ot=e*O[0]+E,at=e*O[1]+M,gt=e*B[0]+E,dt=e*B[1]+M;Y===0&&(G.push(q,Q),_.push(q,Q)),G.push(K,ft,ot,at,gt,dt),_.push(K,ft),Y===tt-1&&_.push(gt,dt)}m.push({bezier:u.#R(G,b,this.rotation),points:u.#R(_,b,this.rotation)})}return m}#z(){let e=1/0,n=-1/0,c=1/0,b=-1/0;for(const m of this.paths)for(const[R,E,M,V]of m){const G=A.Util.bezierBoundingBox(...R,...E,...M,...V);e=Math.min(e,G[0]),c=Math.min(c,G[1]),n=Math.max(n,G[2]),b=Math.max(b,G[3])}return[e,c,n,b]}#H(){return this.#h?Math.ceil(this.thickness*this.parentScale):0}#k(e=!1){if(this.isEmpty())return;if(!this.#h){this.#w();return}const n=this.#z(),c=this.#H();this.#e=Math.max(z.AnnotationEditor.MIN_SIZE,n[2]-n[0]),this.#t=Math.max(z.AnnotationEditor.MIN_SIZE,n[3]-n[1]);const b=Math.ceil(c+this.#e*this.scaleFactor),m=Math.ceil(c+this.#t*this.scaleFactor),[R,E]=this.parentDimensions;this.width=b/R,this.height=m/E,this.setAspectRatio(b,m);const M=this.translationX,V=this.translationY;this.translationX=-n[0],this.translationY=-n[1],this.#P(),this.#w(),this.#d=b,this.#a=m,this.setDims(b,m);const G=e?c/this.scaleFactor/2:0;this.translate(M-this.translationX-G,V-this.translationY-G)}static deserialize(e,n,c){if(e instanceof D.InkAnnotationElement)return null;const b=super.deserialize(e,n,c);b.thickness=e.thickness,b.color=A.Util.makeHexColor(...e.color),b.opacity=e.opacity;const[m,R]=b.pageDimensions,E=b.width*m,M=b.height*R,V=b.parentScale,G=e.thickness/2;b.#h=!0,b.#d=Math.round(E),b.#a=Math.round(M);const{paths:_,rect:Y,rotation:tt}=e;for(let{bezier:j}of _){j=u.#V(j,Y,tt);const O=[];b.paths.push(O);let B=V*(j[0]-G),q=V*(j[1]-G);for(let K=2,ft=j.length;K<ft;K+=6){const ot=V*(j[K]-G),at=V*(j[K+1]-G),gt=V*(j[K+2]-G),dt=V*(j[K+3]-G),ct=V*(j[K+4]-G),J=V*(j[K+5]-G);O.push([[B,q],[ot,at],[gt,dt],[ct,J]]),B=ct,q=J}const Q=this.#F(O);b.bezierPath2D.push(Q)}const rt=b.#z();return b.#e=Math.max(z.AnnotationEditor.MIN_SIZE,rt[2]-rt[0]),b.#t=Math.max(z.AnnotationEditor.MIN_SIZE,rt[3]-rt[1]),b.#B(E,M),b}serialize(){if(this.isEmpty())return null;const e=this.getRect(0,0),n=z.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:A.AnnotationEditorType.INK,color:n,thickness:this.thickness,opacity:this.opacity,paths:this.#X(this.scaleFactor/this.parentScale,this.translationX,this.translationY,e),pageIndex:this.pageIndex,rect:e,rotation:this.rotation,structTreeParentId:this._structTreeParentId}}}class g extends z.AnnotationEditor{#t=null;#e=null;#s=null;#i=null;#n=null;#r="";#o=null;#l=null;#h=null;#c=!1;#f=!1;static _type="stamp";static _editorType=A.AnnotationEditorType.STAMP;constructor(e){super({...e,name:"stampEditor"}),this.#i=e.bitmapUrl,this.#n=e.bitmapFile}static initialize(e){z.AnnotationEditor.initialize(e)}static get supportedTypes(){const e=["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"];return(0,A.shadow)(this,"supportedTypes",e.map(n=>`image/${n}`))}static get supportedTypesStr(){return(0,A.shadow)(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(e){return this.supportedTypes.includes(e)}static paste(e,n){n.pasteEditor(A.AnnotationEditorType.STAMP,{bitmapFile:e.getAsFile()})}#u(e,n=!1){if(!e){this.remove();return}this.#t=e.bitmap,n||(this.#e=e.id,this.#c=e.isSvg),e.file&&(this.#r=e.file.name),this.#p()}#d(){this.#s=null,this._uiManager.enableWaiting(!1),this.#o&&this.div.focus()}#a(){if(this.#e){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(this.#e).then(n=>this.#u(n,!0)).finally(()=>this.#d());return}if(this.#i){const n=this.#i;this.#i=null,this._uiManager.enableWaiting(!0),this.#s=this._uiManager.imageManager.getFromUrl(n).then(c=>this.#u(c)).finally(()=>this.#d());return}if(this.#n){const n=this.#n;this.#n=null,this._uiManager.enableWaiting(!0),this.#s=this._uiManager.imageManager.getFromFile(n).then(c=>this.#u(c)).finally(()=>this.#d());return}const e=document.createElement("input");e.type="file",e.accept=g.supportedTypesStr,this.#s=new Promise(n=>{e.addEventListener("change",async()=>{if(!e.files||e.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const c=await this._uiManager.imageManager.getFromFile(e.files[0]);this.#u(c)}n()}),e.addEventListener("cancel",()=>{this.remove(),n()})}).finally(()=>this.#d()),e.click()}remove(){this.#e&&(this.#t=null,this._uiManager.imageManager.deleteId(this.#e),this.#o?.remove(),this.#o=null,this.#l?.disconnect(),this.#l=null,this.#h&&(clearTimeout(this.#h),this.#h=null)),super.remove()}rebuild(){if(!this.parent){this.#e&&this.#a();return}super.rebuild(),this.div!==null&&(this.#e&&this.#a(),this.isAttachedToDOM||this.parent.add(this))}onceAdded(){this._isDraggable=!0,this.div.focus()}isEmpty(){return!(this.#s||this.#t||this.#i||this.#n)}get isResizable(){return!0}render(){if(this.div)return this.div;let e,n;if(this.width&&(e=this.x,n=this.y),super.render(),this.div.hidden=!0,this.#t?this.#p():this.#a(),this.width){const[c,b]=this.parentDimensions;this.setAt(e*c,n*b,this.width*c,this.height*b)}return this.div}#p(){const{div:e}=this;let{width:n,height:c}=this.#t;const[b,m]=this.pageDimensions,R=.75;if(this.width)n=this.width*b,c=this.height*m;else if(n>R*b||c>R*m){const G=Math.min(R*b/n,R*m/c);n*=G,c*=G}const[E,M]=this.parentDimensions;this.setDims(n*E/b,c*M/m),this._uiManager.enableWaiting(!1);const V=this.#o=document.createElement("canvas");e.append(V),e.hidden=!1,this.#A(n,c),this.#v(),this.#f||(this.parent.addUndoableEditor(this),this.#f=!0),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.editorType,data:{action:"inserted_image"}}}),this.addAltTextButton(),this.#r&&V.setAttribute("aria-label",this.#r)}#m(e,n){const[c,b]=this.parentDimensions;this.width=e/c,this.height=n/b,this.setDims(e,n),this._initialOptions?.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,this.#h!==null&&clearTimeout(this.#h);const m=200;this.#h=setTimeout(()=>{this.#h=null,this.#A(e,n)},m)}#b(e,n){const{width:c,height:b}=this.#t;let m=c,R=b,E=this.#t;for(;m>2*e||R>2*n;){const M=m,V=R;m>2*e&&(m=m>=16384?Math.floor(m/2)-1:Math.ceil(m/2)),R>2*n&&(R=R>=16384?Math.floor(R/2)-1:Math.ceil(R/2));const G=new OffscreenCanvas(m,R);G.getContext("2d").drawImage(E,0,0,M,V,0,0,m,R),E=G.transferToImageBitmap()}return E}#A(e,n){e=Math.ceil(e),n=Math.ceil(n);const c=this.#o;if(!c||c.width===e&&c.height===n)return;c.width=e,c.height=n;const b=this.#c?this.#t:this.#b(e,n),m=c.getContext("2d");m.filter=this._uiManager.hcmFilter,m.drawImage(b,0,0,b.width,b.height,0,0,e,n)}getImageForAltText(){return this.#o}#y(e){if(e){if(this.#c){const b=this._uiManager.imageManager.getSvgUrl(this.#e);if(b)return b}const n=document.createElement("canvas");return{width:n.width,height:n.height}=this.#t,n.getContext("2d").drawImage(this.#t,0,0),n.toDataURL()}if(this.#c){const[n,c]=this.pageDimensions,b=Math.round(this.width*n*l.PixelsPerInch.PDF_TO_CSS_UNITS),m=Math.round(this.height*c*l.PixelsPerInch.PDF_TO_CSS_UNITS),R=new OffscreenCanvas(b,m);return R.getContext("2d").drawImage(this.#t,0,0,this.#t.width,this.#t.height,0,0,b,m),R.transferToImageBitmap()}return structuredClone(this.#t)}#v(){this.#l=new ResizeObserver(e=>{const n=e[0].contentRect;n.width&&n.height&&this.#m(n.width,n.height)}),this.#l.observe(this.div)}static deserialize(e,n,c){if(e instanceof D.StampAnnotationElement)return null;const b=super.deserialize(e,n,c),{rect:m,bitmapUrl:R,bitmapId:E,isSvg:M,accessibilityData:V}=e;E&&c.imageManager.isValidId(E)?b.#e=E:b.#i=R,b.#c=M;const[G,_]=b.pageDimensions;return b.width=(m[2]-m[0])/G,b.height=(m[3]-m[1])/_,V&&(b.altTextData=V),b}serialize(e=!1,n=null){if(this.isEmpty())return null;const c={annotationType:A.AnnotationEditorType.STAMP,bitmapId:this.#e,pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:this.#c,structTreeParentId:this._structTreeParentId};if(e)return c.bitmapUrl=this.#y(!0),c.accessibilityData=this.altTextData,c;const{decorative:b,altText:m}=this.altTextData;if(!b&&m&&(c.accessibilityData={type:"Figure",alt:m}),n===null)return c;n.stamps||=new Map;const R=this.#c?(c.rect[2]-c.rect[0])*(c.rect[3]-c.rect[1]):null;if(!n.stamps.has(this.#e))n.stamps.set(this.#e,{area:R,serialized:c}),c.bitmap=this.#y(!1);else if(this.#c){const E=n.stamps.get(this.#e);R>E.area&&(E.area=R,E.serialized.bitmap.close(),E.serialized.bitmap=this.#y(!1))}return c}}class r{#t;#e=!1;#s=null;#i=this.pointerup.bind(this);#n=this.pointerUpAfterSelection.bind(this);#r=this.pointerdown.bind(this);#o=null;#l=this.selectionStart.bind(this);#h=new Map;#c=!1;#f=!1;#u=!1;#d=null;#a;static _initialized=!1;static#p=new Map([k,u,g,v].map(e=>[e._editorType,e]));constructor({uiManager:e,pageIndex:n,div:c,accessibilityManager:b,annotationLayer:m,drawLayer:R,textLayer:E,viewport:M,l10n:V}){const G=[...r.#p.values()];if(!r._initialized){r._initialized=!0;for(const _ of G)_.initialize(V)}e.registerEditorTypes(G),this.#a=e,this.pageIndex=n,this.div=c,this.#t=b,this.#s=m,this.viewport=M,this.#d=E,this.drawLayer=R,this.#a.addLayer(this)}get isEmpty(){return this.#h.size===0}updateToolbar(e){this.#a.updateToolbar(e)}updateMode(e=this.#a.getMode()){switch(this.#v(),e){case A.AnnotationEditorType.NONE:this.disableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;case A.AnnotationEditorType.INK:this.addInkEditorIfNeeded(!1),this.disableTextSelection(),this.togglePointerEvents(!0),this.disableClick();break;case A.AnnotationEditorType.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}if(e!==A.AnnotationEditorType.NONE){const{classList:n}=this.div;for(const c of r.#p.values())n.toggle(`${c._type}Editing`,e===c._editorType);this.div.hidden=!1}}addInkEditorIfNeeded(e){if(this.#a.getMode()!==A.AnnotationEditorType.INK)return;if(!e){for(const c of this.#h.values())if(c.isEmpty()){c.setInBackground();return}}this.#A({offsetX:0,offsetY:0},!1).setInBackground()}setEditingState(e){this.#a.setEditingState(e)}addCommands(e){this.#a.addCommands(e)}togglePointerEvents(e=!1){this.div.classList.toggle("disabled",!e)}enable(){this.togglePointerEvents(!0);const e=new Set;for(const c of this.#h.values())c.enableEditing(),c.annotationElementId&&e.add(c.annotationElementId);if(!this.#s)return;const n=this.#s.getEditableAnnotations();for(const c of n){if(c.hide(),this.#a.isDeletedAnnotationElement(c.data.id)||e.has(c.data.id))continue;const b=this.deserialize(c);b&&(this.addOrRebuild(b),b.enableEditing())}}disable(){this.#u=!0,this.togglePointerEvents(!1);const e=new Set;for(const c of this.#h.values()){if(c.disableEditing(),!c.annotationElementId||c.serialize()!==null){e.add(c.annotationElementId);continue}this.getEditableAnnotation(c.annotationElementId)?.show(),c.remove()}if(this.#s){const c=this.#s.getEditableAnnotations();for(const b of c){const{id:m}=b.data;e.has(m)||this.#a.isDeletedAnnotationElement(m)||b.show()}}this.#v(),this.isEmpty&&(this.div.hidden=!0);const{classList:n}=this.div;for(const c of r.#p.values())n.remove(`${c._type}Editing`);this.disableTextSelection(),this.#u=!1}getEditableAnnotation(e){return this.#s?.getEditableAnnotation(e)||null}setActiveEditor(e){this.#a.getActive()!==e&&this.#a.setActiveEditor(e)}enableTextSelection(){this.#d?.div&&document.addEventListener("selectstart",this.#l)}disableTextSelection(){this.#d?.div&&document.removeEventListener("selectstart",this.#l)}enableClick(){this.div.addEventListener("pointerdown",this.#r),this.div.addEventListener("pointerup",this.#i)}disableClick(){this.div.removeEventListener("pointerdown",this.#r),this.div.removeEventListener("pointerup",this.#i)}attach(e){this.#h.set(e.id,e);const{annotationElementId:n}=e;n&&this.#a.isDeletedAnnotationElement(n)&&this.#a.removeDeletedAnnotationElement(e)}detach(e){this.#h.delete(e.id),this.#t?.removePointerInTextLayer(e.contentDiv),!this.#u&&e.annotationElementId&&this.#a.addDeletedAnnotationElement(e)}remove(e){this.detach(e),this.#a.removeEditor(e),e.div.remove(),e.isAttachedToDOM=!1,this.#f||this.addInkEditorIfNeeded(!1)}changeParent(e){e.parent!==this&&(e.annotationElementId&&(this.#a.addDeletedAnnotationElement(e.annotationElementId),z.AnnotationEditor.deleteAnnotationElement(e),e.annotationElementId=null),this.attach(e),e.parent?.detach(e),e.setParent(this),e.div&&e.isAttachedToDOM&&(e.div.remove(),this.div.append(e.div)))}add(e){if(this.changeParent(e),this.#a.addEditor(e),this.attach(e),!e.isAttachedToDOM){const n=e.render();this.div.append(n),e.isAttachedToDOM=!0}e.fixAndSetPosition(),e.onceAdded(),this.#a.addToAnnotationStorage(e)}moveEditorInDOM(e){if(!e.isAttachedToDOM)return;const{activeElement:n}=document;e.div.contains(n)&&!this.#o&&(e._focusEventsAllowed=!1,this.#o=setTimeout(()=>{this.#o=null,e.div.contains(document.activeElement)?e._focusEventsAllowed=!0:(e.div.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0}),n.focus())},0)),e._structTreeParentId=this.#t?.moveElementInDOM(this.div,e.div,e.contentDiv,!0)}addOrRebuild(e){e.needsToBeRebuilt()?(e.parent||=this,e.rebuild()):this.add(e)}addUndoableEditor(e){const n=()=>e._uiManager.rebuild(e),c=()=>{e.remove()};this.addCommands({cmd:n,undo:c,mustExec:!1})}getNextId(){return this.#a.getId()}get#m(){return r.#p.get(this.#a.getMode())}#b(e){const n=this.#m;return n?new n.prototype.constructor(e):null}canCreateNewEmptyEditor(){return this.#m?.canCreateNewEmptyEditor()}pasteEditor(e,n){this.#a.updateToolbar(e),this.#a.updateMode(e);const{offsetX:c,offsetY:b}=this.#y(),m=this.getNextId(),R=this.#b({parent:this,id:m,x:c,y:b,uiManager:this.#a,isCentered:!0,...n});R&&this.add(R)}deserialize(e){return r.#p.get(e.annotationType??e.annotationEditorType)?.deserialize(e,this,this.#a)||null}#A(e,n,c={}){const b=this.getNextId(),m=this.#b({parent:this,id:b,x:e.offsetX,y:e.offsetY,uiManager:this.#a,isCentered:n,...c});return m&&this.add(m),m}#y(){const{x:e,y:n,width:c,height:b}=this.div.getBoundingClientRect(),m=Math.max(0,e),R=Math.max(0,n),E=Math.min(window.innerWidth,e+c),M=Math.min(window.innerHeight,n+b),V=(m+E)/2-e,G=(R+M)/2-n,[_,Y]=this.viewport.rotation%180===0?[V,G]:[G,V];return{offsetX:_,offsetY:Y}}addNewEditor(){this.#A(this.#y(),!0)}setSelected(e){this.#a.setSelected(e)}toggleSelected(e){this.#a.toggleSelected(e)}isSelected(e){return this.#a.isSelected(e)}unselect(e){this.#a.unselect(e)}selectionStart(e){this.#d?.div.addEventListener("pointerup",this.#n,{once:!0})}pointerUpAfterSelection(e){const n=document.getSelection();if(n.rangeCount===0)return;const c=n.getRangeAt(0);if(c.collapsed||!this.#d?.div.contains(c.commonAncestorContainer))return;const{x:b,y:m,width:R,height:E}=this.#d.div.getBoundingClientRect(),M=c.getClientRects();let V;switch(this.viewport.rotation){case 90:V=(_,Y,tt,rt)=>({x:(Y-m)/E,y:1-(_+tt-b)/R,width:rt/E,height:tt/R});break;case 180:V=(_,Y,tt,rt)=>({x:1-(_+tt-b)/R,y:1-(Y+rt-m)/E,width:tt/R,height:rt/E});break;case 270:V=(_,Y,tt,rt)=>({x:1-(Y+rt-m)/E,y:(_-b)/R,width:rt/E,height:tt/R});break;default:V=(_,Y,tt,rt)=>({x:(_-b)/R,y:(Y-m)/E,width:tt/R,height:rt/E});break}const G=[];for(const{x:_,y:Y,width:tt,height:rt}of M)tt===0||rt===0||G.push(V(_,Y,tt,rt));G.length!==0&&this.#A(e,!1,{boxes:G}),n.empty()}pointerup(e){const{isMac:n}=A.FeatureTest.platform;if(!(e.button!==0||e.ctrlKey&&n)&&e.target===this.div&&this.#c){if(this.#c=!1,!this.#e){this.#e=!0;return}if(this.#a.getMode()===A.AnnotationEditorType.STAMP){this.#a.unselectAll();return}this.#A(e,!1)}}pointerdown(e){if(this.#a.getMode()===A.AnnotationEditorType.HIGHLIGHT&&this.enableTextSelection(),this.#c){this.#c=!1;return}const{isMac:n}=A.FeatureTest.platform;if(e.button!==0||e.ctrlKey&&n||e.target!==this.div)return;this.#c=!0;const c=this.#a.getActive();this.#e=!c||c.isEmpty()}findNewParent(e,n,c){const b=this.#a.findParent(n,c);return b===null||b===this?!1:(b.changeParent(e),!0)}destroy(){this.#a.getActive()?.parent===this&&(this.#a.commitOrRemove(),this.#a.setActiveEditor(null)),this.#o&&(clearTimeout(this.#o),this.#o=null);for(const e of this.#h.values())this.#t?.removePointerInTextLayer(e.contentDiv),e.setParent(null),e.isAttachedToDOM=!1,e.div.remove();this.div=null,this.#h.clear(),this.#a.removeLayer(this)}#v(){this.#f=!0;for(const e of this.#h.values())e.isEmpty()&&e.remove();this.#f=!1}render({viewport:e}){this.viewport=e,(0,l.setLayerDimensions)(this.div,e);for(const n of this.#a.getEditors(this.pageIndex))this.add(n);this.updateMode()}update({viewport:e}){this.#a.commitOrRemove();const n=this.viewport.rotation,c=e.rotation;if(this.viewport=e,(0,l.setLayerDimensions)(this.div,{rotation:c}),n!==c)for(const b of this.#h.values())b.rotate(c);this.updateMode()}get pageDimensions(){const{pageWidth:e,pageHeight:n}=this.viewport.rawDims;return[e,n]}}},97:(ht,Z,U)=>{U.d(Z,{ColorPicker:()=>D});var A=U(266),z=U(812),C=U(473);class D{#t=this.#u.bind(this);#e=null;#s=null;#i;#n=null;#r=!1;#o=!1;#l;#h=null;static get _keyboardManager(){return(0,A.shadow)(this,"_keyboardManager",new z.KeyboardManager([[["Escape","mac+Escape"],D.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],D.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],D.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],D.prototype._moveToPrevious],[["Home","mac+Home"],D.prototype._moveToBeginning],[["End","mac+End"],D.prototype._moveToEnd]]))}constructor({editor:P=null,uiManager:y=null}){this.#o=!P,this.#h=P?._uiManager||y,this.#l=this.#h._eventBus,this.#i=P?.color||this.#h?.highlightColors.values().next().value||"#FFFF98"}renderButton(){const P=this.#e=document.createElement("button");P.className="colorPicker",P.tabIndex="0",P.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),P.setAttribute("aria-haspopup",!0),P.addEventListener("click",this.#d.bind(this));const y=this.#s=document.createElement("span");return y.className="swatch",y.style.backgroundColor=this.#i,P.append(y),P}renderMainDropdown(){const P=this.#n=this.#c(A.AnnotationEditorParamsType.HIGHLIGHT_DEFAULT_COLOR);return P.setAttribute("aria-orientation","horizontal"),P.setAttribute("aria-labelledby","highlightColorPickerLabel"),P}#c(P){const y=document.createElement("div");y.addEventListener("contextmenu",C.noContextMenu),y.className="dropdown",y.role="listbox",y.setAttribute("aria-multiselectable",!1),y.setAttribute("aria-orientation","vertical"),y.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown");for(const[v,l]of this.#h.highlightColors){const u=document.createElement("button");u.tabIndex="0",u.role="option",u.setAttribute("data-color",l),u.title=v,u.setAttribute("data-l10n-id",`pdfjs-editor-colorpicker-${v}`);const g=document.createElement("span");u.append(g),g.className="swatch",g.style.backgroundColor=l,u.setAttribute("aria-selected",l===this.#i),u.addEventListener("click",this.#f.bind(this,P,l)),y.append(u)}return y.addEventListener("keydown",this.#t),y}#f(P,y,v){v.stopPropagation(),this.#l.dispatch("switchannotationeditorparams",{source:this,type:P,value:y})}_colorSelectFromKeyboard(P){const y=P.target.getAttribute("data-color");y&&this.#f(y,P)}_moveToNext(P){if(P.target===this.#e){this.#n.firstChild?.focus();return}P.target.nextSibling?.focus()}_moveToPrevious(P){P.target.previousSibling?.focus()}_moveToBeginning(){this.#n.firstChild?.focus()}_moveToEnd(){this.#n.lastChild?.focus()}#u(P){D._keyboardManager.exec(this,P)}#d(P){if(this.#n&&!this.#n.classList.contains("hidden")){this.hideDropdown();return}if(this.#e.addEventListener("keydown",this.#t),this.#r=P.detail===0,this.#n){this.#n.classList.remove("hidden");return}const y=this.#n=this.#c(A.AnnotationEditorParamsType.HIGHLIGHT_COLOR);this.#e.append(y)}hideDropdown(){this.#n?.classList.add("hidden")}_hideDropdownFromKeyboard(){this.#o||!this.#n||this.#n.classList.contains("hidden")||(this.hideDropdown(),this.#e.removeEventListener("keydown",this.#t),this.#e.focus({preventScroll:!0,focusVisible:this.#r}))}updateColor(P){if(this.#s&&(this.#s.style.backgroundColor=P),!this.#n)return;const y=this.#h.highlightColors.values();for(const v of this.#n.children)v.setAttribute("aria-selected",y.next().value===P)}destroy(){this.#e?.remove(),this.#e=null,this.#s=null,this.#n?.remove(),this.#n=null}}},115:(ht,Z,U)=>{U.d(Z,{AnnotationEditor:()=>P});var A=U(812),z=U(266),C=U(473);class D{#t="";#e=!1;#s=null;#i=null;#n=null;#r=!1;#o=null;static _l10nPromise=null;constructor(l){this.#o=l}static initialize(l){D._l10nPromise||=l}async render(){const l=this.#s=document.createElement("button");l.className="altText";const u=await D._l10nPromise.get("pdfjs-editor-alt-text-button-label");l.textContent=u,l.setAttribute("aria-label",u),l.tabIndex="0",l.addEventListener("contextmenu",C.noContextMenu),l.addEventListener("pointerdown",r=>r.stopPropagation());const g=r=>{r.preventDefault(),this.#o._uiManager.editAltText(this.#o)};return l.addEventListener("click",g,{capture:!0}),l.addEventListener("keydown",r=>{r.target===l&&r.key==="Enter"&&(this.#r=!0,g(r))}),await this.#l(),l}finish(){this.#s&&(this.#s.focus({focusVisible:this.#r}),this.#r=!1)}get data(){return{altText:this.#t,decorative:this.#e}}set data({altText:l,decorative:u}){this.#t===l&&this.#e===u||(this.#t=l,this.#e=u,this.#l())}toggle(l=!1){this.#s&&(!l&&this.#n&&(clearTimeout(this.#n),this.#n=null),this.#s.disabled=!l)}destroy(){this.#s?.remove(),this.#s=null,this.#i=null}async#l(){const l=this.#s;if(!l)return;if(!this.#t&&!this.#e){l.classList.remove("done"),this.#i?.remove();return}l.classList.add("done"),D._l10nPromise.get("pdfjs-editor-alt-text-edit-button-label").then(r=>{l.setAttribute("aria-label",r)});let u=this.#i;if(!u){this.#i=u=document.createElement("span"),u.className="tooltip",u.setAttribute("role","tooltip");const r=u.id=`alt-text-tooltip-${this.#o.id}`;l.setAttribute("aria-describedby",r);const p=100;l.addEventListener("mouseenter",()=>{this.#n=setTimeout(()=>{this.#n=null,this.#i.classList.add("show"),this.#o._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.#o.editorType,data:{action:"alt_text_tooltip"}}})},p)}),l.addEventListener("mouseleave",()=>{this.#n&&(clearTimeout(this.#n),this.#n=null),this.#i?.classList.remove("show")})}u.innerText=this.#e?await D._l10nPromise.get("pdfjs-editor-alt-text-decorative-tooltip"):this.#t,u.parentNode||l.append(u),this.#o.getImageForAltText()?.setAttribute("aria-describedby",u.id)}}class k{#t=null;#e=null;#s;#i=null;constructor(l){this.#s=l}render(){const l=this.#t=document.createElement("div");l.className="editToolbar",l.addEventListener("contextmenu",C.noContextMenu),l.addEventListener("pointerdown",k.#n);const u=this.#i=document.createElement("div");u.className="buttons",l.append(u);const g=this.#s.toolbarPosition;if(g){const{style:r}=l,p=this.#s._uiManager.direction==="ltr"?1-g[0]:g[0];r.insetInlineEnd=`${100*p}%`,r.top=`calc(${100*g[1]}% + var(--editor-toolbar-vert-offset))`}return this.#h(),l}static#n(l){l.stopPropagation()}#r(l){this.#s._focusEventsAllowed=!1,l.preventDefault(),l.stopPropagation()}#o(l){this.#s._focusEventsAllowed=!0,l.preventDefault(),l.stopPropagation()}#l(l){l.addEventListener("focusin",this.#r.bind(this),{capture:!0}),l.addEventListener("focusout",this.#o.bind(this),{capture:!0}),l.addEventListener("contextmenu",C.noContextMenu)}hide(){this.#t.classList.add("hidden"),this.#e?.hideDropdown()}show(){this.#t.classList.remove("hidden")}#h(){const l=document.createElement("button");l.className="delete",l.tabIndex=0,l.setAttribute("data-l10n-id",`pdfjs-editor-remove-${this.#s.editorType}-button`),this.#l(l),l.addEventListener("click",u=>{this.#s._uiManager.delete()}),this.#i.append(l)}get#c(){const l=document.createElement("div");return l.className="divider",l}addAltTextButton(l){this.#l(l),this.#i.prepend(l,this.#c)}addColorPicker(l){this.#e=l;const u=l.renderButton();this.#l(u),this.#i.prepend(u,this.#c)}remove(){this.#t.remove(),this.#e?.destroy(),this.#e=null}}class P{#t=null;#e=null;#s=!1;#i=null;#n=null;#r=this.focusin.bind(this);#o=this.focusout.bind(this);#l=null;#h="";#c=!1;#f=!1;#u=!1;#d=!1;#a=null;_initialOptions=Object.create(null);_uiManager=null;_focusEventsAllowed=!0;_l10nPromise=null;#p=!1;#m=P._zIndex++;static _borderLineWidth=-1;static _colorManager=new A.ColorManager;static _zIndex=1;static get _resizerKeyboardManager(){const l=P.prototype._resizeWithKeyboard,u=A.AnnotationEditorUIManager.TRANSLATE_SMALL,g=A.AnnotationEditorUIManager.TRANSLATE_BIG;return(0,z.shadow)(this,"_resizerKeyboardManager",new A.KeyboardManager([[["ArrowLeft","mac+ArrowLeft"],l,{args:[-u,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],l,{args:[-g,0]}],[["ArrowRight","mac+ArrowRight"],l,{args:[u,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],l,{args:[g,0]}],[["ArrowUp","mac+ArrowUp"],l,{args:[0,-u]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],l,{args:[0,-g]}],[["ArrowDown","mac+ArrowDown"],l,{args:[0,u]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],l,{args:[0,g]}],[["Escape","mac+Escape"],P.prototype._stopResizingWithKeyboard]]))}constructor(l){this.constructor===P&&(0,z.unreachable)("Cannot initialize AnnotationEditor."),this.parent=l.parent,this.id=l.id,this.width=this.height=null,this.pageIndex=l.parent.pageIndex,this.name=l.name,this.div=null,this._uiManager=l.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=l.isCentered,this._structTreeParentId=null;const{rotation:u,rawDims:{pageWidth:g,pageHeight:r,pageX:p,pageY:e}}=this.parent.viewport;this.rotation=u,this.pageRotation=(360+u-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[g,r],this.pageTranslation=[p,e];const[n,c]=this.parentDimensions;this.x=l.x/n,this.y=l.y/c,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get _defaultLineColor(){return(0,z.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(l){const u=new y({id:l.parent.getNextId(),parent:l.parent,uiManager:l._uiManager});u.annotationElementId=l.annotationElementId,u.deleted=!0,u._uiManager.addToAnnotationStorage(u)}static initialize(l,u=null){if(P._l10nPromise||=new Map(["pdfjs-editor-alt-text-button-label","pdfjs-editor-alt-text-edit-button-label","pdfjs-editor-alt-text-decorative-tooltip","pdfjs-editor-resizer-label-topLeft","pdfjs-editor-resizer-label-topMiddle","pdfjs-editor-resizer-label-topRight","pdfjs-editor-resizer-label-middleRight","pdfjs-editor-resizer-label-bottomRight","pdfjs-editor-resizer-label-bottomMiddle","pdfjs-editor-resizer-label-bottomLeft","pdfjs-editor-resizer-label-middleLeft"].map(r=>[r,l.get(r.replaceAll(/([A-Z])/g,p=>`-${p.toLowerCase()}`))])),u?.strings)for(const r of u.strings)P._l10nPromise.set(r,l.get(r));if(P._borderLineWidth!==-1)return;const g=getComputedStyle(document.documentElement);P._borderLineWidth=parseFloat(g.getPropertyValue("--outline-width"))||0}static updateDefaultParams(l,u){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(l){return!1}static paste(l,u){(0,z.unreachable)("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return this.#p}set _isDraggable(l){this.#p=l,this.div?.classList.toggle("draggable",l)}get isEnterHandled(){return!0}center(){const[l,u]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*u/(l*2),this.y+=this.width*l/(u*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*u/(l*2),this.y-=this.width*l/(u*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(l){this._uiManager.addCommands(l)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=this.#m}setParent(l){l!==null?(this.pageIndex=l.pageIndex,this.pageDimensions=l.pageDimensions):this.#S(),this.parent=l}focusin(l){this._focusEventsAllowed&&(this.#c?this.#c=!1:this.parent.setSelected(this))}focusout(l){!this._focusEventsAllowed||!this.isAttachedToDOM||l.relatedTarget?.closest(`#${this.id}`)||(l.preventDefault(),this.parent?.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(l,u,g,r){const[p,e]=this.parentDimensions;[g,r]=this.screenToPageTranslation(g,r),this.x=(l+g)/p,this.y=(u+r)/e,this.fixAndSetPosition()}#b([l,u],g,r){[g,r]=this.screenToPageTranslation(g,r),this.x+=g/l,this.y+=r/u,this.fixAndSetPosition()}translate(l,u){this.#b(this.parentDimensions,l,u)}translateInPage(l,u){this.#b(this.pageDimensions,l,u),this.div.scrollIntoView({block:"nearest"})}drag(l,u){const[g,r]=this.parentDimensions;if(this.x+=l/g,this.y+=u/r,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:b,y:m}=this.div.getBoundingClientRect();this.parent.findNewParent(this,b,m)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:p,y:e}=this;const[n,c]=this.#A();p+=n,e+=c,this.div.style.left=`${(100*p).toFixed(2)}%`,this.div.style.top=`${(100*e).toFixed(2)}%`,this.div.scrollIntoView({block:"nearest"})}#A(){const[l,u]=this.parentDimensions,{_borderLineWidth:g}=P,r=g/l,p=g/u;switch(this.rotation){case 90:return[-r,p];case 180:return[r,p];case 270:return[r,-p];default:return[-r,-p]}}fixAndSetPosition(l=this.rotation){const[u,g]=this.pageDimensions;let{x:r,y:p,width:e,height:n}=this;switch(e*=u,n*=g,r*=u,p*=g,l){case 0:r=Math.max(0,Math.min(u-e,r)),p=Math.max(0,Math.min(g-n,p));break;case 90:r=Math.max(0,Math.min(u-n,r)),p=Math.min(g,Math.max(e,p));break;case 180:r=Math.min(u,Math.max(e,r)),p=Math.min(g,Math.max(n,p));break;case 270:r=Math.min(u,Math.max(n,r)),p=Math.max(0,Math.min(g-e,p));break}this.x=r/=u,this.y=p/=g;const[c,b]=this.#A();r+=c,p+=b;const{style:m}=this.div;m.left=`${(100*r).toFixed(2)}%`,m.top=`${(100*p).toFixed(2)}%`,this.moveInDOM()}static#y(l,u,g){switch(g){case 90:return[u,-l];case 180:return[-l,-u];case 270:return[-u,l];default:return[l,u]}}screenToPageTranslation(l,u){return P.#y(l,u,this.parentRotation)}pageTranslationToScreen(l,u){return P.#y(l,u,360-this.parentRotation)}#v(l){switch(l){case 90:{const[u,g]=this.pageDimensions;return[0,-u/g,g/u,0]}case 180:return[-1,0,0,-1];case 270:{const[u,g]=this.pageDimensions;return[0,u/g,-g/u,0]}default:return[1,0,0,1]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:l,pageDimensions:[u,g]}=this,r=u*l,p=g*l;return z.FeatureTest.isCSSRoundSupported?[Math.round(r),Math.round(p)]:[r,p]}setDims(l,u){const[g,r]=this.parentDimensions;this.div.style.width=`${(100*l/g).toFixed(2)}%`,this.#s||(this.div.style.height=`${(100*u/r).toFixed(2)}%`)}fixDims(){const{style:l}=this.div,{height:u,width:g}=l,r=g.endsWith("%"),p=!this.#s&&u.endsWith("%");if(r&&p)return;const[e,n]=this.parentDimensions;r||(l.width=`${(100*parseFloat(g)/e).toFixed(2)}%`),!this.#s&&!p&&(l.height=`${(100*parseFloat(u)/n).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}#g(){if(this.#i)return;this.#i=document.createElement("div"),this.#i.classList.add("resizers");const l=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"];for(const u of l){const g=document.createElement("div");this.#i.append(g),g.classList.add("resizer",u),g.setAttribute("data-resizer-name",u),g.addEventListener("pointerdown",this.#C.bind(this,u)),g.addEventListener("contextmenu",C.noContextMenu),g.tabIndex=-1}this.div.prepend(this.#i)}#C(l,u){u.preventDefault();const{isMac:g}=z.FeatureTest.platform;if(u.button!==0||u.ctrlKey&&g)return;this.#e?.toggle(!1);const r=this.#L.bind(this,l),p=this._isDraggable;this._isDraggable=!1;const e={passive:!0,capture:!0};this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",r,e);const n=this.x,c=this.y,b=this.width,m=this.height,R=this.parent.div.style.cursor,E=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(u.target).cursor;const M=()=>{this.parent.togglePointerEvents(!0),this.#e?.toggle(!0),this._isDraggable=p,window.removeEventListener("pointerup",M),window.removeEventListener("blur",M),window.removeEventListener("pointermove",r,e),this.parent.div.style.cursor=R,this.div.style.cursor=E,this.#M(n,c,b,m)};window.addEventListener("pointerup",M),window.addEventListener("blur",M)}#M(l,u,g,r){const p=this.x,e=this.y,n=this.width,c=this.height;p===l&&e===u&&n===g&&c===r||this.addCommands({cmd:()=>{this.width=n,this.height=c,this.x=p,this.y=e;const[b,m]=this.parentDimensions;this.setDims(b*n,m*c),this.fixAndSetPosition()},undo:()=>{this.width=g,this.height=r,this.x=l,this.y=u;const[b,m]=this.parentDimensions;this.setDims(b*g,m*r),this.fixAndSetPosition()},mustExec:!0})}#L(l,u){const[g,r]=this.parentDimensions,p=this.x,e=this.y,n=this.width,c=this.height,b=P.MIN_SIZE/g,m=P.MIN_SIZE/r,R=d=>Math.round(d*1e4)/1e4,E=this.#v(this.rotation),M=(d,o)=>[E[0]*d+E[2]*o,E[1]*d+E[3]*o],V=this.#v(360-this.rotation),G=(d,o)=>[V[0]*d+V[2]*o,V[1]*d+V[3]*o];let _,Y,tt=!1,rt=!1;switch(l){case"topLeft":tt=!0,_=(d,o)=>[0,0],Y=(d,o)=>[d,o];break;case"topMiddle":_=(d,o)=>[d/2,0],Y=(d,o)=>[d/2,o];break;case"topRight":tt=!0,_=(d,o)=>[d,0],Y=(d,o)=>[0,o];break;case"middleRight":rt=!0,_=(d,o)=>[d,o/2],Y=(d,o)=>[0,o/2];break;case"bottomRight":tt=!0,_=(d,o)=>[d,o],Y=(d,o)=>[0,0];break;case"bottomMiddle":_=(d,o)=>[d/2,o],Y=(d,o)=>[d/2,0];break;case"bottomLeft":tt=!0,_=(d,o)=>[0,o],Y=(d,o)=>[d,0];break;case"middleLeft":rt=!0,_=(d,o)=>[0,o/2],Y=(d,o)=>[d,o/2];break}const j=_(n,c),O=Y(n,c);let B=M(...O);const q=R(p+B[0]),Q=R(e+B[1]);let K=1,ft=1,[ot,at]=this.screenToPageTranslation(u.movementX,u.movementY);if([ot,at]=G(ot/g,at/r),tt){const d=Math.hypot(n,c);K=ft=Math.max(Math.min(Math.hypot(O[0]-j[0]-ot,O[1]-j[1]-at)/d,1/n,1/c),b/n,m/c)}else rt?K=Math.max(b,Math.min(1,Math.abs(O[0]-j[0]-ot)))/n:ft=Math.max(m,Math.min(1,Math.abs(O[1]-j[1]-at)))/c;const gt=R(n*K),dt=R(c*ft);B=M(...Y(gt,dt));const ct=q-B[0],J=Q-B[1];this.width=gt,this.height=dt,this.x=ct,this.y=J,this.setDims(g*gt,r*dt),this.fixAndSetPosition()}altTextFinish(){this.#e?.finish()}async addEditToolbar(){return this.#l||this.#u?this.#l:(this.#l=new k(this),this.div.append(this.#l.render()),this.#e&&this.#l.addAltTextButton(await this.#e.render()),this.#l)}removeEditToolbar(){this.#l&&(this.#l.remove(),this.#l=null,this.#e?.destroy())}getClientDimensions(){return this.div.getBoundingClientRect()}async addAltTextButton(){this.#e||(D.initialize(P._l10nPromise),this.#e=new D(this),await this.addEditToolbar())}get altTextData(){return this.#e?.data}set altTextData(l){this.#e&&(this.#e.data=l)}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.setAttribute("tabIndex",0),this.setInForeground(),this.div.addEventListener("focusin",this.#r),this.div.addEventListener("focusout",this.#o);const[l,u]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*u/l).toFixed(2)}%`,this.div.style.maxHeight=`${(100*l/u).toFixed(2)}%`);const[g,r]=this.getInitialTranslation();return this.translate(g,r),(0,A.bindEvents)(this,this.div,["pointerdown"]),this.div}pointerdown(l){const{isMac:u}=z.FeatureTest.platform;if(l.button!==0||l.ctrlKey&&u){l.preventDefault();return}if(this.#c=!0,this._isDraggable){this.#N(l);return}this.#I(l)}#I(l){const{isMac:u}=z.FeatureTest.platform;l.ctrlKey&&!u||l.shiftKey||l.metaKey&&u?this.parent.toggleSelected(this):this.parent.setSelected(this)}#N(l){const u=this._uiManager.isSelected(this);this._uiManager.setUpDragSession();let g,r;u&&(g={passive:!0,capture:!0},r=e=>{const[n,c]=this.screenToPageTranslation(e.movementX,e.movementY);this._uiManager.dragSelectedEditors(n,c)},window.addEventListener("pointermove",r,g));const p=()=>{window.removeEventListener("pointerup",p),window.removeEventListener("blur",p),u&&window.removeEventListener("pointermove",r,g),this.#c=!1,this._uiManager.endDragSession()||this.#I(l)};window.addEventListener("pointerup",p),window.addEventListener("blur",p)}moveInDOM(){this.#a&&clearTimeout(this.#a),this.#a=setTimeout(()=>{this.#a=null,this.parent?.moveEditorInDOM(this)},0)}_setParentAndPosition(l,u,g){l.changeParent(this),this.x=u,this.y=g,this.fixAndSetPosition()}getRect(l,u,g=this.rotation){const r=this.parentScale,[p,e]=this.pageDimensions,[n,c]=this.pageTranslation,b=l/r,m=u/r,R=this.x*p,E=this.y*e,M=this.width*p,V=this.height*e;switch(g){case 0:return[R+b+n,e-E-m-V+c,R+b+M+n,e-E-m+c];case 90:return[R+m+n,e-E+b+c,R+m+V+n,e-E+b+M+c];case 180:return[R-b-M+n,e-E+m+c,R-b+n,e-E+m+V+c];case 270:return[R-m-V+n,e-E-b-M+c,R-m+n,e-E-b+c];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(l,u){const[g,r,p,e]=l,n=p-g,c=e-r;switch(this.rotation){case 0:return[g,u-e,n,c];case 90:return[g,u-r,c,n];case 180:return[p,u-r,n,c];case 270:return[p,u-e,c,n];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){this.#u=!0}disableEditMode(){this.#u=!1}isInEditMode(){return this.#u}shouldGetKeyboardEvents(){return this.#d}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){this.div?.addEventListener("focusin",this.#r),this.div?.addEventListener("focusout",this.#o)}rotate(l){}serialize(l=!1,u=null){(0,z.unreachable)("An editor must be serializable")}static deserialize(l,u,g){const r=new this.prototype.constructor({parent:u,id:u.getNextId(),uiManager:g});r.rotation=l.rotation;const[p,e]=r.pageDimensions,[n,c,b,m]=r.getRectInCurrentCoords(l.rect,e);return r.x=n/p,r.y=c/e,r.width=b/p,r.height=m/e,r}remove(){this.div.removeEventListener("focusin",this.#r),this.div.removeEventListener("focusout",this.#o),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),this.#a&&(clearTimeout(this.#a),this.#a=null),this.#S(),this.removeEditToolbar()}get isResizable(){return!1}makeResizable(){this.isResizable&&(this.#g(),this.#i.classList.remove("hidden"),(0,A.bindEvents)(this,this.div,["keydown"]))}get toolbarPosition(){return null}keydown(l){if(!this.isResizable||l.target!==this.div||l.key!=="Enter")return;this._uiManager.setSelected(this),this.#n={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const u=this.#i.children;if(!this.#t){this.#t=Array.from(u);const e=this.#O.bind(this),n=this.#w.bind(this);for(const c of this.#t){const b=c.getAttribute("data-resizer-name");c.setAttribute("role","spinbutton"),c.addEventListener("keydown",e),c.addEventListener("blur",n),c.addEventListener("focus",this.#D.bind(this,b)),P._l10nPromise.get(`pdfjs-editor-resizer-label-${b}`).then(m=>c.setAttribute("aria-label",m))}}const g=this.#t[0];let r=0;for(const e of u){if(e===g)break;r++}const p=(360-this.rotation+this.parentRotation)%360/90*(this.#t.length/4);if(p!==r){if(p<r)for(let n=0;n<r-p;n++)this.#i.append(this.#i.firstChild);else if(p>r)for(let n=0;n<p-r;n++)this.#i.firstChild.before(this.#i.lastChild);let e=0;for(const n of u){const b=this.#t[e++].getAttribute("data-resizer-name");P._l10nPromise.get(`pdfjs-editor-resizer-label-${b}`).then(m=>n.setAttribute("aria-label",m))}}this.#E(0),this.#d=!0,this.#i.firstChild.focus({focusVisible:!0}),l.preventDefault(),l.stopImmediatePropagation()}#O(l){P._resizerKeyboardManager.exec(this,l)}#w(l){this.#d&&l.relatedTarget?.parentNode!==this.#i&&this.#S()}#D(l){this.#h=this.#d?l:""}#E(l){if(this.#t)for(const u of this.#t)u.tabIndex=l}_resizeWithKeyboard(l,u){this.#d&&this.#L(this.#h,{movementX:l,movementY:u})}#S(){if(this.#d=!1,this.#E(-1),this.#n){const{savedX:l,savedY:u,savedWidth:g,savedHeight:r}=this.#n;this.#M(l,u,g,r),this.#n=null}}_stopResizingWithKeyboard(){this.#S(),this.div.focus()}select(){if(this.makeResizable(),this.div?.classList.add("selectedEditor"),!this.#l){this.addEditToolbar().then(()=>{this.div?.classList.contains("selectedEditor")&&this.#l?.show()});return}this.#l?.show()}unselect(){this.#i?.classList.add("hidden"),this.div?.classList.remove("selectedEditor"),this.div?.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus(),this.#l?.hide()}updateParams(l,u){}disableEditing(){}enableEditing(){}enterInEditMode(){}getImageForAltText(){return null}get contentDiv(){return this.div}get isEditing(){return this.#f}set isEditing(l){this.#f=l,this.parent&&(l?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(l,u){this.#s=!0;const g=l/u,{style:r}=this.div;r.aspectRatio=g,r.height="auto"}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}}class y extends P{constructor(l){super(l),this.annotationElementId=l.annotationElementId,this.deleted=!0}serialize(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex}}}},405:(ht,Z,U)=>{U.d(Z,{Outliner:()=>A});class A{#t;#e=[];#s=[];constructor(C,D=0,k=0,P=!0){let y=1/0,v=-1/0,l=1/0,u=-1/0;const r=10**-4;for(const{x:R,y:E,width:M,height:V}of C){const G=Math.floor((R-D)/r)*r,_=Math.ceil((R+M+D)/r)*r,Y=Math.floor((E-D)/r)*r,tt=Math.ceil((E+V+D)/r)*r,rt=[G,Y,tt,!0],j=[_,Y,tt,!1];this.#e.push(rt,j),y=Math.min(y,G),v=Math.max(v,_),l=Math.min(l,Y),u=Math.max(u,tt)}const p=v-y+2*k,e=u-l+2*k,n=y-k,c=l-k,b=this.#e.at(P?-1:-2),m=[b[0],b[2]];for(const R of this.#e){const[E,M,V]=R;R[0]=(E-n)/p,R[1]=(M-c)/e,R[2]=(V-c)/e}this.#t={x:n,y:c,width:p,height:e,lastPoint:m}}getOutlines(){this.#e.sort((D,k)=>D[0]-k[0]||D[1]-k[1]||D[2]-k[2]);const C=[];for(const D of this.#e)D[3]?(C.push(...this.#l(D)),this.#r(D)):(this.#o(D),C.push(...this.#l(D)));return this.#i(C)}#i(C){const D=[],k=new Set;for(const v of C){const[l,u,g]=v;D.push([l,u,v],[l,g,v])}D.sort((v,l)=>v[1]-l[1]||v[0]-l[0]);for(let v=0,l=D.length;v<l;v+=2){const u=D[v][2],g=D[v+1][2];u.push(g),g.push(u),k.add(u),k.add(g)}const P=[];let y;for(;k.size>0;){const v=k.values().next().value;let[l,u,g,r,p]=v;k.delete(v);let e=l,n=u;for(y=[l,g],P.push(y);;){let c;if(k.has(r))c=r;else if(k.has(p))c=p;else break;k.delete(c),[l,u,g,r,p]=c,e!==l&&(y.push(e,n,l,n===u?u:g),e=l),n=n===u?g:u}y.push(e,n)}return{outlines:P,box:this.#t}}#n(C){const D=this.#s;let k=0,P=D.length-1;for(;k<=P;){const y=k+P>>1,v=D[y][0];if(v===C)return y;v<C?k=y+1:P=y-1}return P+1}#r([,C,D]){const k=this.#n(C);this.#s.splice(k,0,[C,D])}#o([,C,D]){const k=this.#n(C);for(let P=k;P<this.#s.length;P++){const[y,v]=this.#s[P];if(y!==C)break;if(y===C&&v===D){this.#s.splice(P,1);return}}for(let P=k-1;P>=0;P--){const[y,v]=this.#s[P];if(y!==C)break;if(y===C&&v===D){this.#s.splice(P,1);return}}}#l(C){const[D,k,P]=C,y=[[D,k,P]],v=this.#n(P);for(let l=0;l<v;l++){const[u,g]=this.#s[l];for(let r=0,p=y.length;r<p;r++){const[,e,n]=y[r];if(!(g<=e||n<=u)){if(e>=u){if(n>g)y[r][1]=g;else{if(p===1)return[];y.splice(r,1),r--,p--}continue}y[r][2]=u,n>g&&y.push([D,g,n])}}}return y}}},812:(ht,Z,U)=>{U.d(Z,{AnnotationEditorUIManager:()=>u,ColorManager:()=>l,KeyboardManager:()=>v,bindEvents:()=>C,opacityToHex:()=>D});var A=U(266),z=U(473);function C(g,r,p){for(const e of p)r.addEventListener(e,g[e].bind(g))}function D(g){return Math.round(Math.min(255,Math.max(1,255*g))).toString(16).padStart(2,"0")}class k{#t=0;getId(){return`${A.AnnotationEditorPrefix}${this.#t++}`}}class P{#t=(0,A.getUuid)();#e=0;#s=null;static get _isSVGFittingCanvas(){const r='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',e=new OffscreenCanvas(1,3).getContext("2d"),n=new Image;n.src=r;const c=n.decode().then(()=>(e.drawImage(n,0,0,1,1,0,0,1,3),new Uint32Array(e.getImageData(0,0,1,1).data.buffer)[0]===0));return(0,A.shadow)(this,"_isSVGFittingCanvas",c)}async#i(r,p){this.#s||=new Map;let e=this.#s.get(r);if(e===null)return null;if(e?.bitmap)return e.refCounter+=1,e;try{e||={bitmap:null,id:`image_${this.#t}_${this.#e++}`,refCounter:0,isSvg:!1};let n;if(typeof p=="string"?(e.url=p,n=await(0,z.fetchData)(p,"blob")):n=e.file=p,n.type==="image/svg+xml"){const c=P._isSVGFittingCanvas,b=new FileReader,m=new Image,R=new Promise((E,M)=>{m.onload=()=>{e.bitmap=m,e.isSvg=!0,E()},b.onload=async()=>{const V=e.svgUrl=b.result;m.src=await c?`${V}#svgView(preserveAspectRatio(none))`:V},m.onerror=b.onerror=M});b.readAsDataURL(n),await R}else e.bitmap=await createImageBitmap(n);e.refCounter=1}catch(n){console.error(n),e=null}return this.#s.set(r,e),e&&this.#s.set(e.id,e),e}async getFromFile(r){const{lastModified:p,name:e,size:n,type:c}=r;return this.#i(`${p}_${e}_${n}_${c}`,r)}async getFromUrl(r){return this.#i(r,r)}async getFromId(r){this.#s||=new Map;const p=this.#s.get(r);return p?p.bitmap?(p.refCounter+=1,p):p.file?this.getFromFile(p.file):this.getFromUrl(p.url):null}getSvgUrl(r){const p=this.#s.get(r);return p?.isSvg?p.svgUrl:null}deleteId(r){this.#s||=new Map;const p=this.#s.get(r);p&&(p.refCounter-=1,p.refCounter===0&&(p.bitmap=null))}isValidId(r){return r.startsWith(`image_${this.#t}_`)}}class y{#t=[];#e=!1;#s;#i=-1;constructor(r=128){this.#s=r}add({cmd:r,undo:p,mustExec:e,type:n=NaN,overwriteIfSameType:c=!1,keepUndo:b=!1}){if(e&&r(),this.#e)return;const m={cmd:r,undo:p,type:n};if(this.#i===-1){this.#t.length>0&&(this.#t.length=0),this.#i=0,this.#t.push(m);return}if(c&&this.#t[this.#i].type===n){b&&(m.undo=this.#t[this.#i].undo),this.#t[this.#i]=m;return}const R=this.#i+1;R===this.#s?this.#t.splice(0,1):(this.#i=R,R<this.#t.length&&this.#t.splice(R)),this.#t.push(m)}undo(){this.#i!==-1&&(this.#e=!0,this.#t[this.#i].undo(),this.#e=!1,this.#i-=1)}redo(){this.#i<this.#t.length-1&&(this.#i+=1,this.#e=!0,this.#t[this.#i].cmd(),this.#e=!1)}hasSomethingToUndo(){return this.#i!==-1}hasSomethingToRedo(){return this.#i<this.#t.length-1}destroy(){this.#t=null}}class v{constructor(r){this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:p}=A.FeatureTest.platform;for(const[e,n,c={}]of r)for(const b of e){const m=b.startsWith("mac+");p&&m?(this.callbacks.set(b.slice(4),{callback:n,options:c}),this.allKeys.add(b.split("+").at(-1))):!p&&!m&&(this.callbacks.set(b,{callback:n,options:c}),this.allKeys.add(b.split("+").at(-1)))}}#t(r){r.altKey&&this.buffer.push("alt"),r.ctrlKey&&this.buffer.push("ctrl"),r.metaKey&&this.buffer.push("meta"),r.shiftKey&&this.buffer.push("shift"),this.buffer.push(r.key);const p=this.buffer.join("+");return this.buffer.length=0,p}exec(r,p){if(!this.allKeys.has(p.key))return;const e=this.callbacks.get(this.#t(p));if(!e)return;const{callback:n,options:{bubbles:c=!1,args:b=[],checker:m=null}}=e;m&&!m(r,p)||(n.bind(r,...b,p)(),c||(p.stopPropagation(),p.preventDefault()))}}class l{static _colorsMapping=new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]);get _colors(){const r=new Map([["CanvasText",null],["Canvas",null]]);return(0,z.getColorValues)(r),(0,A.shadow)(this,"_colors",r)}convert(r){const p=(0,z.getRGB)(r);if(!window.matchMedia("(forced-colors: active)").matches)return p;for(const[e,n]of this._colors)if(n.every((c,b)=>c===p[b]))return l._colorsMapping.get(e);return p}getHexCode(r){const p=this._colors.get(r);return p?A.Util.makeHexColor(...p):r}}class u{#t=null;#e=new Map;#s=new Map;#i=null;#n=null;#r=new y;#o=0;#l=new Set;#h=null;#c=null;#f=new Set;#u=null;#d=null;#a=null;#p=new k;#m=!1;#b=!1;#A=null;#y=null;#v=A.AnnotationEditorType.NONE;#g=new Set;#C=null;#M=this.blur.bind(this);#L=this.focus.bind(this);#I=this.copy.bind(this);#N=this.cut.bind(this);#O=this.paste.bind(this);#w=this.keydown.bind(this);#D=this.onEditingAction.bind(this);#E=this.onPageChanging.bind(this);#S=this.onScaleChanging.bind(this);#P=this.onRotationChanging.bind(this);#B={isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1};#T=[0,0];#F=null;#R=null;#V=null;static TRANSLATE_SMALL=1;static TRANSLATE_BIG=10;static get _keyboardManager(){const r=u.prototype,p=b=>b.#R.contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&b.hasSomethingToControl(),e=(b,{target:m})=>{if(m instanceof HTMLInputElement){const{type:R}=m;return R!=="text"&&R!=="number"}return!0},n=this.TRANSLATE_SMALL,c=this.TRANSLATE_BIG;return(0,A.shadow)(this,"_keyboardManager",new v([[["ctrl+a","mac+meta+a"],r.selectAll,{checker:e}],[["ctrl+z","mac+meta+z"],r.undo,{checker:e}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],r.redo,{checker:e}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],r.delete,{checker:e}],[["Enter","mac+Enter"],r.addNewEditorFromKeyboard,{checker:(b,{target:m})=>!(m instanceof HTMLButtonElement)&&b.#R.contains(m)&&!b.isEnterHandled}],[[" ","mac+ "],r.addNewEditorFromKeyboard,{checker:b=>b.#R.contains(document.activeElement)}],[["Escape","mac+Escape"],r.unselectAll],[["ArrowLeft","mac+ArrowLeft"],r.translateSelectedEditors,{args:[-n,0],checker:p}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],r.translateSelectedEditors,{args:[-c,0],checker:p}],[["ArrowRight","mac+ArrowRight"],r.translateSelectedEditors,{args:[n,0],checker:p}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],r.translateSelectedEditors,{args:[c,0],checker:p}],[["ArrowUp","mac+ArrowUp"],r.translateSelectedEditors,{args:[0,-n],checker:p}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],r.translateSelectedEditors,{args:[0,-c],checker:p}],[["ArrowDown","mac+ArrowDown"],r.translateSelectedEditors,{args:[0,n],checker:p}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],r.translateSelectedEditors,{args:[0,c],checker:p}]]))}constructor(r,p,e,n,c,b,m){this.#R=r,this.#V=p,this.#i=e,this._eventBus=n,this._eventBus._on("editingaction",this.#D),this._eventBus._on("pagechanging",this.#E),this._eventBus._on("scalechanging",this.#S),this._eventBus._on("rotationchanging",this.#P),this.#n=c.annotationStorage,this.#u=c.filterFactory,this.#C=b,this.#a=m||null,this.viewParameters={realScale:z.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:0}}destroy(){this.#k(),this.#z(),this._eventBus._off("editingaction",this.#D),this._eventBus._off("pagechanging",this.#E),this._eventBus._off("scalechanging",this.#S),this._eventBus._off("rotationchanging",this.#P);for(const r of this.#s.values())r.destroy();this.#s.clear(),this.#e.clear(),this.#f.clear(),this.#t=null,this.#g.clear(),this.#r.destroy(),this.#i?.destroy(),this.#d&&(clearTimeout(this.#d),this.#d=null),this.#F&&(clearTimeout(this.#F),this.#F=null)}get hcmFilter(){return(0,A.shadow)(this,"hcmFilter",this.#C?this.#u.addHCMFilter(this.#C.foreground,this.#C.background):"none")}get direction(){return(0,A.shadow)(this,"direction",getComputedStyle(this.#R).direction)}get highlightColors(){return(0,A.shadow)(this,"highlightColors",this.#a?new Map(this.#a.split(",").map(r=>r.split("=").map(p=>p.trim()))):null)}setMainHighlightColorPicker(r){this.#y=r}editAltText(r){this.#i?.editAltText(this,r)}onPageChanging({pageNumber:r}){this.#o=r-1}focusMainContainer(){this.#R.focus()}findParent(r,p){for(const e of this.#s.values()){const{x:n,y:c,width:b,height:m}=e.div.getBoundingClientRect();if(r>=n&&r<=n+b&&p>=c&&p<=c+m)return e}return null}disableUserSelect(r=!1){this.#V.classList.toggle("noUserSelect",r)}addShouldRescale(r){this.#f.add(r)}removeShouldRescale(r){this.#f.delete(r)}onScaleChanging({scale:r}){this.commitOrRemove(),this.viewParameters.realScale=r*z.PixelsPerInch.PDF_TO_CSS_UNITS;for(const p of this.#f)p.onScaleChanging()}onRotationChanging({pagesRotation:r}){this.commitOrRemove(),this.viewParameters.rotation=r}addToAnnotationStorage(r){!r.isEmpty()&&this.#n&&!this.#n.has(r.id)&&this.#n.setValue(r.id,r)}#X(){window.addEventListener("focus",this.#L),window.addEventListener("blur",this.#M)}#z(){window.removeEventListener("focus",this.#L),window.removeEventListener("blur",this.#M)}blur(){if(!this.hasSelection)return;const{activeElement:r}=document;for(const p of this.#g)if(p.div.contains(r)){this.#A=[p,r],p._focusEventsAllowed=!1;break}}focus(){if(!this.#A)return;const[r,p]=this.#A;this.#A=null,p.addEventListener("focusin",()=>{r._focusEventsAllowed=!0},{once:!0}),p.focus()}#H(){window.addEventListener("keydown",this.#w)}#k(){window.removeEventListener("keydown",this.#w)}#_(){document.addEventListener("copy",this.#I),document.addEventListener("cut",this.#N),document.addEventListener("paste",this.#O)}#$(){document.removeEventListener("copy",this.#I),document.removeEventListener("cut",this.#N),document.removeEventListener("paste",this.#O)}addEditListeners(){this.#H(),this.#_()}removeEditListeners(){this.#k(),this.#$()}copy(r){if(r.preventDefault(),this.#t?.commitOrRemove(),!this.hasSelection)return;const p=[];for(const e of this.#g){const n=e.serialize(!0);n&&p.push(n)}p.length!==0&&r.clipboardData.setData("application/pdfjs",JSON.stringify(p))}cut(r){this.copy(r),this.delete()}paste(r){r.preventDefault();const{clipboardData:p}=r;for(const c of p.items)for(const b of this.#c)if(b.isHandlingMimeForPasting(c.type)){b.paste(c,this.currentLayer);return}let e=p.getData("application/pdfjs");if(!e)return;try{e=JSON.parse(e)}catch(c){(0,A.warn)(`paste: "${c.message}".`);return}if(!Array.isArray(e))return;this.unselectAll();const n=this.currentLayer;try{const c=[];for(const R of e){const E=n.deserialize(R);if(!E)return;c.push(E)}const b=()=>{for(const R of c)this.#Y(R);this.#j(c)},m=()=>{for(const R of c)R.remove()};this.addCommands({cmd:b,undo:m,mustExec:!0})}catch(c){(0,A.warn)(`paste: "${c.message}".`)}}keydown(r){this.isEditorHandlingKeyboard||u._keyboardManager.exec(this,r)}onEditingAction(r){["undo","redo","delete","selectAll"].includes(r.name)&&this[r.name]()}#x(r){Object.entries(r).some(([e,n])=>this.#B[e]!==n)&&this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(this.#B,r)})}#G(r){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:r})}setEditingState(r){r?(this.#X(),this.#H(),this.#_(),this.#x({isEditing:this.#v!==A.AnnotationEditorType.NONE,isEmpty:this.#U(),hasSomethingToUndo:this.#r.hasSomethingToUndo(),hasSomethingToRedo:this.#r.hasSomethingToRedo(),hasSelectedEditor:!1})):(this.#z(),this.#k(),this.#$(),this.#x({isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(r){if(!this.#c){this.#c=r;for(const p of this.#c)this.#G(p.defaultPropertiesToUpdate)}}getId(){return this.#p.getId()}get currentLayer(){return this.#s.get(this.#o)}getLayer(r){return this.#s.get(r)}get currentPageIndex(){return this.#o}addLayer(r){this.#s.set(r.pageIndex,r),this.#m?r.enable():r.disable()}removeLayer(r){this.#s.delete(r.pageIndex)}updateMode(r,p=null,e=!1){if(this.#v!==r){if(this.#v=r,r===A.AnnotationEditorType.NONE){this.setEditingState(!1),this.#W();return}this.setEditingState(!0),this.#q(),this.unselectAll();for(const n of this.#s.values())n.updateMode(r);if(!p&&e){this.addNewEditorFromKeyboard();return}if(p){for(const n of this.#e.values())if(n.annotationElementId===p){this.setSelected(n),n.enterInEditMode();break}}}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(r){r!==this.#v&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:r})}updateParams(r,p){if(this.#c){switch(r){case A.AnnotationEditorParamsType.CREATE:this.currentLayer.addNewEditor();return;case A.AnnotationEditorParamsType.HIGHLIGHT_DEFAULT_COLOR:this.#y?.updateColor(p);break}for(const e of this.#g)e.updateParams(r,p);for(const e of this.#c)e.updateDefaultParams(r,p)}}enableWaiting(r=!1){if(this.#b!==r){this.#b=r;for(const p of this.#s.values())r?p.disableClick():p.enableClick(),p.div.classList.toggle("waiting",r)}}#q(){if(!this.#m){this.#m=!0;for(const r of this.#s.values())r.enable()}}#W(){if(this.unselectAll(),this.#m){this.#m=!1;for(const r of this.#s.values())r.disable()}}getEditors(r){const p=[];for(const e of this.#e.values())e.pageIndex===r&&p.push(e);return p}getEditor(r){return this.#e.get(r)}addEditor(r){this.#e.set(r.id,r)}removeEditor(r){r.div.contains(document.activeElement)&&(this.#d&&clearTimeout(this.#d),this.#d=setTimeout(()=>{this.focusMainContainer(),this.#d=null},0)),this.#e.delete(r.id),this.unselect(r),(!r.annotationElementId||!this.#l.has(r.annotationElementId))&&this.#n?.remove(r.id)}addDeletedAnnotationElement(r){this.#l.add(r.annotationElementId),r.deleted=!0}isDeletedAnnotationElement(r){return this.#l.has(r)}removeDeletedAnnotationElement(r){this.#l.delete(r.annotationElementId),r.deleted=!1}#Y(r){const p=this.#s.get(r.pageIndex);p?p.addOrRebuild(r):this.addEditor(r)}setActiveEditor(r){this.#t!==r&&(this.#t=r,r&&this.#G(r.propertiesToUpdate))}toggleSelected(r){if(this.#g.has(r)){this.#g.delete(r),r.unselect(),this.#x({hasSelectedEditor:this.hasSelection});return}this.#g.add(r),r.select(),this.#G(r.propertiesToUpdate),this.#x({hasSelectedEditor:!0})}setSelected(r){for(const p of this.#g)p!==r&&p.unselect();this.#g.clear(),this.#g.add(r),r.select(),this.#G(r.propertiesToUpdate),this.#x({hasSelectedEditor:!0})}isSelected(r){return this.#g.has(r)}get firstSelectedEditor(){return this.#g.values().next().value}unselect(r){r.unselect(),this.#g.delete(r),this.#x({hasSelectedEditor:this.hasSelection})}get hasSelection(){return this.#g.size!==0}get isEnterHandled(){return this.#g.size===1&&this.firstSelectedEditor.isEnterHandled}undo(){this.#r.undo(),this.#x({hasSomethingToUndo:this.#r.hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:this.#U()})}redo(){this.#r.redo(),this.#x({hasSomethingToUndo:!0,hasSomethingToRedo:this.#r.hasSomethingToRedo(),isEmpty:this.#U()})}addCommands(r){this.#r.add(r),this.#x({hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:this.#U()})}#U(){if(this.#e.size===0)return!0;if(this.#e.size===1)for(const r of this.#e.values())return r.isEmpty();return!1}delete(){if(this.commitOrRemove(),!this.hasSelection)return;const r=[...this.#g],p=()=>{for(const n of r)n.remove()},e=()=>{for(const n of r)this.#Y(n)};this.addCommands({cmd:p,undo:e,mustExec:!0})}commitOrRemove(){this.#t?.commitOrRemove()}hasSomethingToControl(){return this.#t||this.hasSelection}#j(r){this.#g.clear();for(const p of r)p.isEmpty()||(this.#g.add(p),p.select());this.#x({hasSelectedEditor:!0})}selectAll(){for(const r of this.#g)r.commit();this.#j(this.#e.values())}unselectAll(){if(!(this.#t&&(this.#t.commitOrRemove(),this.#v!==A.AnnotationEditorType.NONE))&&this.hasSelection){for(const r of this.#g)r.unselect();this.#g.clear(),this.#x({hasSelectedEditor:!1})}}translateSelectedEditors(r,p,e=!1){if(e||this.commitOrRemove(),!this.hasSelection)return;this.#T[0]+=r,this.#T[1]+=p;const[n,c]=this.#T,b=[...this.#g],m=1e3;this.#F&&clearTimeout(this.#F),this.#F=setTimeout(()=>{this.#F=null,this.#T[0]=this.#T[1]=0,this.addCommands({cmd:()=>{for(const R of b)this.#e.has(R.id)&&R.translateInPage(n,c)},undo:()=>{for(const R of b)this.#e.has(R.id)&&R.translateInPage(-n,-c)},mustExec:!1})},m);for(const R of b)R.translateInPage(r,p)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),this.#h=new Map;for(const r of this.#g)this.#h.set(r,{savedX:r.x,savedY:r.y,savedPageIndex:r.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!this.#h)return!1;this.disableUserSelect(!1);const r=this.#h;this.#h=null;let p=!1;for(const[{x:n,y:c,pageIndex:b},m]of r)m.newX=n,m.newY=c,m.newPageIndex=b,p||=n!==m.savedX||c!==m.savedY||b!==m.savedPageIndex;if(!p)return!1;const e=(n,c,b,m)=>{if(this.#e.has(n.id)){const R=this.#s.get(m);R?n._setParentAndPosition(R,c,b):(n.pageIndex=m,n.x=c,n.y=b)}};return this.addCommands({cmd:()=>{for(const[n,{newX:c,newY:b,newPageIndex:m}]of r)e(n,c,b,m)},undo:()=>{for(const[n,{savedX:c,savedY:b,savedPageIndex:m}]of r)e(n,c,b,m)},mustExec:!0}),!0}dragSelectedEditors(r,p){if(this.#h)for(const e of this.#h.keys())e.drag(r,p)}rebuild(r){if(r.parent===null){const p=this.getLayer(r.pageIndex);p?(p.changeParent(r),p.addOrRebuild(r)):(this.addEditor(r),this.addToAnnotationStorage(r),r.rebuild())}else r.parent.addOrRebuild(r)}get isEditorHandlingKeyboard(){return this.getActive()?.shouldGetKeyboardEvents()||this.#g.size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(r){return this.#t===r}getActive(){return this.#t}getMode(){return this.#v}get imageManager(){return(0,A.shadow)(this,"imageManager",new P)}}},171:(ht,Z,U)=>{U.d(Z,{PDFFetchStream:()=>P});var A=U(266),z=U(253);function C(l,u,g){return{method:"GET",headers:l,signal:g.signal,mode:"cors",credentials:u?"include":"same-origin",redirect:"follow"}}function D(l){const u=new Headers;for(const g in l){const r=l[g];r!==void 0&&u.append(g,r)}return u}function k(l){return l instanceof Uint8Array?l.buffer:l instanceof ArrayBuffer?l:((0,A.warn)(`getArrayBuffer - unexpected data format: ${l}`),new Uint8Array(l).buffer)}class P{constructor(u){this.source=u,this.isHttp=/^https?:/i.test(u.url),this.httpHeaders=this.isHttp&&u.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return(0,A.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new y(this),this._fullRequestReader}getRangeReader(u,g){if(g<=this._progressiveDataLength)return null;const r=new v(this,u,g);return this._rangeRequestReaders.push(r),r}cancelAllRequests(u){this._fullRequestReader?.cancel(u);for(const g of this._rangeRequestReaders.slice(0))g.cancel(u)}}class y{constructor(u){this._stream=u,this._reader=null,this._loaded=0,this._filename=null;const g=u.source;this._withCredentials=g.withCredentials||!1,this._contentLength=g.length,this._headersCapability=new A.PromiseCapability,this._disableRange=g.disableRange||!1,this._rangeChunkSize=g.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!g.disableStream,this._isRangeSupported=!g.disableRange,this._headers=D(this._stream.httpHeaders);const r=g.url;fetch(r,C(this._headers,this._withCredentials,this._abortController)).then(p=>{if(!(0,z.validateResponseStatus)(p.status))throw(0,z.createResponseStatusError)(p.status,r);this._reader=p.body.getReader(),this._headersCapability.resolve();const e=b=>p.headers.get(b),{allowRangeRequests:n,suggestedLength:c}=(0,z.validateRangeRequestCapabilities)({getResponseHeader:e,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=n,this._contentLength=c||this._contentLength,this._filename=(0,z.extractFilenameFromHeader)(e),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new A.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:u,done:g}=await this._reader.read();return g?{value:u,done:g}:(this._loaded+=u.byteLength,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:k(u),done:!1})}cancel(u){this._reader?.cancel(u),this._abortController.abort()}}class v{constructor(u,g,r){this._stream=u,this._reader=null,this._loaded=0;const p=u.source;this._withCredentials=p.withCredentials||!1,this._readCapability=new A.PromiseCapability,this._isStreamingSupported=!p.disableStream,this._abortController=new AbortController,this._headers=D(this._stream.httpHeaders),this._headers.append("Range",`bytes=${g}-${r-1}`);const e=p.url;fetch(e,C(this._headers,this._withCredentials,this._abortController)).then(n=>{if(!(0,z.validateResponseStatus)(n.status))throw(0,z.createResponseStatusError)(n.status,e);this._readCapability.resolve(),this._reader=n.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:u,done:g}=await this._reader.read();return g?{value:u,done:g}:(this._loaded+=u.byteLength,this.onProgress?.({loaded:this._loaded}),{value:k(u),done:!1})}cancel(u){this._reader?.cancel(u),this._abortController.abort()}}},742:(ht,Z,U)=>{U.d(Z,{FontFaceObject:()=>C,FontLoader:()=>z});var A=U(266);class z{#t=new Set;constructor({ownerDocument:k=globalThis.document,styleElement:P=null}){this._document=k,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(k){this.nativeFontFaces.add(k),this._document.fonts.add(k)}removeNativeFontFace(k){this.nativeFontFaces.delete(k),this._document.fonts.delete(k)}insertRule(k){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const P=this.styleElement.sheet;P.insertRule(k,P.cssRules.length)}clear(){for(const k of this.nativeFontFaces)this._document.fonts.delete(k);this.nativeFontFaces.clear(),this.#t.clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:k,_inspectFont:P}){if(!(!k||this.#t.has(k.loadedName))){if((0,A.assert)(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:y,src:v,style:l}=k,u=new FontFace(y,v,l);this.addNativeFontFace(u);try{await u.load(),this.#t.add(y),P?.(k)}catch{(0,A.warn)(`Cannot load system font: ${k.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(u)}return}(0,A.unreachable)("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(k){if(k.attached||k.missingFile&&!k.systemFontInfo)return;if(k.attached=!0,k.systemFontInfo){await this.loadSystemFont(k);return}if(this.isFontLoadingAPISupported){const y=k.createNativeFontFace();if(y){this.addNativeFontFace(y);try{await y.loaded}catch(v){throw(0,A.warn)(`Failed to load font '${y.family}': '${v}'.`),k.disableFontFace=!0,v}}return}const P=k.createFontFaceRule();if(P){if(this.insertRule(P),this.isSyncFontLoadingSupported)return;await new Promise(y=>{const v=this._queueLoadingCallback(y);this._prepareFontLoadEvent(k,v)})}}get isFontLoadingAPISupported(){const k=!!this._document?.fonts;return(0,A.shadow)(this,"isFontLoadingAPISupported",k)}get isSyncFontLoadingSupported(){let k=!1;return(A.isNodeJS||typeof navigator<"u"&&typeof navigator?.userAgent=="string"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(k=!0),(0,A.shadow)(this,"isSyncFontLoadingSupported",k)}_queueLoadingCallback(k){function P(){for((0,A.assert)(!v.done,"completeRequest() cannot be called twice."),v.done=!0;y.length>0&&y[0].done;){const l=y.shift();setTimeout(l.callback,0)}}const{loadingRequests:y}=this,v={done:!1,complete:P,callback:k};return y.push(v),v}get _loadTestFont(){const k=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return(0,A.shadow)(this,"_loadTestFont",k)}_prepareFontLoadEvent(k,P){function y(_,Y){return _.charCodeAt(Y)<<24|_.charCodeAt(Y+1)<<16|_.charCodeAt(Y+2)<<8|_.charCodeAt(Y+3)&255}function v(_,Y,tt,rt){const j=_.substring(0,Y),O=_.substring(Y+tt);return j+rt+O}let l,u;const g=this._document.createElement("canvas");g.width=1,g.height=1;const r=g.getContext("2d");let p=0;function e(_,Y){if(++p>30){(0,A.warn)("Load test font never loaded."),Y();return}if(r.font="30px "+_,r.fillText(".",0,20),r.getImageData(0,0,1,1).data[3]>0){Y();return}setTimeout(e.bind(null,_,Y))}const n=`lt${Date.now()}${this.loadTestFontId++}`;let c=this._loadTestFont;c=v(c,976,n.length,n);const m=16,R=1482184792;let E=y(c,m);for(l=0,u=n.length-3;l<u;l+=4)E=E-R+y(n,l)|0;l<n.length&&(E=E-R+y(n+"XXX",l)|0),c=v(c,m,4,(0,A.string32)(E));const M=`url(data:font/opentype;base64,${btoa(c)});`,V=`@font-face {font-family:"${n}";src:${M}}`;this.insertRule(V);const G=this._document.createElement("div");G.style.visibility="hidden",G.style.width=G.style.height="10px",G.style.position="absolute",G.style.top=G.style.left="0px";for(const _ of[k.loadedName,n]){const Y=this._document.createElement("span");Y.textContent="Hi",Y.style.fontFamily=_,G.append(Y)}this._document.body.append(G),e(n,()=>{G.remove(),P.complete()})}}class C{constructor(k,{isEvalSupported:P=!0,disableFontFace:y=!1,ignoreErrors:v=!1,inspectFont:l=null}){this.compiledGlyphs=Object.create(null);for(const u in k)this[u]=k[u];this.isEvalSupported=P!==!1,this.disableFontFace=y===!0,this.ignoreErrors=v===!0,this._inspectFont=l}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let k;if(!this.cssFontInfo)k=new FontFace(this.loadedName,this.data,{});else{const P={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(P.style=`oblique ${this.cssFontInfo.italicAngle}deg`),k=new FontFace(this.cssFontInfo.fontFamily,this.data,P)}return this._inspectFont?.(this),k}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const k=(0,A.bytesToString)(this.data),P=`url(data:${this.mimetype};base64,${btoa(k)});`;let y;if(!this.cssFontInfo)y=`@font-face {font-family:"${this.loadedName}";src:${P}}`;else{let v=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(v+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),y=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${v}src:${P}}`}return this._inspectFont?.(this,P),y}getPathGenerator(k,P){if(this.compiledGlyphs[P]!==void 0)return this.compiledGlyphs[P];let y;try{y=k.get(this.loadedName+"_path_"+P)}catch(v){if(!this.ignoreErrors)throw v;return(0,A.warn)(`getPathGenerator - ignoring character: "${v}".`),this.compiledGlyphs[P]=function(l,u){}}if(this.isEvalSupported&&A.FeatureTest.isEvalSupported){const v=[];for(const l of y){const u=l.args!==void 0?l.args.join(","):"";v.push("c.",l.cmd,"(",u,`);
`)}return this.compiledGlyphs[P]=new Function("c","size",v.join(""))}return this.compiledGlyphs[P]=function(v,l){for(const u of y)u.cmd==="scale"&&(u.args=[l,-l]),v[u.cmd].apply(v,u.args)}}}},472:(ht,Z,U)=>{U.d(Z,{Metadata:()=>z});var A=U(266);class z{#t;#e;constructor({parsedData:D,rawData:k}){this.#t=D,this.#e=k}getRaw(){return this.#e}get(D){return this.#t.get(D)??null}getAll(){return(0,A.objectFromMap)(this.#t)}has(D){return this.#t.has(D)}}},474:(ht,Z,U)=>{U.d(Z,{PDFNetworkStream:()=>y});var A=U(266),z=U(253);const C=200,D=206;function k(u){const g=u.response;return typeof g!="string"?g:(0,A.stringToBytes)(g).buffer}class P{constructor(g,r={}){this.url=g,this.isHttp=/^https?:/i.test(g),this.httpHeaders=this.isHttp&&r.httpHeaders||Object.create(null),this.withCredentials=r.withCredentials||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(g,r,p){const e={begin:g,end:r};for(const n in p)e[n]=p[n];return this.request(e)}requestFull(g){return this.request(g)}request(g){const r=new XMLHttpRequest,p=this.currXhrId++,e=this.pendingRequests[p]={xhr:r};r.open("GET",this.url),r.withCredentials=this.withCredentials;for(const n in this.httpHeaders){const c=this.httpHeaders[n];c!==void 0&&r.setRequestHeader(n,c)}return this.isHttp&&"begin"in g&&"end"in g?(r.setRequestHeader("Range",`bytes=${g.begin}-${g.end-1}`),e.expectedStatus=D):e.expectedStatus=C,r.responseType="arraybuffer",g.onError&&(r.onerror=function(n){g.onError(r.status)}),r.onreadystatechange=this.onStateChange.bind(this,p),r.onprogress=this.onProgress.bind(this,p),e.onHeadersReceived=g.onHeadersReceived,e.onDone=g.onDone,e.onError=g.onError,e.onProgress=g.onProgress,r.send(null),p}onProgress(g,r){const p=this.pendingRequests[g];p&&p.onProgress?.(r)}onStateChange(g,r){const p=this.pendingRequests[g];if(!p)return;const e=p.xhr;if(e.readyState>=2&&p.onHeadersReceived&&(p.onHeadersReceived(),delete p.onHeadersReceived),e.readyState!==4||!(g in this.pendingRequests))return;if(delete this.pendingRequests[g],e.status===0&&this.isHttp){p.onError?.(e.status);return}const n=e.status||C;if(!(n===C&&p.expectedStatus===D)&&n!==p.expectedStatus){p.onError?.(e.status);return}const b=k(e);if(n===D){const m=e.getResponseHeader("Content-Range"),R=/bytes (\d+)-(\d+)\/(\d+)/.exec(m);p.onDone({begin:parseInt(R[1],10),chunk:b})}else b?p.onDone({begin:0,chunk:b}):p.onError?.(e.status)}getRequestXhr(g){return this.pendingRequests[g].xhr}isPendingRequest(g){return g in this.pendingRequests}abortRequest(g){const r=this.pendingRequests[g].xhr;delete this.pendingRequests[g],r.abort()}}class y{constructor(g){this._source=g,this._manager=new P(g.url,{httpHeaders:g.httpHeaders,withCredentials:g.withCredentials}),this._rangeChunkSize=g.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(g){const r=this._rangeRequestReaders.indexOf(g);r>=0&&this._rangeRequestReaders.splice(r,1)}getFullReader(){return(0,A.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new v(this._manager,this._source),this._fullRequestReader}getRangeReader(g,r){const p=new l(this._manager,g,r);return p.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(p),p}cancelAllRequests(g){this._fullRequestReader?.cancel(g);for(const r of this._rangeRequestReaders.slice(0))r.cancel(g)}}class v{constructor(g,r){this._manager=g;const p={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=r.url,this._fullRequestId=g.requestFull(p),this._headersReceivedCapability=new A.PromiseCapability,this._disableRange=r.disableRange||!1,this._contentLength=r.length,this._rangeChunkSize=r.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const g=this._fullRequestId,r=this._manager.getRequestXhr(g),p=c=>r.getResponseHeader(c),{allowRangeRequests:e,suggestedLength:n}=(0,z.validateRangeRequestCapabilities)({getResponseHeader:p,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});e&&(this._isRangeSupported=!0),this._contentLength=n||this._contentLength,this._filename=(0,z.extractFilenameFromHeader)(p),this._isRangeSupported&&this._manager.abortRequest(g),this._headersReceivedCapability.resolve()}_onDone(g){if(g&&(this._requests.length>0?this._requests.shift().resolve({value:g.chunk,done:!1}):this._cachedChunks.push(g.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const r of this._requests)r.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(g){this._storedError=(0,z.createResponseStatusError)(g,this._url),this._headersReceivedCapability.reject(this._storedError);for(const r of this._requests)r.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(g){this.onProgress?.({loaded:g.loaded,total:g.lengthComputable?g.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const g=new A.PromiseCapability;return this._requests.push(g),g.promise}cancel(g){this._done=!0,this._headersReceivedCapability.reject(g);for(const r of this._requests)r.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class l{constructor(g,r,p){this._manager=g;const e={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=g.url,this._requestId=g.requestRange(r,p,e),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){this.onClosed?.(this)}_onDone(g){const r=g.chunk;this._requests.length>0?this._requests.shift().resolve({value:r,done:!1}):this._queuedChunk=r,this._done=!0;for(const p of this._requests)p.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(g){this._storedError=(0,z.createResponseStatusError)(g,this._url);for(const r of this._requests)r.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(g){this.isStreamingSupported||this.onProgress?.({loaded:g.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const r=this._queuedChunk;return this._queuedChunk=null,{value:r,done:!1}}if(this._done)return{value:void 0,done:!0};const g=new A.PromiseCapability;return this._requests.push(g),g.promise}cancel(g){this._done=!0;for(const r of this._requests)r.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},253:(ht,Z,U)=>{U.d(Z,{createResponseStatusError:()=>P,extractFilenameFromHeader:()=>k,validateRangeRequestCapabilities:()=>D,validateResponseStatus:()=>y});var A=U(266);function z(v){let l=!0,u=g("filename\\*","i").exec(v);if(u){u=u[1];let m=n(u);return m=unescape(m),m=c(m),m=b(m),p(m)}if(u=e(v),u){const m=b(u);return p(m)}if(u=g("filename","i").exec(v),u){u=u[1];let m=n(u);return m=b(m),p(m)}function g(m,R){return new RegExp("(?:^|;)\\s*"+m+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',R)}function r(m,R){if(m){if(!/^[\x00-\xFF]+$/.test(R))return R;try{const E=new TextDecoder(m,{fatal:!0}),M=(0,A.stringToBytes)(R);R=E.decode(M),l=!1}catch{}}return R}function p(m){return l&&/[\x80-\xff]/.test(m)&&(m=r("utf-8",m),l&&(m=r("iso-8859-1",m))),m}function e(m){const R=[];let E;const M=g("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(E=M.exec(m))!==null;){let[,G,_,Y]=E;if(G=parseInt(G,10),G in R){if(G===0)break;continue}R[G]=[_,Y]}const V=[];for(let G=0;G<R.length&&G in R;++G){let[_,Y]=R[G];Y=n(Y),_&&(Y=unescape(Y),G===0&&(Y=c(Y))),V.push(Y)}return V.join("")}function n(m){if(m.startsWith('"')){const R=m.slice(1).split('\\"');for(let E=0;E<R.length;++E){const M=R[E].indexOf('"');M!==-1&&(R[E]=R[E].slice(0,M),R.length=E+1),R[E]=R[E].replaceAll(/\\(.)/g,"$1")}m=R.join('"')}return m}function c(m){const R=m.indexOf("'");if(R===-1)return m;const E=m.slice(0,R),V=m.slice(R+1).replace(/^[^']*'/,"");return r(E,V)}function b(m){return!m.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(m)?m:m.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(R,E,M,V){if(M==="q"||M==="Q")return V=V.replaceAll("_"," "),V=V.replaceAll(/=([0-9a-fA-F]{2})/g,function(G,_){return String.fromCharCode(parseInt(_,16))}),r(E,V);try{V=atob(V)}catch{}return r(E,V)})}return""}var C=U(473);function D({getResponseHeader:v,isHttp:l,rangeChunkSize:u,disableRange:g}){const r={allowRangeRequests:!1,suggestedLength:void 0},p=parseInt(v("Content-Length"),10);return!Number.isInteger(p)||(r.suggestedLength=p,p<=2*u)||g||!l||v("Accept-Ranges")!=="bytes"||(v("Content-Encoding")||"identity")!=="identity"||(r.allowRangeRequests=!0),r}function k(v){const l=v("Content-Disposition");if(l){let u=z(l);if(u.includes("%"))try{u=decodeURIComponent(u)}catch{}if((0,C.isPdfFile)(u))return u}return null}function P(v,l){return v===404||v===0&&l.startsWith("file:")?new A.MissingPDFException('Missing PDF "'+l+'".'):new A.UnexpectedResponseException(`Unexpected server response (${v}) while retrieving PDF "${l}".`,v)}function y(v){return v===200||v===206}},498:(ht,Z,U)=>{U.a(ht,async(A,z)=>{try{let u=function(R){const E=v.parse(R);return E.protocol==="file:"||E.host?E:/^[a-z]:[/\\]/i.test(R)?v.parse(`file:///${R}`):(E.host||(E.protocol="file:"),E)},e=function(R,E){return{protocol:R.protocol,auth:R.auth,host:R.hostname,port:R.port,path:R.path,method:"GET",headers:E}};U.d(Z,{PDFNodeStream:()=>g});var C=U(266),D=U(253);let k,P,y,v;C.isNodeJS&&(k=await Mt(()=>import("./__vite-browser-external-BIHI7g3E.js"),[]),P=await Mt(()=>import("./__vite-browser-external-BIHI7g3E.js"),[]),y=await Mt(()=>import("./__vite-browser-external-BIHI7g3E.js"),[]),v=await Mt(()=>import("./__vite-browser-external-BIHI7g3E.js"),[]));const l=/^file:\/\/\/[a-zA-Z]:\//;class g{constructor(E){this.source=E,this.url=u(E.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&E.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return(0,C.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new b(this):new n(this),this._fullRequestReader}getRangeReader(E,M){if(M<=this._progressiveDataLength)return null;const V=this.isFsUrl?new m(this,E,M):new c(this,E,M);return this._rangeRequestReaders.push(V),V}cancelAllRequests(E){this._fullRequestReader?.cancel(E);for(const M of this._rangeRequestReaders.slice(0))M.cancel(E)}}class r{constructor(E){this._url=E.url,this._done=!1,this._storedError=null,this.onProgress=null;const M=E.source;this._contentLength=M.length,this._loaded=0,this._filename=null,this._disableRange=M.disableRange||!1,this._rangeChunkSize=M.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!M.disableStream,this._isRangeSupported=!M.disableRange,this._readableStream=null,this._readCapability=new C.PromiseCapability,this._headersCapability=new C.PromiseCapability}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const E=this._readableStream.read();return E===null?(this._readCapability=new C.PromiseCapability,this.read()):(this._loaded+=E.length,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(E).buffer,done:!1})}cancel(E){if(!this._readableStream){this._error(E);return}this._readableStream.destroy(E)}_error(E){this._storedError=E,this._readCapability.resolve()}_setReadableStream(E){this._readableStream=E,E.on("readable",()=>{this._readCapability.resolve()}),E.on("end",()=>{E.destroy(),this._done=!0,this._readCapability.resolve()}),E.on("error",M=>{this._error(M)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new C.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class p{constructor(E){this._url=E.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=new C.PromiseCapability;const M=E.source;this._isStreamingSupported=!M.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const E=this._readableStream.read();return E===null?(this._readCapability=new C.PromiseCapability,this.read()):(this._loaded+=E.length,this.onProgress?.({loaded:this._loaded}),{value:new Uint8Array(E).buffer,done:!1})}cancel(E){if(!this._readableStream){this._error(E);return}this._readableStream.destroy(E)}_error(E){this._storedError=E,this._readCapability.resolve()}_setReadableStream(E){this._readableStream=E,E.on("readable",()=>{this._readCapability.resolve()}),E.on("end",()=>{E.destroy(),this._done=!0,this._readCapability.resolve()}),E.on("error",M=>{this._error(M)}),this._storedError&&this._readableStream.destroy(this._storedError)}}class n extends r{constructor(E){super(E);const M=V=>{if(V.statusCode===404){const tt=new C.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=tt,this._headersCapability.reject(tt);return}this._headersCapability.resolve(),this._setReadableStream(V);const G=tt=>this._readableStream.headers[tt.toLowerCase()],{allowRangeRequests:_,suggestedLength:Y}=(0,D.validateRangeRequestCapabilities)({getResponseHeader:G,isHttp:E.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=_,this._contentLength=Y||this._contentLength,this._filename=(0,D.extractFilenameFromHeader)(G)};this._request=null,this._url.protocol==="http:"?this._request=P.request(e(this._url,E.httpHeaders),M):this._request=y.request(e(this._url,E.httpHeaders),M),this._request.on("error",V=>{this._storedError=V,this._headersCapability.reject(V)}),this._request.end()}}class c extends p{constructor(E,M,V){super(E),this._httpHeaders={};for(const _ in E.httpHeaders){const Y=E.httpHeaders[_];Y!==void 0&&(this._httpHeaders[_]=Y)}this._httpHeaders.Range=`bytes=${M}-${V-1}`;const G=_=>{if(_.statusCode===404){const Y=new C.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=Y;return}this._setReadableStream(_)};this._request=null,this._url.protocol==="http:"?this._request=P.request(e(this._url,this._httpHeaders),G):this._request=y.request(e(this._url,this._httpHeaders),G),this._request.on("error",_=>{this._storedError=_}),this._request.end()}}class b extends r{constructor(E){super(E);let M=decodeURIComponent(this._url.path);l.test(this._url.href)&&(M=M.replace(/^\//,"")),k.lstat(M,(V,G)=>{if(V){V.code==="ENOENT"&&(V=new C.MissingPDFException(`Missing PDF "${M}".`)),this._storedError=V,this._headersCapability.reject(V);return}this._contentLength=G.size,this._setReadableStream(k.createReadStream(M)),this._headersCapability.resolve()})}}class m extends p{constructor(E,M,V){super(E);let G=decodeURIComponent(this._url.path);l.test(this._url.href)&&(G=G.replace(/^\//,"")),this._setReadableStream(k.createReadStream(G,{start:M,end:V-1}))}}z()}catch(k){z(k)}},1)},738:(ht,Z,U)=>{U.a(ht,async(A,z)=>{try{U.d(Z,{NodeCMapReaderFactory:()=>g,NodeCanvasFactory:()=>u,NodeFilterFactory:()=>l,NodeStandardFontDataFactory:()=>r});var C=U(822),D=U(266);let k,P,y;if(D.isNodeJS){k=await Mt(()=>import("./__vite-browser-external-BIHI7g3E.js"),[]);try{P=await Mt(()=>import("./__vite-browser-external-BIHI7g3E.js"),[])}catch{}try{y=await Mt(()=>import("./path2d-polyfill.esm-Bqvoz_29.js"),[])}catch{}}const v=function(p){return new Promise((e,n)=>{k.readFile(p,(c,b)=>{if(c||!b){n(new Error(c));return}e(new Uint8Array(b))})})};class l extends C.BaseFilterFactory{}class u extends C.BaseCanvasFactory{_createCanvas(e,n){return P.createCanvas(e,n)}}class g extends C.BaseCMapReaderFactory{_fetchData(e,n){return v(e).then(c=>({cMapData:c,compressionType:n}))}}class r extends C.BaseStandardFontDataFactory{_fetchData(e){return v(e)}}z()}catch(k){z(k)}},1)},890:(ht,Z,U)=>{U.d(Z,{OptionalContentConfig:()=>k});var A=U(266),z=U(825);const C=Symbol("INTERNAL");class D{#t=!0;constructor(y,v){this.name=y,this.intent=v}get visible(){return this.#t}_setVisible(y,v){y!==C&&(0,A.unreachable)("Internal method `_setVisible` called."),this.#t=v}}class k{#t=null;#e=new Map;#s=null;#i=null;constructor(y){if(this.name=null,this.creator=null,y!==null){this.name=y.name,this.creator=y.creator,this.#i=y.order;for(const v of y.groups)this.#e.set(v.id,new D(v.name,v.intent));if(y.baseState==="OFF")for(const v of this.#e.values())v._setVisible(C,!1);for(const v of y.on)this.#e.get(v)._setVisible(C,!0);for(const v of y.off)this.#e.get(v)._setVisible(C,!1);this.#s=this.getHash()}}#n(y){const v=y.length;if(v<2)return!0;const l=y[0];for(let u=1;u<v;u++){const g=y[u];let r;if(Array.isArray(g))r=this.#n(g);else if(this.#e.has(g))r=this.#e.get(g).visible;else return(0,A.warn)(`Optional content group not found: ${g}`),!0;switch(l){case"And":if(!r)return!1;break;case"Or":if(r)return!0;break;case"Not":return!r;default:return!0}}return l==="And"}isVisible(y){if(this.#e.size===0)return!0;if(!y)return(0,A.warn)("Optional content group not defined."),!0;if(y.type==="OCG")return this.#e.has(y.id)?this.#e.get(y.id).visible:((0,A.warn)(`Optional content group not found: ${y.id}`),!0);if(y.type==="OCMD"){if(y.expression)return this.#n(y.expression);if(!y.policy||y.policy==="AnyOn"){for(const v of y.ids){if(!this.#e.has(v))return(0,A.warn)(`Optional content group not found: ${v}`),!0;if(this.#e.get(v).visible)return!0}return!1}else if(y.policy==="AllOn"){for(const v of y.ids){if(!this.#e.has(v))return(0,A.warn)(`Optional content group not found: ${v}`),!0;if(!this.#e.get(v).visible)return!1}return!0}else if(y.policy==="AnyOff"){for(const v of y.ids){if(!this.#e.has(v))return(0,A.warn)(`Optional content group not found: ${v}`),!0;if(!this.#e.get(v).visible)return!0}return!1}else if(y.policy==="AllOff"){for(const v of y.ids){if(!this.#e.has(v))return(0,A.warn)(`Optional content group not found: ${v}`),!0;if(this.#e.get(v).visible)return!1}return!0}return(0,A.warn)(`Unknown optional content policy ${y.policy}.`),!0}return(0,A.warn)(`Unknown group type ${y.type}.`),!0}setVisibility(y,v=!0){if(!this.#e.has(y)){(0,A.warn)(`Optional content group not found: ${y}`);return}this.#e.get(y)._setVisible(C,!!v),this.#t=null}get hasInitialVisibility(){return this.#s===null||this.getHash()===this.#s}getOrder(){return this.#e.size?this.#i?this.#i.slice():[...this.#e.keys()]:null}getGroups(){return this.#e.size>0?(0,A.objectFromMap)(this.#e):null}getGroup(y){return this.#e.get(y)||null}getHash(){if(this.#t!==null)return this.#t;const y=new z.MurmurHash3_64;for(const[v,l]of this.#e)y.update(`${v}:${l.visible}`);return this.#t=y.hexdigest()}}},739:(ht,Z,U)=>{U.d(Z,{renderTextLayer:()=>p,updateTextLayer:()=>e});var A=U(266),z=U(473);const C=1e5,D=30,k=.8,P=new Map;function y(n,c){let b;if(c&&A.FeatureTest.isOffscreenCanvasSupported)b=new OffscreenCanvas(n,n).getContext("2d",{alpha:!1});else{const m=document.createElement("canvas");m.width=m.height=n,b=m.getContext("2d",{alpha:!1})}return b}function v(n,c){const b=P.get(n);if(b)return b;const m=y(D,c);m.font=`${D}px ${n}`;const R=m.measureText("");let E=R.fontBoundingBoxAscent,M=Math.abs(R.fontBoundingBoxDescent);if(E){const G=E/(E+M);return P.set(n,G),m.canvas.width=m.canvas.height=0,G}m.strokeStyle="red",m.clearRect(0,0,D,D),m.strokeText("g",0,0);let V=m.getImageData(0,0,D,D).data;M=0;for(let G=V.length-1-3;G>=0;G-=4)if(V[G]>0){M=Math.ceil(G/4/D);break}m.clearRect(0,0,D,D),m.strokeText("A",0,D),V=m.getImageData(0,0,D,D).data,E=0;for(let G=0,_=V.length;G<_;G+=4)if(V[G]>0){E=D-Math.floor(G/4/D);break}if(m.canvas.width=m.canvas.height=0,E){const G=E/(E+M);return P.set(n,G),G}return P.set(n,k),k}function l(n,c,b){const m=document.createElement("span"),R={angle:0,canvasWidth:0,hasText:c.str!=="",hasEOL:c.hasEOL,fontSize:0};n._textDivs.push(m);const E=A.Util.transform(n._transform,c.transform);let M=Math.atan2(E[1],E[0]);const V=b[c.fontName];V.vertical&&(M+=Math.PI/2);const G=n._fontInspectorEnabled&&V.fontSubstitution||V.fontFamily,_=Math.hypot(E[2],E[3]),Y=_*v(G,n._isOffscreenCanvasSupported);let tt,rt;M===0?(tt=E[4],rt=E[5]-Y):(tt=E[4]+Y*Math.sin(M),rt=E[5]-Y*Math.cos(M));const j="calc(var(--scale-factor)*",O=m.style;n._container===n._rootContainer?(O.left=`${(100*tt/n._pageWidth).toFixed(2)}%`,O.top=`${(100*rt/n._pageHeight).toFixed(2)}%`):(O.left=`${j}${tt.toFixed(2)}px)`,O.top=`${j}${rt.toFixed(2)}px)`),O.fontSize=`${j}${_.toFixed(2)}px)`,O.fontFamily=G,R.fontSize=_,m.setAttribute("role","presentation"),m.textContent=c.str,m.dir=c.dir,n._fontInspectorEnabled&&(m.dataset.fontName=V.fontSubstitutionLoadedName||c.fontName),M!==0&&(R.angle=M*(180/Math.PI));let B=!1;if(c.str.length>1)B=!0;else if(c.str!==" "&&c.transform[0]!==c.transform[3]){const q=Math.abs(c.transform[0]),Q=Math.abs(c.transform[3]);q!==Q&&Math.max(q,Q)/Math.min(q,Q)>1.5&&(B=!0)}B&&(R.canvasWidth=V.vertical?c.height:c.width),n._textDivProperties.set(m,R),n._isReadableStream&&n._layoutText(m)}function u(n){const{div:c,scale:b,properties:m,ctx:R,prevFontSize:E,prevFontFamily:M}=n,{style:V}=c;let G="";if(m.canvasWidth!==0&&m.hasText){const{fontFamily:_}=V,{canvasWidth:Y,fontSize:tt}=m;(E!==tt||M!==_)&&(R.font=`${tt*b}px ${_}`,n.prevFontSize=tt,n.prevFontFamily=_);const{width:rt}=R.measureText(c.textContent);rt>0&&(G=`scaleX(${Y*b/rt})`)}m.angle!==0&&(G=`rotate(${m.angle}deg) ${G}`),G.length>0&&(V.transform=G)}function g(n){if(n._canceled)return;const c=n._textDivs,b=n._capability;if(c.length>C){b.resolve();return}if(!n._isReadableStream)for(const R of c)n._layoutText(R);b.resolve()}class r{constructor({textContentSource:c,container:b,viewport:m,textDivs:R,textDivProperties:E,textContentItemsStr:M,isOffscreenCanvasSupported:V}){this._textContentSource=c,this._isReadableStream=c instanceof ReadableStream,this._container=this._rootContainer=b,this._textDivs=R||[],this._textContentItemsStr=M||[],this._isOffscreenCanvasSupported=V,this._fontInspectorEnabled=!!globalThis.FontInspector?.enabled,this._reader=null,this._textDivProperties=E||new WeakMap,this._canceled=!1,this._capability=new A.PromiseCapability,this._layoutTextParams={prevFontSize:null,prevFontFamily:null,div:null,scale:m.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:y(0,V)};const{pageWidth:G,pageHeight:_,pageX:Y,pageY:tt}=m.rawDims;this._transform=[1,0,0,-1,-Y,tt+_],this._pageWidth=G,this._pageHeight=_,(0,z.setLayerDimensions)(b,m),this._capability.promise.finally(()=>{this._layoutTextParams=null}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new A.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._capability.reject(new A.AbortException("TextLayer task cancelled."))}_processItems(c,b){for(const m of c){if(m.str===void 0){if(m.type==="beginMarkedContentProps"||m.type==="beginMarkedContent"){const R=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),m.id!==null&&this._container.setAttribute("id",`${m.id}`),R.append(this._container)}else m.type==="endMarkedContent"&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(m.str),l(this,m,b)}}_layoutText(c){const b=this._layoutTextParams.properties=this._textDivProperties.get(c);if(this._layoutTextParams.div=c,u(this._layoutTextParams),b.hasText&&this._container.append(c),b.hasEOL){const m=document.createElement("br");m.setAttribute("role","presentation"),this._container.append(m)}}_render(){const c=new A.PromiseCapability;let b=Object.create(null);if(this._isReadableStream){const m=()=>{this._reader.read().then(({value:R,done:E})=>{if(E){c.resolve();return}Object.assign(b,R.styles),this._processItems(R.items,b),m()},c.reject)};this._reader=this._textContentSource.getReader(),m()}else if(this._textContentSource){const{items:m,styles:R}=this._textContentSource;this._processItems(m,R),c.resolve()}else throw new Error('No "textContentSource" parameter specified.');c.promise.then(()=>{b=null,g(this)},this._capability.reject)}}function p(n){const c=new r(n);return c._render(),c}function e({container:n,viewport:c,textDivs:b,textDivProperties:m,isOffscreenCanvasSupported:R,mustRotate:E=!0,mustRescale:M=!0}){if(E&&(0,z.setLayerDimensions)(n,{rotation:c.rotation}),M){const V=y(0,R),_={prevFontSize:null,prevFontFamily:null,div:null,scale:c.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:V};for(const Y of b)_.properties=m.get(Y),_.div=Y,u(_)}}},92:(ht,Z,U)=>{U.d(Z,{PDFDataTransportStream:()=>C});var A=U(266),z=U(473);class C{constructor({length:y,initialData:v,progressiveDone:l=!1,contentDispositionFilename:u=null,disableRange:g=!1,disableStream:r=!1},p){if((0,A.assert)(p,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=l,this._contentDispositionFilename=u,v?.length>0){const e=v instanceof Uint8Array&&v.byteLength===v.buffer.byteLength?v.buffer:new Uint8Array(v).buffer;this._queuedChunks.push(e)}this._pdfDataRangeTransport=p,this._isStreamingSupported=!r,this._isRangeSupported=!g,this._contentLength=y,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((e,n)=>{this._onReceiveData({begin:e,chunk:n})}),this._pdfDataRangeTransport.addProgressListener((e,n)=>{this._onProgress({loaded:e,total:n})}),this._pdfDataRangeTransport.addProgressiveReadListener(e=>{this._onReceiveData({chunk:e})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData({begin:y,chunk:v}){const l=v instanceof Uint8Array&&v.byteLength===v.buffer.byteLength?v.buffer:new Uint8Array(v).buffer;if(y===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(l):this._queuedChunks.push(l);else{const u=this._rangeReaders.some(function(g){return g._begin!==y?!1:(g._enqueue(l),!0)});(0,A.assert)(u,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}_onProgress(y){y.total===void 0?this._rangeReaders[0]?.onProgress?.({loaded:y.loaded}):this._fullRequestReader?.onProgress?.({loaded:y.loaded,total:y.total})}_onProgressiveDone(){this._fullRequestReader?.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(y){const v=this._rangeReaders.indexOf(y);v>=0&&this._rangeReaders.splice(v,1)}getFullReader(){(0,A.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const y=this._queuedChunks;return this._queuedChunks=null,new D(this,y,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(y,v){if(v<=this._progressiveDataLength)return null;const l=new k(this,y,v);return this._pdfDataRangeTransport.requestDataRange(y,v),this._rangeReaders.push(l),l}cancelAllRequests(y){this._fullRequestReader?.cancel(y);for(const v of this._rangeReaders.slice(0))v.cancel(y);this._pdfDataRangeTransport.abort()}}class D{constructor(y,v,l=!1,u=null){this._stream=y,this._done=l||!1,this._filename=(0,z.isPdfFile)(u)?u:null,this._queuedChunks=v||[],this._loaded=0;for(const g of this._queuedChunks)this._loaded+=g.byteLength;this._requests=[],this._headersReady=Promise.resolve(),y._fullRequestReader=this,this.onProgress=null}_enqueue(y){this._done||(this._requests.length>0?this._requests.shift().resolve({value:y,done:!1}):this._queuedChunks.push(y),this._loaded+=y.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const y=new A.PromiseCapability;return this._requests.push(y),y.promise}cancel(y){this._done=!0;for(const v of this._requests)v.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class k{constructor(y,v,l){this._stream=y,this._begin=v,this._end=l,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(y){if(!this._done){if(this._requests.length===0)this._queuedChunk=y;else{this._requests.shift().resolve({value:y,done:!1});for(const l of this._requests)l.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const v=this._queuedChunk;return this._queuedChunk=null,{value:v,done:!1}}if(this._done)return{value:void 0,done:!0};const y=new A.PromiseCapability;return this._requests.push(y),y.promise}cancel(y){this._done=!0;for(const v of this._requests)v.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},368:(ht,Z,U)=>{U.d(Z,{GlobalWorkerOptions:()=>A});const A=Object.create(null);A.workerPort=null,A.workerSrc=""},160:(ht,Z,U)=>{U.d(Z,{XfaLayer:()=>z});var A=U(521);class z{static setupStorage(D,k,P,y,v){const l=y.getValue(k,{value:null});switch(P.name){case"textarea":if(l.value!==null&&(D.textContent=l.value),v==="print")break;D.addEventListener("input",u=>{y.setValue(k,{value:u.target.value})});break;case"input":if(P.attributes.type==="radio"||P.attributes.type==="checkbox"){if(l.value===P.attributes.xfaOn?D.setAttribute("checked",!0):l.value===P.attributes.xfaOff&&D.removeAttribute("checked"),v==="print")break;D.addEventListener("change",u=>{y.setValue(k,{value:u.target.checked?u.target.getAttribute("xfaOn"):u.target.getAttribute("xfaOff")})})}else{if(l.value!==null&&D.setAttribute("value",l.value),v==="print")break;D.addEventListener("input",u=>{y.setValue(k,{value:u.target.value})})}break;case"select":if(l.value!==null){D.setAttribute("value",l.value);for(const u of P.children)u.attributes.value===l.value?u.attributes.selected=!0:u.attributes.hasOwnProperty("selected")&&delete u.attributes.selected}D.addEventListener("input",u=>{const g=u.target.options,r=g.selectedIndex===-1?"":g[g.selectedIndex].value;y.setValue(k,{value:r})});break}}static setAttributes({html:D,element:k,storage:P=null,intent:y,linkService:v}){const{attributes:l}=k,u=D instanceof HTMLAnchorElement;l.type==="radio"&&(l.name=`${l.name}-${y}`);for(const[g,r]of Object.entries(l))if(r!=null)switch(g){case"class":r.length&&D.setAttribute(g,r.join(" "));break;case"dataId":break;case"id":D.setAttribute("data-element-id",r);break;case"style":Object.assign(D.style,r);break;case"textContent":D.textContent=r;break;default:(!u||g!=="href"&&g!=="newWindow")&&D.setAttribute(g,r)}u&&v.addLinkAttributes(D,l.href,l.newWindow),P&&l.dataId&&this.setupStorage(D,l.dataId,k,P)}static render(D){const k=D.annotationStorage,P=D.linkService,y=D.xfaHtml,v=D.intent||"display",l=document.createElement(y.name);y.attributes&&this.setAttributes({html:l,element:y,intent:v,linkService:P});const u=v!=="richText",g=D.div;if(g.append(l),D.viewport){const e=`matrix(${D.viewport.transform.join(",")})`;g.style.transform=e}u&&g.setAttribute("class","xfaLayer xfaFont");const r=[];if(y.children.length===0){if(y.value){const e=document.createTextNode(y.value);l.append(e),u&&A.XfaText.shouldBuildText(y.name)&&r.push(e)}return{textDivs:r}}const p=[[y,-1,l]];for(;p.length>0;){const[e,n,c]=p.at(-1);if(n+1===e.children.length){p.pop();continue}const b=e.children[++p.at(-1)[1]];if(b===null)continue;const{name:m}=b;if(m==="#text"){const E=document.createTextNode(b.value);r.push(E),c.append(E);continue}const R=b?.attributes?.xmlns?document.createElementNS(b.attributes.xmlns,m):document.createElement(m);if(c.append(R),b.attributes&&this.setAttributes({html:R,element:b,storage:k,intent:v,linkService:P}),b.children?.length>0)p.push([b,-1,R]);else if(b.value){const E=document.createTextNode(b.value);u&&A.XfaText.shouldBuildText(m)&&r.push(E),R.append(E)}}for(const e of g.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))e.setAttribute("readOnly",!0);return{textDivs:r}}static update(D){const k=`matrix(${D.viewport.transform.join(",")})`;D.div.style.transform=k,D.div.hidden=!1}}},521:(ht,Z,U)=>{U.d(Z,{XfaText:()=>A});class A{static textContent(C){const D=[],k={items:D,styles:Object.create(null)};function P(y){if(!y)return;let v=null;const l=y.name;if(l==="#text")v=y.value;else if(A.shouldBuildText(l))y?.attributes?.textContent?v=y.attributes.textContent:y.value&&(v=y.value);else return;if(v!==null&&D.push({str:v}),!!y.children)for(const u of y.children)P(u)}return P(C),k}static shouldBuildText(C){return!(C==="textarea"||C==="input"||C==="option"||C==="select")}}},907:(ht,Z,U)=>{U.a(ht,async(A,z)=>{try{U.d(Z,{AbortException:()=>C.AbortException,AnnotationEditorLayer:()=>y.AnnotationEditorLayer,AnnotationEditorParamsType:()=>C.AnnotationEditorParamsType,AnnotationEditorType:()=>C.AnnotationEditorType,AnnotationEditorUIManager:()=>v.AnnotationEditorUIManager,AnnotationLayer:()=>l.AnnotationLayer,AnnotationMode:()=>C.AnnotationMode,CMapCompressionType:()=>C.CMapCompressionType,ColorPicker:()=>u.ColorPicker,DOMSVGFactory:()=>k.DOMSVGFactory,DrawLayer:()=>g.DrawLayer,FeatureTest:()=>C.FeatureTest,GlobalWorkerOptions:()=>r.GlobalWorkerOptions,ImageKind:()=>C.ImageKind,InvalidPDFException:()=>C.InvalidPDFException,MissingPDFException:()=>C.MissingPDFException,OPS:()=>C.OPS,Outliner:()=>p.Outliner,PDFDataRangeTransport:()=>D.PDFDataRangeTransport,PDFDateString:()=>k.PDFDateString,PDFWorker:()=>D.PDFWorker,PasswordResponses:()=>C.PasswordResponses,PermissionFlag:()=>C.PermissionFlag,PixelsPerInch:()=>k.PixelsPerInch,PromiseCapability:()=>C.PromiseCapability,RenderingCancelledException:()=>k.RenderingCancelledException,UnexpectedResponseException:()=>C.UnexpectedResponseException,Util:()=>C.Util,VerbosityLevel:()=>C.VerbosityLevel,XfaLayer:()=>e.XfaLayer,build:()=>D.build,createValidAbsoluteUrl:()=>C.createValidAbsoluteUrl,fetchData:()=>k.fetchData,getDocument:()=>D.getDocument,getFilenameFromUrl:()=>k.getFilenameFromUrl,getPdfFilenameFromUrl:()=>k.getPdfFilenameFromUrl,getXfaPageViewport:()=>k.getXfaPageViewport,isDataScheme:()=>k.isDataScheme,isPdfFile:()=>k.isPdfFile,noContextMenu:()=>k.noContextMenu,normalizeUnicode:()=>C.normalizeUnicode,renderTextLayer:()=>P.renderTextLayer,setLayerDimensions:()=>k.setLayerDimensions,shadow:()=>C.shadow,updateTextLayer:()=>P.updateTextLayer,version:()=>D.version});var C=U(266),D=U(406),k=U(473),P=U(739),y=U(629),v=U(812),l=U(640),u=U(97),g=U(423),r=U(368),p=U(405),e=U(160),n=A([D]);D=(n.then?(await n)():n)[0];const c="4.0.379",b="9e14d04fd";z()}catch(c){z(c)}})},694:(ht,Z,U)=>{U.d(Z,{MessageHandler:()=>k});var A=U(266);const z={UNKNOWN:0,DATA:1,ERROR:2},C={UNKNOWN:0,CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function D(P){switch(P instanceof Error||typeof P=="object"&&P!==null||(0,A.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),P.name){case"AbortException":return new A.AbortException(P.message);case"MissingPDFException":return new A.MissingPDFException(P.message);case"PasswordException":return new A.PasswordException(P.message,P.code);case"UnexpectedResponseException":return new A.UnexpectedResponseException(P.message,P.status);case"UnknownErrorException":return new A.UnknownErrorException(P.message,P.details);default:return new A.UnknownErrorException(P.message,P.toString())}}class k{constructor(y,v,l){this.sourceName=y,this.targetName=v,this.comObj=l,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=u=>{const g=u.data;if(g.targetName!==this.sourceName)return;if(g.stream){this.#e(g);return}if(g.callback){const p=g.callbackId,e=this.callbackCapabilities[p];if(!e)throw new Error(`Cannot resolve callback ${p}`);if(delete this.callbackCapabilities[p],g.callback===z.DATA)e.resolve(g.data);else if(g.callback===z.ERROR)e.reject(D(g.reason));else throw new Error("Unexpected callback case");return}const r=this.actionHandler[g.action];if(!r)throw new Error(`Unknown action from worker: ${g.action}`);if(g.callbackId){const p=this.sourceName,e=g.sourceName;new Promise(function(n){n(r(g.data))}).then(function(n){l.postMessage({sourceName:p,targetName:e,callback:z.DATA,callbackId:g.callbackId,data:n})},function(n){l.postMessage({sourceName:p,targetName:e,callback:z.ERROR,callbackId:g.callbackId,reason:D(n)})});return}if(g.streamId){this.#t(g);return}r(g.data)},l.addEventListener("message",this._onComObjOnMessage)}on(y,v){const l=this.actionHandler;if(l[y])throw new Error(`There is already an actionName called "${y}"`);l[y]=v}send(y,v,l){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:y,data:v},l)}sendWithPromise(y,v,l){const u=this.callbackId++,g=new A.PromiseCapability;this.callbackCapabilities[u]=g;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:y,callbackId:u,data:v},l)}catch(r){g.reject(r)}return g.promise}sendWithStream(y,v,l,u){const g=this.streamId++,r=this.sourceName,p=this.targetName,e=this.comObj;return new ReadableStream({start:n=>{const c=new A.PromiseCapability;return this.streamControllers[g]={controller:n,startCall:c,pullCall:null,cancelCall:null,isClosed:!1},e.postMessage({sourceName:r,targetName:p,action:y,streamId:g,data:v,desiredSize:n.desiredSize},u),c.promise},pull:n=>{const c=new A.PromiseCapability;return this.streamControllers[g].pullCall=c,e.postMessage({sourceName:r,targetName:p,stream:C.PULL,streamId:g,desiredSize:n.desiredSize}),c.promise},cancel:n=>{(0,A.assert)(n instanceof Error,"cancel must have a valid reason");const c=new A.PromiseCapability;return this.streamControllers[g].cancelCall=c,this.streamControllers[g].isClosed=!0,e.postMessage({sourceName:r,targetName:p,stream:C.CANCEL,streamId:g,reason:D(n)}),c.promise}},l)}#t(y){const v=y.streamId,l=this.sourceName,u=y.sourceName,g=this.comObj,r=this,p=this.actionHandler[y.action],e={enqueue(n,c=1,b){if(this.isCancelled)return;const m=this.desiredSize;this.desiredSize-=c,m>0&&this.desiredSize<=0&&(this.sinkCapability=new A.PromiseCapability,this.ready=this.sinkCapability.promise),g.postMessage({sourceName:l,targetName:u,stream:C.ENQUEUE,streamId:v,chunk:n},b)},close(){this.isCancelled||(this.isCancelled=!0,g.postMessage({sourceName:l,targetName:u,stream:C.CLOSE,streamId:v}),delete r.streamSinks[v])},error(n){(0,A.assert)(n instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,g.postMessage({sourceName:l,targetName:u,stream:C.ERROR,streamId:v,reason:D(n)}))},sinkCapability:new A.PromiseCapability,onPull:null,onCancel:null,isCancelled:!1,desiredSize:y.desiredSize,ready:null};e.sinkCapability.resolve(),e.ready=e.sinkCapability.promise,this.streamSinks[v]=e,new Promise(function(n){n(p(y.data,e))}).then(function(){g.postMessage({sourceName:l,targetName:u,stream:C.START_COMPLETE,streamId:v,success:!0})},function(n){g.postMessage({sourceName:l,targetName:u,stream:C.START_COMPLETE,streamId:v,reason:D(n)})})}#e(y){const v=y.streamId,l=this.sourceName,u=y.sourceName,g=this.comObj,r=this.streamControllers[v],p=this.streamSinks[v];switch(y.stream){case C.START_COMPLETE:y.success?r.startCall.resolve():r.startCall.reject(D(y.reason));break;case C.PULL_COMPLETE:y.success?r.pullCall.resolve():r.pullCall.reject(D(y.reason));break;case C.PULL:if(!p){g.postMessage({sourceName:l,targetName:u,stream:C.PULL_COMPLETE,streamId:v,success:!0});break}p.desiredSize<=0&&y.desiredSize>0&&p.sinkCapability.resolve(),p.desiredSize=y.desiredSize,new Promise(function(e){e(p.onPull?.())}).then(function(){g.postMessage({sourceName:l,targetName:u,stream:C.PULL_COMPLETE,streamId:v,success:!0})},function(e){g.postMessage({sourceName:l,targetName:u,stream:C.PULL_COMPLETE,streamId:v,reason:D(e)})});break;case C.ENQUEUE:if((0,A.assert)(r,"enqueue should have stream controller"),r.isClosed)break;r.controller.enqueue(y.chunk);break;case C.CLOSE:if((0,A.assert)(r,"close should have stream controller"),r.isClosed)break;r.isClosed=!0,r.controller.close(),this.#s(r,v);break;case C.ERROR:(0,A.assert)(r,"error should have stream controller"),r.controller.error(D(y.reason)),this.#s(r,v);break;case C.CANCEL_COMPLETE:y.success?r.cancelCall.resolve():r.cancelCall.reject(D(y.reason)),this.#s(r,v);break;case C.CANCEL:if(!p)break;new Promise(function(e){e(p.onCancel?.(D(y.reason)))}).then(function(){g.postMessage({sourceName:l,targetName:u,stream:C.CANCEL_COMPLETE,streamId:v,success:!0})},function(e){g.postMessage({sourceName:l,targetName:u,stream:C.CANCEL_COMPLETE,streamId:v,reason:D(e)})}),p.sinkCapability.reject(D(y.reason)),p.isCancelled=!0,delete this.streamSinks[v];break;default:throw new Error("Unexpected stream case")}}async#s(y,v){await Promise.allSettled([y.startCall?.promise,y.pullCall?.promise,y.cancelCall?.promise]),delete this.streamControllers[v]}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}},825:(ht,Z,U)=>{U.d(Z,{MurmurHash3_64:()=>k});var A=U(266);const z=3285377520,C=4294901760,D=65535;class k{constructor(y){this.h1=y?y&4294967295:z,this.h2=y?y&4294967295:z}update(y){let v,l;if(typeof y=="string"){v=new Uint8Array(y.length*2),l=0;for(let M=0,V=y.length;M<V;M++){const G=y.charCodeAt(M);G<=255?v[l++]=G:(v[l++]=G>>>8,v[l++]=G&255)}}else if((0,A.isArrayBuffer)(y))v=y.slice(),l=v.byteLength;else throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");const u=l>>2,g=l-u*4,r=new Uint32Array(v.buffer,0,u);let p=0,e=0,n=this.h1,c=this.h2;const b=3432918353,m=461845907,R=b&D,E=m&D;for(let M=0;M<u;M++)M&1?(p=r[M],p=p*b&C|p*R&D,p=p<<15|p>>>17,p=p*m&C|p*E&D,n^=p,n=n<<13|n>>>19,n=n*5+3864292196):(e=r[M],e=e*b&C|e*R&D,e=e<<15|e>>>17,e=e*m&C|e*E&D,c^=e,c=c<<13|c>>>19,c=c*5+3864292196);switch(p=0,g){case 3:p^=v[u*4+2]<<16;case 2:p^=v[u*4+1]<<8;case 1:p^=v[u*4],p=p*b&C|p*R&D,p=p<<15|p>>>17,p=p*m&C|p*E&D,u&1?n^=p:c^=p}this.h1=n,this.h2=c}hexdigest(){let y=this.h1,v=this.h2;return y^=v>>>1,y=y*3981806797&C|y*36045&D,v=v*4283543511&C|((v<<16|y>>>16)*2950163797&C)>>>16,y^=v>>>1,y=y*444984403&C|y*60499&D,v=v*3301882366&C|((v<<16|y>>>16)*3120437893&C)>>>16,y^=v>>>1,(y>>>0).toString(16).padStart(8,"0")+(v>>>0).toString(16).padStart(8,"0")}}},266:(ht,Z,U)=>{U.d(Z,{AbortException:()=>gt,AnnotationBorderStyleType:()=>n,AnnotationEditorParamsType:()=>u,AnnotationEditorPrefix:()=>v,AnnotationEditorType:()=>l,AnnotationMode:()=>y,AnnotationPrefix:()=>H,AnnotationType:()=>e,BaseException:()=>B,CMapCompressionType:()=>b,FONT_IDENTITY_MATRIX:()=>C,FeatureTest:()=>t,FormatError:()=>at,IDENTITY_MATRIX:()=>z,ImageKind:()=>p,InvalidPDFException:()=>K,LINE_FACTOR:()=>k,MAX_IMAGE_SIZE_TO_CACHE:()=>D,MissingPDFException:()=>ft,OPS:()=>m,PasswordException:()=>q,PasswordResponses:()=>R,PermissionFlag:()=>g,PromiseCapability:()=>w,RenderingIntentFlag:()=>P,TextRenderingMode:()=>r,UnexpectedResponseException:()=>ot,UnknownErrorException:()=>Q,Util:()=>a,VerbosityLevel:()=>c,assert:()=>tt,bytesToString:()=>dt,createValidAbsoluteUrl:()=>j,getUuid:()=>I,getVerbosityLevel:()=>V,info:()=>G,isArrayBuffer:()=>f,isNodeJS:()=>A,normalizeUnicode:()=>F,objectFromMap:()=>d,setVerbosityLevel:()=>M,shadow:()=>O,string32:()=>J,stringToBytes:()=>ct,unreachable:()=>Y,warn:()=>_});const A=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),z=[1,0,0,1,0,0],C=[.001,0,0,.001,0,0],D=1e7,k=1.35,P={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256},y={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},v="pdfjs_internal_editor_",l={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15},u={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_DEFAULT_COLOR:32},g={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},r={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},p={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},e={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},n={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},c={ERRORS:0,WARNINGS:1,INFOS:5},b={NONE:0,BINARY:1},m={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91},R={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let E=c.WARNINGS;function M(N){Number.isInteger(N)&&(E=N)}function V(){return E}function G(N){E>=c.INFOS&&console.log(`Info: ${N}`)}function _(N){E>=c.WARNINGS&&console.log(`Warning: ${N}`)}function Y(N){throw new Error(N)}function tt(N,S){N||Y(S)}function rt(N){switch(N?.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function j(N,S=null,L=null){if(!N)return null;try{if(L&&typeof N=="string"&&(L.addDefaultProtocol&&N.startsWith("www.")&&N.match(/\./g)?.length>=2&&(N=`http://${N}`),L.tryConvertEncoding))try{N=h(N)}catch{}const $=S?new URL(N,S):new URL(N);if(rt($))return $}catch{}return null}function O(N,S,L,$=!1){return Object.defineProperty(N,S,{value:L,enumerable:!$,configurable:!0,writable:!1}),L}const B=function(){function S(L,$){this.constructor===S&&Y("Cannot initialize BaseException."),this.message=L,this.name=$}return S.prototype=new Error,S.constructor=S,S}();class q extends B{constructor(S,L){super(S,"PasswordException"),this.code=L}}class Q extends B{constructor(S,L){super(S,"UnknownErrorException"),this.details=L}}class K extends B{constructor(S){super(S,"InvalidPDFException")}}class ft extends B{constructor(S){super(S,"MissingPDFException")}}class ot extends B{constructor(S,L){super(S,"UnexpectedResponseException"),this.status=L}}class at extends B{constructor(S){super(S,"FormatError")}}class gt extends B{constructor(S){super(S,"AbortException")}}function dt(N){(typeof N!="object"||N?.length===void 0)&&Y("Invalid argument for bytesToString");const S=N.length,L=8192;if(S<L)return String.fromCharCode.apply(null,N);const $=[];for(let X=0;X<S;X+=L){const W=Math.min(X+L,S),et=N.subarray(X,W);$.push(String.fromCharCode.apply(null,et))}return $.join("")}function ct(N){typeof N!="string"&&Y("Invalid argument for stringToBytes");const S=N.length,L=new Uint8Array(S);for(let $=0;$<S;++$)L[$]=N.charCodeAt($)&255;return L}function J(N){return String.fromCharCode(N>>24&255,N>>16&255,N>>8&255,N&255)}function d(N){const S=Object.create(null);for(const[L,$]of N)S[L]=$;return S}function o(){const N=new Uint8Array(4);return N[0]=1,new Uint32Array(N.buffer,0,1)[0]===1}function s(){try{return new Function(""),!0}catch{return!1}}class t{static get isLittleEndian(){return O(this,"isLittleEndian",o())}static get isEvalSupported(){return O(this,"isEvalSupported",s())}static get isOffscreenCanvasSupported(){return O(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get platform(){return typeof navigator<"u"&&typeof navigator?.platform=="string"?O(this,"platform",{isMac:navigator.platform.includes("Mac")}):O(this,"platform",{isMac:!1})}static get isCSSRoundSupported(){return O(this,"isCSSRoundSupported",globalThis.CSS?.supports?.("width: round(1.5px, 1px)"))}}const i=[...Array(256).keys()].map(N=>N.toString(16).padStart(2,"0"));class a{static makeHexColor(S,L,$){return`#${i[S]}${i[L]}${i[$]}`}static scaleMinMax(S,L){let $;S[0]?(S[0]<0&&($=L[0],L[0]=L[1],L[1]=$),L[0]*=S[0],L[1]*=S[0],S[3]<0&&($=L[2],L[2]=L[3],L[3]=$),L[2]*=S[3],L[3]*=S[3]):($=L[0],L[0]=L[2],L[2]=$,$=L[1],L[1]=L[3],L[3]=$,S[1]<0&&($=L[2],L[2]=L[3],L[3]=$),L[2]*=S[1],L[3]*=S[1],S[2]<0&&($=L[0],L[0]=L[1],L[1]=$),L[0]*=S[2],L[1]*=S[2]),L[0]+=S[4],L[1]+=S[4],L[2]+=S[5],L[3]+=S[5]}static transform(S,L){return[S[0]*L[0]+S[2]*L[1],S[1]*L[0]+S[3]*L[1],S[0]*L[2]+S[2]*L[3],S[1]*L[2]+S[3]*L[3],S[0]*L[4]+S[2]*L[5]+S[4],S[1]*L[4]+S[3]*L[5]+S[5]]}static applyTransform(S,L){const $=S[0]*L[0]+S[1]*L[2]+L[4],X=S[0]*L[1]+S[1]*L[3]+L[5];return[$,X]}static applyInverseTransform(S,L){const $=L[0]*L[3]-L[1]*L[2],X=(S[0]*L[3]-S[1]*L[2]+L[2]*L[5]-L[4]*L[3])/$,W=(-S[0]*L[1]+S[1]*L[0]+L[4]*L[1]-L[5]*L[0])/$;return[X,W]}static getAxialAlignedBoundingBox(S,L){const $=this.applyTransform(S,L),X=this.applyTransform(S.slice(2,4),L),W=this.applyTransform([S[0],S[3]],L),et=this.applyTransform([S[2],S[1]],L);return[Math.min($[0],X[0],W[0],et[0]),Math.min($[1],X[1],W[1],et[1]),Math.max($[0],X[0],W[0],et[0]),Math.max($[1],X[1],W[1],et[1])]}static inverseTransform(S){const L=S[0]*S[3]-S[1]*S[2];return[S[3]/L,-S[1]/L,-S[2]/L,S[0]/L,(S[2]*S[5]-S[4]*S[3])/L,(S[4]*S[1]-S[5]*S[0])/L]}static singularValueDecompose2dScale(S){const L=[S[0],S[2],S[1],S[3]],$=S[0]*L[0]+S[1]*L[2],X=S[0]*L[1]+S[1]*L[3],W=S[2]*L[0]+S[3]*L[2],et=S[2]*L[1]+S[3]*L[3],st=($+et)/2,nt=Math.sqrt(($+et)**2-4*($*et-W*X))/2,it=st+nt||1,lt=st-nt||1;return[Math.sqrt(it),Math.sqrt(lt)]}static normalizeRect(S){const L=S.slice(0);return S[0]>S[2]&&(L[0]=S[2],L[2]=S[0]),S[1]>S[3]&&(L[1]=S[3],L[3]=S[1]),L}static intersect(S,L){const $=Math.max(Math.min(S[0],S[2]),Math.min(L[0],L[2])),X=Math.min(Math.max(S[0],S[2]),Math.max(L[0],L[2]));if($>X)return null;const W=Math.max(Math.min(S[1],S[3]),Math.min(L[1],L[3])),et=Math.min(Math.max(S[1],S[3]),Math.max(L[1],L[3]));return W>et?null:[$,W,X,et]}static bezierBoundingBox(S,L,$,X,W,et,st,nt){const it=[],lt=[[],[]];let mt,bt,At,pt,Et,St,Tt,vt;for(let kt=0;kt<2;++kt){if(kt===0?(bt=6*S-12*$+6*W,mt=-3*S+9*$-9*W+3*st,At=3*$-3*S):(bt=6*L-12*X+6*et,mt=-3*L+9*X-9*et+3*nt,At=3*X-3*L),Math.abs(mt)<1e-12){if(Math.abs(bt)<1e-12)continue;pt=-At/bt,0<pt&&pt<1&&it.push(pt);continue}Tt=bt*bt-4*At*mt,vt=Math.sqrt(Tt),!(Tt<0)&&(Et=(-bt+vt)/(2*mt),0<Et&&Et<1&&it.push(Et),St=(-bt-vt)/(2*mt),0<St&&St<1&&it.push(St))}let wt=it.length,yt;const Rt=wt;for(;wt--;)pt=it[wt],yt=1-pt,lt[0][wt]=yt*yt*yt*S+3*yt*yt*pt*$+3*yt*pt*pt*W+pt*pt*pt*st,lt[1][wt]=yt*yt*yt*L+3*yt*yt*pt*X+3*yt*pt*pt*et+pt*pt*pt*nt;return lt[0][Rt]=S,lt[1][Rt]=L,lt[0][Rt+1]=st,lt[1][Rt+1]=nt,lt[0].length=lt[1].length=Rt+2,[Math.min(...lt[0]),Math.min(...lt[1]),Math.max(...lt[0]),Math.max(...lt[1])]}}function h(N){return decodeURIComponent(escape(N))}function f(N){return typeof N=="object"&&N?.byteLength!==void 0}class w{#t=!1;constructor(){this.promise=new Promise((S,L)=>{this.resolve=$=>{this.#t=!0,S($)},this.reject=$=>{this.#t=!0,L($)}})}get settled(){return this.#t}}let x=null,T=null;function F(N){return x||(x=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,T=new Map([["ﬅ","ſt"]])),N.replaceAll(x,(S,L,$)=>L?L.normalize("NFKC"):T.get($))}function I(){if(typeof crypto<"u"&&typeof crypto?.randomUUID=="function")return crypto.randomUUID();const N=new Uint8Array(32);if(typeof crypto<"u"&&typeof crypto?.getRandomValues=="function")crypto.getRandomValues(N);else for(let S=0;S<32;S++)N[S]=Math.floor(Math.random()*255);return dt(N)}const H="pdfjs_internal_id_"}},Gt={};function Lt(ht){var Z=Gt[ht];if(Z!==void 0)return Z.exports;var U=Gt[ht]={exports:{}};return _t[ht](U,U.exports,Lt),U.exports}(()=>{var ht=typeof Symbol=="function"?Symbol("webpack queues"):"__webpack_queues__",Z=typeof Symbol=="function"?Symbol("webpack exports"):"__webpack_exports__",U=typeof Symbol=="function"?Symbol("webpack error"):"__webpack_error__",A=C=>{C&&C.d<1&&(C.d=1,C.forEach(D=>D.r--),C.forEach(D=>D.r--?D.r++:D()))},z=C=>C.map(D=>{if(D!==null&&typeof D=="object"){if(D[ht])return D;if(D.then){var k=[];k.d=0,D.then(v=>{P[Z]=v,A(k)},v=>{P[U]=v,A(k)});var P={};return P[ht]=v=>v(k),P}}var y={};return y[ht]=v=>{},y[Z]=D,y});Lt.a=(C,D,k)=>{var P;k&&((P=[]).d=-1);var y=new Set,v=C.exports,l,u,g,r=new Promise((p,e)=>{g=e,u=p});r[Z]=v,r[ht]=p=>(P&&p(P),y.forEach(p),r.catch(e=>{})),C.exports=r,D(p=>{l=z(p);var e,n=()=>l.map(b=>{if(b[U])throw b[U];return b[Z]}),c=new Promise(b=>{e=()=>b(n),e.r=0;var m=R=>R!==P&&!y.has(R)&&(y.add(R),R&&!R.d&&(e.r++,R.push(e)));l.map(R=>R[ht](m))});return e.r?c:n()},p=>(p?g(r[U]=p):u(v),A(P))),P&&P.d<0&&(P.d=0)}})();Lt.d=(ht,Z)=>{for(var U in Z)Lt.o(Z,U)&&!Lt.o(ht,U)&&Object.defineProperty(ht,U,{enumerable:!0,get:Z[U]})};Lt.o=(ht,Z)=>Object.prototype.hasOwnProperty.call(ht,Z);var ut=Lt(907);ut=globalThis.pdfjsLib=await(globalThis.pdfjsLibPromise=ut);ut.AbortException;ut.AnnotationEditorLayer;ut.AnnotationEditorParamsType;ut.AnnotationEditorType;ut.AnnotationEditorUIManager;ut.AnnotationLayer;ut.AnnotationMode;ut.CMapCompressionType;ut.ColorPicker;ut.DOMSVGFactory;ut.DrawLayer;ut.FeatureTest;var $t=ut.GlobalWorkerOptions;ut.ImageKind;ut.InvalidPDFException;ut.MissingPDFException;ut.OPS;ut.Outliner;ut.PDFDataRangeTransport;ut.PDFDateString;ut.PDFWorker;ut.PasswordResponses;ut.PermissionFlag;ut.PixelsPerInch;ut.PromiseCapability;ut.RenderingCancelledException;ut.UnexpectedResponseException;ut.Util;ut.VerbosityLevel;ut.XfaLayer;ut.build;ut.createValidAbsoluteUrl;ut.fetchData;var Yt=ut.getDocument;ut.getFilenameFromUrl;ut.getPdfFilenameFromUrl;ut.getXfaPageViewport;ut.isDataScheme;ut.isPdfFile;ut.noContextMenu;ut.normalizeUnicode;ut.renderTextLayer;ut.setLayerDimensions;ut.shadow;ut.updateTextLayer;ut.version;export{$t as _,Yt as a};
